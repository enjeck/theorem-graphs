{"version":3,"sources":["src/vivagraph.js"],"names":["e","exports","module","define","amd","f","window","global","self","Viva","t","n","r","s","o","u","a","require","i","Error","code","l","call","length","random","lazyExtend","apply","arguments","randomIterator","events","Graph","version","graph","serializer","loadFromJSON","storeToJSON","centrality","operations","geom","intersect","intersectRect","webgl","webglInputEvents","generator","Input","domInputManager","webglInputManager","Utils","dragndrop","findElementPosition","timer","getDimension","Layout","forceDirected","constant","View","Texture","webglAtlas","webglImageNodeProgram","webglLinkProgram","webglNodeProgram","webglLine","webglSquare","webglImage","webglGraphics","_webglUtil","parseColor","svgGraphics","renderer","cssGraphics","svgNodeFactory","community","Rect","svg","BrowserInfo","addEventListener","removeEventListener","Events","el","eventName","listener","useCapture","document","add","stdAttach","rm","stdDetach","oldIEAttach","oldIEDetach","attachEvent","detachEvent","x1","y1","x2","y2","x3","y3","x4","y4","a1","a2","b1","b2","c1","c2","r1","r2","r3","r4","denom","offset","num","result","x","y","degree","betweenness","closeness","eccentricity","betweennes","oriented","Q","S","pred","Object","create","dist","sigma","delta","currentNode","forEachNode","setCentralityToZero","calculateCentrality","keys","forEach","divideByTwo","key","node","id","singleSourceShortestPath","accumulate","setDeltaToZero","w","pop","coeff","predcessors","idx","v","source","initNode","push","shift","forEachLinkedNode","toId","otherNode","processNode","nodeId","distances","map","filter","val","reachableNodesTotal","totalDistance","reduce","b","kind","getNodeDegree","toLowerCase","inoutDegreeCalculator","inDegreeCalculator","outDegreeCalculator","calculateNodeDegree","links","getLinks","total","fromId","maxDist","subject","validateSubject","eventsStorage","createEventsStorage","on","off","fire","registeredEvents","callback","ctx","handlers","wantToRemoveAll","deleteAllCallbacksForEvent","callbacks","splice","fireArguments","Array","prototype","callbackInfo","reservedWords","hasOwnProperty","exposeProperties","settings","target","needsFilter","toString","augment","value","undefined","createLayout","simulator","eventify","physicsSettings","createSimulator","physicsSimulator","nodeMass","defaultNodeMass","nodeBodies","springs","bodiesCount","springTransform","noop","initPhysics","listenToEvents","wasStable","api","step","lastMove","ratio","isStableNow","onStableChanged","getNodePosition","getInitializedBody","pos","setNodePosition","body","setPosition","slice","invalidateBBox","getLinkPosition","linkId","spring","from","to","getGraphRect","getBBox","forEachBody","pinNode","isPinned","isNodePinned","dispose","onGraphChanged","getBody","getSpring","cb","bodyId","link","hasLink","isStable","changes","change","changeType","initBody","initLink","releaseNode","releaseLink","getNodesCount","forEachLink","getNode","position","neighbors","getNeighborBodies","getBestNewBodyPosition","addBodyAt","updateBodyMass","isNodeOriginallyPinned","removeBody","fromBody","toBody","addSpring","removeSpring","maxNeighbors","Math","min","otherBody","mass","Number","isNaN","data","load","createGraph","jsonGraph","nodeTransform","linkTransform","stored","JSON","parse","nodes","parsedNode","addNode","addLink","factory","ladder","complete","completeBipartite","balancedBinTree","path","circularLadder","grid","grid3","noLinks","wattsStrogatz","cliqueCircle","g","j","m","z","k","level","count","pow","root","left","right","cliqueCount","cliqueSize","appendClique","size","p","seed","neighborsSize","floor","nextDouble","newTo","next","needsRewire","removeLink","inputSeed","Date","Generator","uniform","gaussian","sqrt","log","maxValue","array","customRandom","localRandom","shuffle","options","console","warn","multigraph","uniqueLinkId","multiEdges","nodesCount","suspendEvents","createNodeIterator","createLink","createUniqueLink","createSingleLink","recordLinkChange","recordNodeChange","enterModification","exitModification","graphPart","removeNode","getLinksCount","beginUpdate","endUpdate","clear","getLink","hasNode","monitorSubscribers","realOn","enterModificationReal","exitModificationReal","recordLinkChangeReal","recordNodeChangeReal","Node","prevLinks","fromNode","toNode","addLinkToNode","makeLinkId","Link","isMultiEdge","suffix","indexOfElementInArray","fromNodeId","toNodeId","forEachOrientedLink","forEachNonOrientedLink","quitFast","linkedNodeId","objectKeysIterator","forInIterator","element","indexOf","len","hashCode","str","hash","chr","charCodeAt","merge","targetHasIt","optionsValueType","shouldReplace","Body","Vector2d","Body3d","Vector3d","prevPos","force","velocity","reset","Spring","expose","springLength","springCoeff","gravity","theta","dragCoeff","timeStep","createQuadTree","createBounds","createDragForce","createSpringForce","integrate","integrator","createBody","bodies","quadTree","bounds","springForce","dragForce","bboxNeedsUpdate","totalMovement","publicApi","accumulateForces","movement","update","addBody","body1","body2","springWeight","springCoefficient","getTotalMovement","getBestNewPosition","box","insertBodies","updateBodyForce","boundingBox","updateBoundingBox","graphRect","baseX","baseY","MAX_VALUE","MIN_VALUE","physics","dx","tx","dy","ty","max","vx","vy","abs","weight","d","InsertStack","isSamePosition","updateQueue","insertStack","nodesCache","currentInCache","newNode","getRoot","newOptions","quad0","quad1","quad2","quad3","massX","massY","top","bottom","sourceBody","queue","fx","fy","queueLength","shiftIdx","pushIdx","differentBody","insert","newBody","isEmpty","stackItem","quadIdx","child","getChild","setChild","oldBody","retriesCount","stack","popIdx","item","InsertStackElement","point1","point2","randomFunc","save","customNodeTransform","customLinkTransform","defaultTransformForNode","defaultTransformForLink","saveNode","saveLink","stringify","compile","compileTemplate","domEvents","svgns","xlinkns","attrBag","svgElement","attributes","attributeName","attr","createElementNS","simplesvg","compiledTempalte","append","text","dataSource","model","name","content","appendChild","setAttributeNS","removeAttributeNS","getAttributeNS","textContent","parser","svgText","addNamespaces","parseFromString","documentElement","namespaces","match","tagLength","substr","template","BINDING_EXPR","domNode","allBindings","extractAllBindings","setter","changeModel","nodeType","typeSupported","hasChildNodes","domChildren","childNodes","bindTextContent","attrs","bindDomAttribute","domAttribute","modelNameMatch","attrName","localName","modelPropertyName","isSimpleValue","propertyBindings","attributeSetter","nodeValue","textSetter","createDomparser","DOMParser","fail","centralityWrapper","betweennessCentrality","degreeCentrality","toVivaGraphCentralityFormat","sort","byValue","toKeyValue","density","directed","NaN","graphics","nodeEvents","bindDragNDrop","nodeUI","getNodeUI","onStart","onDrag","onStop","release","documentEvents","browserInfo","start","drag","end","scroll","prevSelectStart","prevDragStart","startX","startY","dragObject","touchInProgress","pinchZoomLength","getMousePos","posx","posy","event","pageX","pageY","clientX","clientY","scrollLeft","scrollTop","move","stopPropagation","cancelBubble","preventDefault","handleDisabledEvent","handleMouseMove","handleMouseDown","isLeftButton","button","srcElement","handleMouseUp","onselectstart","ondragstart","handleMouseWheel","returnValue","mousePos","elementOffset","relMousePos","wheelDelta","detail","updateScrollEvents","scrollCallback","browser","getPinchZoomLength","finger1","finger2","handleTouchMove","touches","touch","currentPinchLength","handleTouchEnd","handleSignleFingerTouch","handleTouchStart","onScroll","createInputEvents","inputEvents","draggedNode","internalHandlers","mouseDown","mouseCapture","mouseUp","releaseMouseCapture","mouseMove","userSettings","maxX","maxY","rand","layoutLinks","placeNodeCallback","updateGraphRect","layoutNodes","ensureNodeInitialized","updateNodePositions","ensureLinkInitialized","run","iterationsCount","placeNode","newPlaceNodeCallbackOrNode","backwardCompatibleEvents","eventsDefined","extend","stop","backwardCompatible","ua","navigator","userAgent","rwebkit","ropera","rmsie","rmozilla","exec","nullEvents","createDocumentEvents","handler","obj","curleft","curtop","offsetParent","offsetLeft","offsetTop","container","message","width","clientWidth","height","clientHeight","createNullEvents","createTimer","lastTime","vendors","scope","setTimeout","clearTimeout","requestAnimationFrame","vendorPrefix","cancelAnimationFrame","rafPolyfill","cancelRafPolyfill","intervalId","startTimer","stopTimer","restart","currTime","getTime","timeToCall","windowEvents","FRAME_INTERVAL","layout","interactive","inputManager","animationTimer","rendererInitialized","updateCenterRequired","userInteraction","isPaused","transform","offsetX","offsetY","scale","publicEvents","containerDrag","prepareSettings","prerender","initDom","updateCenter","renderIterations","resetScale","pause","resume","rerender","renderGraph","zoomOut","zoomIn","getTransform","moveTo","graphCenterChanged","getGraphics","getLayout","stopListenToEvents","isInteractive","interactionName","renderLinks","beginRender","renderNodes","endRender","onRenderFrame","needMoreFrames","resetStable","containerSize","cx","cy","createNodeUi","nodePosition","removeNodeUi","createLinkUi","linkPosition","removeLinkUi","listenNodeEvents","wasPinned","oldPos","releaseNodeEvents","init","releaseDom","processNodeChange","processLinkChange","onWindowResized","releaseContainerDragManager","releaseGraphEvents","out","scrollPoint","scaleFactor","translateRel","scaleOffset","svgContainer","svgRoot","initCallback","actualScale","allNodes","allLinks","nodeBuilder","nodePositionCallback","linkBuilder","linkPositionCallback","linkUI","fromPos","toPos","fireRescaled","cachedPos","cachedFromPos","cachedToPos","updateTransform","createSvgRoot","getLinkUI","builderCallback","newPlaceCallback","placeLink","newPlaceLinkCallback","createSVGPoint","getCTM","origin","matrixTransform","inverse","createSVGMatrix","translate","multiply","removeChild","childElementCount","insertBefore","firstChild","getGraphicsRoot","callbackWhenReady","getSvgRoot","enableBlending","preserveDrawingBuffer","clearColor","clearColorValue","graphicsRoot","gl","linksCount","userPlaceNodeCallback","userPlaceLinkCallback","linkProgram","nodeProgram","nodeUIBuilder","linkUIBuilder","updateTransformUniform","resetScaleInternal","updateSize","offsetWidth","offsetHeight","viewport","createElement","render","bringLinkToFront","frontLinkId","getFrontLinkId","srcLinkId","temp","bringToFront","boundPosition","uiid","ui","createNode","c","contextParameters","getContext","msg","alert","blendFunc","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","enable","BLEND","color","COLOR_BUFFER_BIT","isSupported","linkIdToRemove","lastLinkUI","nodeIdToRemove","lastNodeUI","replaceProperties","omitLinksRendering","setNodeProgram","newProgram","setLinkProgram","transformClientToGraphCoordinates","transformGraphToClientCoordinates","getNodeAtClientPos","clientPos","preciseCheck","parsedColor","replace","parseInt","canvas","isDirty","createProgram","extendArray","copyArrayPart","swapArrayPart","getLocations","context","createShader","shaderText","type","shader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","vertexShaderSrc","fragmentShaderSrc","program","vs","VERTEX_SHADER","fs","FRAGMENT_SHADER","attachShader","getProgramParameter","LINK_STATUS","buffer","itemsInBuffer","elementsPerItem","extendedArray","Float32Array","set","uniformOrAttributeNames","foundLocations","location","getAttribLocation","getUniformLocation","elementsCount","tmp","tilesPerTexture","tilesPerRow","tileSize","lastLoadedIdx","loadedImages","dirtyTimeoutId","skipedDirty","textures","trackedUrls","isPowerOf2","clearDirty","remove","getTextures","getCoordinates","imgUrl","coordinates","tileToRemove","getTileCoordinates","lastTileInSet","copy","replacedOffset","markDirty","img","Image","imgId","crossOrigin","onload","drawAt","src","createTexture","texture","tileNumber","tilePosition","textureNumber","currentTexture","drawImage","col","row","absolutePosition","localTileNumber","markDirtyNow","fromCanvas","toCtx","_texture","_offset","WebglAtlas","glUtils","ATTRIBUTES_PER_PRIMITIVE","nodesFS","createNodeFragmentShader","nodesVS","createNodeVertexShader","atlas","utils","locations","sizeDirty","refreshTexture","nativeObject","deleteTexture","activeTexture","bindTexture","TEXTURE_2D","texImage2D","RGBA","UNSIGNED_BYTE","texParameteri","TEXTURE_MAG_FILTER","LINEAR","TEXTURE_MIN_FILTER","LINEAR_MIPMAP_NEAREST","generateMipmap","uniform1i","ensureAtlasTextureUpdated","glContext","useProgram","uniform1f","enableVertexAttribArray","vertexPos","customAttributes","createBuffer","replacedNode","newTransform","h","bindBuffer","ARRAY_BUFFER","bufferData","DYNAMIC_DRAW","uniformMatrix4fv","uniform2f","screenSize","vertexAttribPointer","FLOAT","BYTES_PER_ELEMENT","drawArrays","TRIANGLES","join","mouseCapturedNode","mouseEnterCallback","mouseLeaveCallback","mouseDownCallback","mouseUpCallback","mouseMoveCallback","clickCallback","dblClickCallback","boundRect","startListen","mouseEnter","mouseLeave","click","dblClick","half","invoke","callbacksChain","args","lastFound","lastUpdate","lastClickTime","updateBoundRect","getBoundingClientRect","clickTime","nodeAtClientPos","sameNode","BYTES_PER_LINK","Uint32Array","linksFS","linksVS","storage","ArrayBuffer","positions","colors","ensureEnoughStorage","byteLength","extendedStorage","extendedPositions","extendedColors","linkUi","linkIdx","LINES","BYTES_PER_NODE","POINTS"],"mappings":"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","file":"vivagraph.7eac2aee.js","sourceRoot":"..","sourcesContent":["!function(e){if(\"object\"==typeof exports&&\"undefined\"!=typeof module)module.exports=e();else if(\"function\"==typeof define&&define.amd)define([],e);else{var f;\"undefined\"!=typeof window?f=window:\"undefined\"!=typeof global?f=global:\"undefined\"!=typeof self&&(f=self),f.Viva=e()}}(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n/**\r\n * This is an entry point for global namespace. If you want to use separate\r\n * modules individually - you are more than welcome to do so.\r\n */\r\n\r\nvar random = require('ngraph.random');\r\n\r\nvar Viva = {\r\n  lazyExtend: function() {\r\n    return require('ngraph.merge').apply(this, arguments);\r\n  },\r\n  randomIterator: function() {\r\n    return random.randomIterator.apply(random, arguments);\r\n  },\r\n  random: function() {\r\n    return random.random.apply(random, arguments);\r\n  },\r\n  events: require('ngraph.events')\r\n};\r\n\r\nViva.Graph = {\r\n  version: require('./version.js'),\r\n  graph: require('ngraph.graph'),\r\n\r\n  serializer: function() {\r\n    return {\r\n      loadFromJSON: require('ngraph.fromjson'),\r\n      storeToJSON: require('ngraph.tojson')\r\n    };\r\n  },\r\n\r\n  centrality: require('./Algorithms/centrality.js'),\r\n  operations: require('./Algorithms/operations.js'),\r\n\r\n  geom: function() {\r\n    return {\r\n      intersect: require('gintersect'),\r\n      intersectRect: require('./Utils/intersectRect.js')\r\n    };\r\n  },\r\n\r\n  webgl: require('./WebGL/webgl.js'),\r\n  webglInputEvents: require('./WebGL/webglInputEvents.js'),\r\n\r\n  generator: function() {\r\n    return require('ngraph.generators');\r\n  },\r\n\r\n  Input: {\r\n    domInputManager: require('./Input/domInputManager.js'),\r\n    webglInputManager: require('./Input/webglInputManager.js')\r\n  },\r\n\r\n  Utils: {\r\n    // TODO: move to Input\r\n    dragndrop: require('./Input/dragndrop.js'),\r\n    findElementPosition: require('./Utils/findElementPosition.js'),\r\n    timer: require('./Utils/timer.js'),\r\n    getDimension: require('./Utils/getDimensions.js'),\r\n    events: require('./Utils/backwardCompatibleEvents.js')\r\n  },\r\n\r\n  Layout: {\r\n    forceDirected: require('ngraph.forcelayout'),\r\n    constant: require('./Layout/constant.js')\r\n  },\r\n\r\n  View: {\r\n    // TODO: Move `webglXXX` out to webgl namespace\r\n    Texture: require('./WebGL/texture.js'),\r\n    // TODO: This should not be even exported\r\n    webglAtlas: require('./WebGL/webglAtlas.js'),\r\n    webglImageNodeProgram: require('./WebGL/webglImageNodeProgram.js'),\r\n    webglLinkProgram: require('./WebGL/webglLinkProgram.js'),\r\n    webglNodeProgram: require('./WebGL/webglNodeProgram.js'),\r\n    webglLine: require('./WebGL/webglLine.js'),\r\n    webglSquare: require('./WebGL/webglSquare.js'),\r\n    webglImage: require('./WebGL/webglImage.js'),\r\n    webglGraphics: require('./View/webglGraphics.js'),\r\n    // TODO: Deprecate this:\r\n    _webglUtil: {\r\n      parseColor: require('./WebGL/parseColor.js')\r\n    },\r\n\r\n    // TODO: move to svg namespace\r\n    svgGraphics: require('./View/svgGraphics.js'),\r\n\r\n    renderer: require('./View/renderer.js'),\r\n\r\n    // deprecated\r\n    cssGraphics: function() {\r\n      throw new Error('cssGraphics is deprecated. Please use older version of vivagraph (< 0.7) if you need it');\r\n    },\r\n\r\n    svgNodeFactory: function() {\r\n      throw new Error('svgNodeFactory is deprecated. Please use older version of vivagraph (< 0.7) if you need it');\r\n    },\r\n\r\n    community: function() {\r\n      throw new Error('community is deprecated. Please use vivagraph < 0.7 if you need it, or `https://github.com/anvaka/ngraph.slpa` module');\r\n    }\r\n  },\r\n\r\n  Rect: require('./Utils/rect.js'),\r\n\r\n  svg: require('simplesvg'),\r\n\r\n  // TODO: should be camelCase\r\n  BrowserInfo: require('./Utils/browserInfo.js')\r\n};\r\n\r\nmodule.exports = Viva;\r\n\n},{\"./Algorithms/centrality.js\":36,\"./Algorithms/operations.js\":37,\"./Input/domInputManager.js\":38,\"./Input/dragndrop.js\":39,\"./Input/webglInputManager.js\":40,\"./Layout/constant.js\":41,\"./Utils/backwardCompatibleEvents.js\":42,\"./Utils/browserInfo.js\":43,\"./Utils/findElementPosition.js\":45,\"./Utils/getDimensions.js\":46,\"./Utils/intersectRect.js\":47,\"./Utils/rect.js\":49,\"./Utils/timer.js\":50,\"./View/renderer.js\":52,\"./View/svgGraphics.js\":53,\"./View/webglGraphics.js\":54,\"./WebGL/parseColor.js\":55,\"./WebGL/texture.js\":56,\"./WebGL/webgl.js\":57,\"./WebGL/webglAtlas.js\":58,\"./WebGL/webglImage.js\":59,\"./WebGL/webglImageNodeProgram.js\":60,\"./WebGL/webglInputEvents.js\":61,\"./WebGL/webglLine.js\":62,\"./WebGL/webglLinkProgram.js\":63,\"./WebGL/webglNodeProgram.js\":64,\"./WebGL/webglSquare.js\":65,\"./version.js\":66,\"gintersect\":3,\"ngraph.events\":9,\"ngraph.forcelayout\":11,\"ngraph.fromjson\":13,\"ngraph.generators\":14,\"ngraph.graph\":16,\"ngraph.merge\":17,\"ngraph.random\":30,\"ngraph.tojson\":31,\"simplesvg\":32}],2:[function(require,module,exports){\naddEventListener.removeEventListener = removeEventListener\naddEventListener.addEventListener = addEventListener\n\nmodule.exports = addEventListener\n\nvar Events = null\n\nfunction addEventListener(el, eventName, listener, useCapture) {\n  Events = Events || (\n    document.addEventListener ?\n    {add: stdAttach, rm: stdDetach} :\n    {add: oldIEAttach, rm: oldIEDetach}\n  )\n  \n  return Events.add(el, eventName, listener, useCapture)\n}\n\nfunction removeEventListener(el, eventName, listener, useCapture) {\n  Events = Events || (\n    document.addEventListener ?\n    {add: stdAttach, rm: stdDetach} :\n    {add: oldIEAttach, rm: oldIEDetach}\n  )\n  \n  return Events.rm(el, eventName, listener, useCapture)\n}\n\nfunction stdAttach(el, eventName, listener, useCapture) {\n  el.addEventListener(eventName, listener, useCapture)\n}\n\nfunction stdDetach(el, eventName, listener, useCapture) {\n  el.removeEventListener(eventName, listener, useCapture)\n}\n\nfunction oldIEAttach(el, eventName, listener, useCapture) {\n  if(useCapture) {\n    throw new Error('cannot useCapture in oldIE')\n  }\n\n  el.attachEvent('on' + eventName, listener)\n}\n\nfunction oldIEDetach(el, eventName, listener, useCapture) {\n  el.detachEvent('on' + eventName, listener)\n}\n\n},{}],3:[function(require,module,exports){\nmodule.exports = intersect;\n\n/**\n * Original authors: Mukesh Prasad, Appeared in Graphics Gem II book\n * http://www.opensource.apple.com/source/graphviz/graphviz-498/graphviz/dynagraph/common/xlines.c\n * and adopted to javascript version by Andrei Kashcha.\n *\n * This function computes whether two line segments,\n * respectively joining the input points (x1,y1) -- (x2,y2)\n * and the input points (x3,y3) -- (x4,y4) intersect.\n * If the lines intersect, the output variables x, y are\n * set to coordinates of the point of intersection.\n *\n * @param {Number} x1 First line segment coordinates\n * @param {Number} y1 First line segment coordinates\n * @param {Number} x2 First line segment coordinates\n * @param {Number} x2 First line segment coordinates\n *\n * @param {Number} x3 Second line segment coordinates\n * @param {Number} y3 Second line segment coordinates\n * @param {Number} x4 Second line segment coordinates\n * @param {Number} x4 Second line segment coordinates\n *\n * @return {Object} x, y coordinates of intersection point or falsy value if no\n * intersection found..\n */\nfunction intersect(\n  x1, y1, x2, y2, // first line segment\n  x3, y3, x4, y4  // second line segment\n) {\n\n  var a1, a2, b1, b2, c1, c2, /* Coefficients of line eqns. */\n    r1, r2, r3, r4, /* 'Sign' values */\n    denom, offset, num, /* Intermediate values */\n    result = {\n      x: 0,\n      y: 0\n    };\n\n  /* Compute a1, b1, c1, where line joining points 1 and 2\n   * is \"a1 x  +  b1 y  +  c1  =  0\".\n   */\n  a1 = y2 - y1;\n  b1 = x1 - x2;\n  c1 = x2 * y1 - x1 * y2;\n\n  /* Compute r3 and r4.\n   */\n  r3 = a1 * x3 + b1 * y3 + c1;\n  r4 = a1 * x4 + b1 * y4 + c1;\n\n  /* Check signs of r3 and r4.  If both point 3 and point 4 lie on\n   * same side of line 1, the line segments do not intersect.\n   */\n\n  if (r3 !== 0 && r4 !== 0 && ((r3 >= 0) === (r4 >= 4))) {\n    return null; //no intersection.\n  }\n\n  /* Compute a2, b2, c2 */\n  a2 = y4 - y3;\n  b2 = x3 - x4;\n  c2 = x4 * y3 - x3 * y4;\n\n  /* Compute r1 and r2 */\n\n  r1 = a2 * x1 + b2 * y1 + c2;\n  r2 = a2 * x2 + b2 * y2 + c2;\n\n  /* Check signs of r1 and r2.  If both point 1 and point 2 lie\n   * on same side of second line segment, the line segments do\n   * not intersect.\n   */\n  if (r1 !== 0 && r2 !== 0 && ((r1 >= 0) === (r2 >= 0))) {\n    return null; // no intersection;\n  }\n  /* Line segments intersect: compute intersection point.\n   */\n\n  denom = a1 * b2 - a2 * b1;\n  if (denom === 0) {\n    return null; // Actually collinear..\n  }\n\n  offset = denom < 0 ? -denom / 2 : denom / 2;\n  offset = 0.0;\n\n  /* The denom/2 is to get rounding instead of truncating.  It\n   * is added or subtracted to the numerator, depending upon the\n   * sign of the numerator.\n   */\n  num = b1 * c2 - b2 * c1;\n  result.x = (num < 0 ? num - offset : num + offset) / denom;\n\n  num = a2 * c1 - a1 * c2;\n  result.y = (num < 0 ? num - offset : num + offset) / denom;\n\n  return result;\n}\n\n},{}],4:[function(require,module,exports){\nmodule.exports.degree = require('./src/degree.js');\nmodule.exports.betweenness = require('./src/betweenness.js');\nmodule.exports.closeness = require('./src/closeness.js');\nmodule.exports.eccentricity = require('./src/eccentricity.js');\n\n},{\"./src/betweenness.js\":5,\"./src/closeness.js\":6,\"./src/degree.js\":7,\"./src/eccentricity.js\":8}],5:[function(require,module,exports){\nmodule.exports = betweennes;\n\n/**\n * I'm using http://www.inf.uni-konstanz.de/algo/publications/b-vspbc-08.pdf\n * as a reference for this implementation\n */\nfunction betweennes(graph, oriented) {\n  var Q = [],\n    S = []; // Queue and Stack\n  // list of predcessors on shorteest paths from source\n  var pred = Object.create(null);\n  // distance from source\n  var dist = Object.create(null);\n  // number of shortest paths from source to key\n  var sigma = Object.create(null);\n  // dependency of source on key\n  var delta = Object.create(null);\n\n  var currentNode;\n  var centrality = Object.create(null);\n\n  graph.forEachNode(setCentralityToZero);\n  graph.forEachNode(calculateCentrality);\n\n  if (!oriented) {\n    // The centrality scores need to be divided by two if the graph is not oriented,\n    // since all shortest paths are considered twice\n    Object.keys(centrality).forEach(divideByTwo);\n  }\n\n  return centrality;\n\n  function divideByTwo(key) {\n    centrality[key] /= 2;\n  }\n\n  function setCentralityToZero(node) {\n    centrality[node.id] = 0;\n  }\n\n  function calculateCentrality(node) {\n    currentNode = node.id;\n    singleSourceShortestPath(currentNode);\n    accumulate();\n  }\n\n  function accumulate() {\n    graph.forEachNode(setDeltaToZero);\n    while (S.length) {\n      var w = S.pop();\n      var coeff = (1 + delta[w])/sigma[w];\n      var predcessors = pred[w];\n      for (var idx = 0; idx < predcessors.length; ++idx) {\n        var v = predcessors[idx];\n        delta[v] += sigma[v] * coeff;\n      }\n      if (w !== currentNode) {\n        centrality[w] += delta[w];\n      }\n    }\n  }\n\n  function setDeltaToZero(node) {\n    delta[node.id] = 0;\n  }\n\n  function singleSourceShortestPath(source) {\n    graph.forEachNode(initNode);\n    dist[source] = 0;\n    sigma[source] = 1;\n    Q.push(source);\n\n    while (Q.length) {\n      var v = Q.shift();\n      S.push(v);\n      graph.forEachLinkedNode(v, toId, oriented);\n    }\n\n    function toId(otherNode) {\n      // NOTE: This code will also consider multi-edges, which are often\n      // ignored by popular software (Gephi/NetworkX). Depending on your use\n      // case this may not be desired and deduping needs to be performed. To\n      // save memory I'm not deduping here...\n      processNode(otherNode.id);\n    }\n\n    function initNode(node) {\n      var nodeId = node.id;\n      pred[nodeId] = []; // empty list\n      dist[nodeId] = -1;\n      sigma[nodeId] = 0;\n    }\n\n    function processNode(w) {\n      // path discovery\n      if (dist[w] === -1) {\n        // Node w is found for the first time\n        dist[w] = dist[v] + 1;\n        Q.push(w);\n      }\n      // path counting\n      if (dist[w] === dist[v] + 1) {\n        // edge (v, w) on a shortest path\n        sigma[w] += sigma[v];\n        pred[w].push(v);\n      }\n    }\n  }\n}\n\n},{}],6:[function(require,module,exports){\nmodule.exports = closeness;\r\n\r\n/**\r\n * In a connected graph, the normalized closeness centrality of a node is the average\r\n * length of the shortest path between the node and all other nodes in the\r\n * graph. Thus the more central a node is, the closer it is to all other nodes.\r\n */\r\nfunction closeness(graph, oriented) {\r\n  var Q = [];\r\n  // list of predcessors on shortest paths from source\r\n  // distance from source\r\n  var dist = Object.create(null);\r\n\r\n  var currentNode;\r\n  var centrality = Object.create(null);\r\n\r\n  graph.forEachNode(setCentralityToZero);\r\n  graph.forEachNode(calculateCentrality);\r\n\r\n  return centrality;\r\n\r\n  function setCentralityToZero(node) {\r\n    centrality[node.id] = 0;\r\n  }\r\n\r\n  function calculateCentrality(node) {\r\n    currentNode = node.id;\r\n    singleSourceShortestPath(currentNode);\r\n    accumulate();\r\n  }\r\n\r\n  function accumulate() {\r\n    // Add all distances for node to array, excluding -1s\r\n    var distances = Object.keys(dist).map(function(key) {return dist[key]}).filter(function(val){return val !== -1});\r\n    // Set number of reachable nodes\r\n    var reachableNodesTotal = distances.length;\r\n    // Compute sum of all distances for node\r\n    var totalDistance = distances.reduce(function(a,b) { return a + b });\r\n    if (totalDistance > 0) {\r\n      centrality[currentNode] = ((reachableNodesTotal - 1) / totalDistance); \r\n    } else {\r\n      centrality[currentNode] = 0;\r\n    }\r\n  }\r\n\r\n  function singleSourceShortestPath(source) {\r\n    graph.forEachNode(initNode);\r\n    dist[source] = 0;\r\n    Q.push(source);\r\n\r\n    while (Q.length) {\r\n      var v = Q.shift();\r\n      graph.forEachLinkedNode(v, processNode, oriented);\r\n    }\r\n\r\n    function initNode(node) {\r\n      var nodeId = node.id;\r\n      dist[nodeId] = -1;\r\n    }\r\n\r\n    function processNode(otherNode) {\r\n      var w = otherNode.id\r\n      if (dist[w] === -1) {\r\n        // Node w is found for the first time\r\n        dist[w] = dist[v] + 1;\r\n        Q.push(w);\r\n      }\r\n    }\r\n  }\r\n}\r\n\n},{}],7:[function(require,module,exports){\nmodule.exports = degree;\n\n/**\n * Calculates graph nodes degree centrality (in/out or both).\n *\n * @see http://en.wikipedia.org/wiki/Centrality#Degree_centrality\n *\n * @param {ngraph.graph} graph object for which we are calculating centrality.\n * @param {string} [kind=both] What kind of degree centrality needs to be calculated:\n *   'in'    - calculate in-degree centrality\n *   'out'   - calculate out-degree centrality\n *   'inout' - (default) generic degree centrality is calculated\n */\nfunction degree(graph, kind) {\n  var getNodeDegree;\n  var result = Object.create(null);\n\n  kind = (kind || 'both').toLowerCase();\n  if (kind === 'both' || kind === 'inout') {\n    getNodeDegree = inoutDegreeCalculator;\n  } else if (kind === 'in') {\n    getNodeDegree = inDegreeCalculator;\n  } else if (kind === 'out') {\n    getNodeDegree = outDegreeCalculator;\n  } else {\n    throw new Error('Expected centrality degree kind is: in, out or both');\n  }\n\n  graph.forEachNode(calculateNodeDegree);\n\n  return result;\n\n  function calculateNodeDegree(node) {\n    var links = graph.getLinks(node.id);\n    result[node.id] = getNodeDegree(links, node.id);\n  }\n}\n\nfunction inDegreeCalculator(links, nodeId) {\n  var total = 0;\n  if (!links) return total;\n\n  for (var i = 0; i < links.length; i += 1) {\n    total += (links[i].toId === nodeId) ? 1 : 0;\n  }\n  return total;\n}\n\nfunction outDegreeCalculator(links, nodeId) {\n  var total = 0;\n  if (!links) return total;\n\n  for (var i = 0; i < links.length; i += 1) {\n    total += (links[i].fromId === nodeId) ? 1 : 0;\n  }\n  return total;\n}\n\nfunction inoutDegreeCalculator(links) {\n  if (!links) return 0;\n\n  return links.length;\n}\n\n},{}],8:[function(require,module,exports){\nmodule.exports = eccentricity;\r\n\r\n/**\r\n * The eccentricity centrality of a node is the greatest distance between that node and\r\n * any other node in the network. \r\n */\r\nfunction eccentricity(graph, oriented) {\r\n  var Q = [];\r\n  // distance from source\r\n  var dist = Object.create(null);\r\n\r\n  var currentNode;\r\n  var centrality = Object.create(null);\r\n\r\n  graph.forEachNode(setCentralityToZero);\r\n  graph.forEachNode(calculateCentrality);\r\n\r\n  return centrality;\r\n\r\n  function setCentralityToZero(node) {\r\n    centrality[node.id] = 0;\r\n  }\r\n\r\n  function calculateCentrality(node) {\r\n    currentNode = node.id;\r\n    singleSourceShortestPath(currentNode);\r\n    accumulate();\r\n  }\r\n\r\n  function accumulate() {\r\n    var maxDist = 0;\r\n    Object.keys(dist).forEach(function (key) {\r\n      var val = dist[key];\r\n      if (maxDist < val) maxDist = val;\r\n    });\r\n\r\n    centrality[currentNode] = maxDist;\r\n  }\r\n\r\n  function singleSourceShortestPath(source) {\r\n    graph.forEachNode(initNode);\r\n    dist[source] = 0;\r\n    Q.push(source);\r\n\r\n    while (Q.length) {\r\n      var v = Q.shift();\r\n      graph.forEachLinkedNode(v, processNode, oriented);\r\n    }\r\n\r\n    function initNode(node) {\r\n      var nodeId = node.id;\r\n      dist[nodeId] = -1;\r\n    }\r\n\r\n    function processNode(otherNode) {\r\n      var w = otherNode.id\r\n      if (dist[w] === -1) {\r\n        // Node w is found for the first time\r\n        dist[w] = dist[v] + 1;\r\n        Q.push(w);\r\n      }\r\n    }\r\n  }\r\n}\r\n\n},{}],9:[function(require,module,exports){\nmodule.exports = function(subject) {\n  validateSubject(subject);\n\n  var eventsStorage = createEventsStorage(subject);\n  subject.on = eventsStorage.on;\n  subject.off = eventsStorage.off;\n  subject.fire = eventsStorage.fire;\n  return subject;\n};\n\nfunction createEventsStorage(subject) {\n  // Store all event listeners to this hash. Key is event name, value is array\n  // of callback records.\n  //\n  // A callback record consists of callback function and its optional context:\n  // { 'eventName' => [{callback: function, ctx: object}] }\n  var registeredEvents = Object.create(null);\n\n  return {\n    on: function (eventName, callback, ctx) {\n      if (typeof callback !== 'function') {\n        throw new Error('callback is expected to be a function');\n      }\n      var handlers = registeredEvents[eventName];\n      if (!handlers) {\n        handlers = registeredEvents[eventName] = [];\n      }\n      handlers.push({callback: callback, ctx: ctx});\n\n      return subject;\n    },\n\n    off: function (eventName, callback) {\n      var wantToRemoveAll = (typeof eventName === 'undefined');\n      if (wantToRemoveAll) {\n        // Killing old events storage should be enough in this case:\n        registeredEvents = Object.create(null);\n        return subject;\n      }\n\n      if (registeredEvents[eventName]) {\n        var deleteAllCallbacksForEvent = (typeof callback !== 'function');\n        if (deleteAllCallbacksForEvent) {\n          delete registeredEvents[eventName];\n        } else {\n          var callbacks = registeredEvents[eventName];\n          for (var i = 0; i < callbacks.length; ++i) {\n            if (callbacks[i].callback === callback) {\n              callbacks.splice(i, 1);\n            }\n          }\n        }\n      }\n\n      return subject;\n    },\n\n    fire: function (eventName) {\n      var callbacks = registeredEvents[eventName];\n      if (!callbacks) {\n        return subject;\n      }\n\n      var fireArguments;\n      if (arguments.length > 1) {\n        fireArguments = Array.prototype.splice.call(arguments, 1);\n      }\n      for(var i = 0; i < callbacks.length; ++i) {\n        var callbackInfo = callbacks[i];\n        callbackInfo.callback.apply(callbackInfo.ctx, fireArguments);\n      }\n\n      return subject;\n    }\n  };\n}\n\nfunction validateSubject(subject) {\n  if (!subject) {\n    throw new Error('Eventify cannot use falsy object as events subject');\n  }\n  var reservedWords = ['on', 'fire', 'off'];\n  for (var i = 0; i < reservedWords.length; ++i) {\n    if (subject.hasOwnProperty(reservedWords[i])) {\n      throw new Error(\"Subject cannot be eventified, since it already has property '\" + reservedWords[i] + \"'\");\n    }\n  }\n}\n\n},{}],10:[function(require,module,exports){\nmodule.exports = exposeProperties;\n\n/**\n * Augments `target` object with getter/setter functions, which modify settings\n *\n * @example\n *  var target = {};\n *  exposeProperties({ age: 42}, target);\n *  target.age(); // returns 42\n *  target.age(24); // make age 24;\n *\n *  var filteredTarget = {};\n *  exposeProperties({ age: 42, name: 'John'}, filteredTarget, ['name']);\n *  filteredTarget.name(); // returns 'John'\n *  filteredTarget.age === undefined; // true\n */\nfunction exposeProperties(settings, target, filter) {\n  var needsFilter = Object.prototype.toString.call(filter) === '[object Array]';\n  if (needsFilter) {\n    for (var i = 0; i < filter.length; ++i) {\n      augment(settings, target, filter[i]);\n    }\n  } else {\n    for (var key in settings) {\n      augment(settings, target, key);\n    }\n  }\n}\n\nfunction augment(source, target, key) {\n  if (source.hasOwnProperty(key)) {\n    if (typeof target[key] === 'function') {\n      // this accessor is already defined. Ignore it\n      return;\n    }\n    target[key] = function (value) {\n      if (value !== undefined) {\n        source[key] = value;\n        return target;\n      }\n      return source[key];\n    }\n  }\n}\n\n},{}],11:[function(require,module,exports){\nmodule.exports = createLayout;\nmodule.exports.simulator = require('ngraph.physics.simulator');\n\nvar eventify = require('ngraph.events');\n\n/**\n * Creates force based layout for a given graph.\n *\n * @param {ngraph.graph} graph which needs to be laid out\n * @param {object} physicsSettings if you need custom settings\n * for physics simulator you can pass your own settings here. If it's not passed\n * a default one will be created.\n */\nfunction createLayout(graph, physicsSettings) {\n  if (!graph) {\n    throw new Error('Graph structure cannot be undefined');\n  }\n\n  var createSimulator = require('ngraph.physics.simulator');\n  var physicsSimulator = createSimulator(physicsSettings);\n\n  var nodeMass = defaultNodeMass\n  if (physicsSettings && typeof physicsSettings.nodeMass === 'function') {\n    nodeMass = physicsSettings.nodeMass\n  }\n\n  var nodeBodies = Object.create(null);\n  var springs = {};\n  var bodiesCount = 0;\n\n  var springTransform = physicsSimulator.settings.springTransform || noop;\n\n  // Initialize physics with what we have in the graph:\n  initPhysics();\n  listenToEvents();\n\n  var wasStable = false;\n\n  var api = {\n    /**\n     * Performs one step of iterative layout algorithm\n     *\n     * @returns {boolean} true if the system should be considered stable; Flase otherwise.\n     * The system is stable if no further call to `step()` can improve the layout.\n     */\n    step: function() {\n      if (bodiesCount === 0) return true; // TODO: This will never fire 'stable'\n\n      var lastMove = physicsSimulator.step();\n\n      // Save the movement in case if someone wants to query it in the step\n      // callback.\n      api.lastMove = lastMove;\n\n      // Allow listeners to perform low-level actions after nodes are updated.\n      api.fire('step');\n\n      var ratio = lastMove/bodiesCount;\n      var isStableNow = ratio <= 0.01; // TODO: The number is somewhat arbitrary...\n\n      if (wasStable !== isStableNow) {\n        wasStable = isStableNow;\n        onStableChanged(isStableNow);\n      }\n\n      return isStableNow;\n    },\n\n    /**\n     * For a given `nodeId` returns position\n     */\n    getNodePosition: function (nodeId) {\n      return getInitializedBody(nodeId).pos;\n    },\n\n    /**\n     * Sets position of a node to a given coordinates\n     * @param {string} nodeId node identifier\n     * @param {number} x position of a node\n     * @param {number} y position of a node\n     * @param {number=} z position of node (only if applicable to body)\n     */\n    setNodePosition: function (nodeId) {\n      var body = getInitializedBody(nodeId);\n      body.setPosition.apply(body, Array.prototype.slice.call(arguments, 1));\n      physicsSimulator.invalidateBBox();\n    },\n\n    /**\n     * @returns {Object} Link position by link id\n     * @returns {Object.from} {x, y} coordinates of link start\n     * @returns {Object.to} {x, y} coordinates of link end\n     */\n    getLinkPosition: function (linkId) {\n      var spring = springs[linkId];\n      if (spring) {\n        return {\n          from: spring.from.pos,\n          to: spring.to.pos\n        };\n      }\n    },\n\n    /**\n     * @returns {Object} area required to fit in the graph. Object contains\n     * `x1`, `y1` - top left coordinates\n     * `x2`, `y2` - bottom right coordinates\n     */\n    getGraphRect: function () {\n      return physicsSimulator.getBBox();\n    },\n\n    /**\n     * Iterates over each body in the layout simulator and performs a callback(body, nodeId)\n     */\n    forEachBody: forEachBody,\n\n    /*\n     * Requests layout algorithm to pin/unpin node to its current position\n     * Pinned nodes should not be affected by layout algorithm and always\n     * remain at their position\n     */\n    pinNode: function (node, isPinned) {\n      var body = getInitializedBody(node.id);\n       body.isPinned = !!isPinned;\n    },\n\n    /**\n     * Checks whether given graph's node is currently pinned\n     */\n    isNodePinned: function (node) {\n      return getInitializedBody(node.id).isPinned;\n    },\n\n    /**\n     * Request to release all resources\n     */\n    dispose: function() {\n      graph.off('changed', onGraphChanged);\n      api.fire('disposed');\n    },\n\n    /**\n     * Gets physical body for a given node id. If node is not found undefined\n     * value is returned.\n     */\n    getBody: getBody,\n\n    /**\n     * Gets spring for a given edge.\n     *\n     * @param {string} linkId link identifer. If two arguments are passed then\n     * this argument is treated as formNodeId\n     * @param {string=} toId when defined this parameter denotes head of the link\n     * and first argument is trated as tail of the link (fromId)\n     */\n    getSpring: getSpring,\n\n    /**\n     * [Read only] Gets current physics simulator\n     */\n    simulator: physicsSimulator,\n\n    /**\n     * Gets the graph that was used for layout\n     */\n    graph: graph,\n\n    /**\n     * Gets amount of movement performed during last step opeartion\n     */\n    lastMove: 0\n  };\n\n  eventify(api);\n\n  return api;\n\n  function forEachBody(cb) {\n    Object.keys(nodeBodies).forEach(function(bodyId) {\n      cb(nodeBodies[bodyId], bodyId);\n    });\n  }\n\n  function getSpring(fromId, toId) {\n    var linkId;\n    if (toId === undefined) {\n      if (typeof fromId !== 'object') {\n        // assume fromId as a linkId:\n        linkId = fromId;\n      } else {\n        // assume fromId to be a link object:\n        linkId = fromId.id;\n      }\n    } else {\n      // toId is defined, should grab link:\n      var link = graph.hasLink(fromId, toId);\n      if (!link) return;\n      linkId = link.id;\n    }\n\n    return springs[linkId];\n  }\n\n  function getBody(nodeId) {\n    return nodeBodies[nodeId];\n  }\n\n  function listenToEvents() {\n    graph.on('changed', onGraphChanged);\n  }\n\n  function onStableChanged(isStable) {\n    api.fire('stable', isStable);\n  }\n\n  function onGraphChanged(changes) {\n    for (var i = 0; i < changes.length; ++i) {\n      var change = changes[i];\n      if (change.changeType === 'add') {\n        if (change.node) {\n          initBody(change.node.id);\n        }\n        if (change.link) {\n          initLink(change.link);\n        }\n      } else if (change.changeType === 'remove') {\n        if (change.node) {\n          releaseNode(change.node);\n        }\n        if (change.link) {\n          releaseLink(change.link);\n        }\n      }\n    }\n    bodiesCount = graph.getNodesCount();\n  }\n\n  function initPhysics() {\n    bodiesCount = 0;\n\n    graph.forEachNode(function (node) {\n      initBody(node.id);\n      bodiesCount += 1;\n    });\n\n    graph.forEachLink(initLink);\n  }\n\n  function initBody(nodeId) {\n    var body = nodeBodies[nodeId];\n    if (!body) {\n      var node = graph.getNode(nodeId);\n      if (!node) {\n        throw new Error('initBody() was called with unknown node id');\n      }\n\n      var pos = node.position;\n      if (!pos) {\n        var neighbors = getNeighborBodies(node);\n        pos = physicsSimulator.getBestNewBodyPosition(neighbors);\n      }\n\n      body = physicsSimulator.addBodyAt(pos);\n      body.id = nodeId;\n\n      nodeBodies[nodeId] = body;\n      updateBodyMass(nodeId);\n\n      if (isNodeOriginallyPinned(node)) {\n        body.isPinned = true;\n      }\n    }\n  }\n\n  function releaseNode(node) {\n    var nodeId = node.id;\n    var body = nodeBodies[nodeId];\n    if (body) {\n      nodeBodies[nodeId] = null;\n      delete nodeBodies[nodeId];\n\n      physicsSimulator.removeBody(body);\n    }\n  }\n\n  function initLink(link) {\n    updateBodyMass(link.fromId);\n    updateBodyMass(link.toId);\n\n    var fromBody = nodeBodies[link.fromId],\n        toBody  = nodeBodies[link.toId],\n        spring = physicsSimulator.addSpring(fromBody, toBody, link.length);\n\n    springTransform(link, spring);\n\n    springs[link.id] = spring;\n  }\n\n  function releaseLink(link) {\n    var spring = springs[link.id];\n    if (spring) {\n      var from = graph.getNode(link.fromId),\n          to = graph.getNode(link.toId);\n\n      if (from) updateBodyMass(from.id);\n      if (to) updateBodyMass(to.id);\n\n      delete springs[link.id];\n\n      physicsSimulator.removeSpring(spring);\n    }\n  }\n\n  function getNeighborBodies(node) {\n    // TODO: Could probably be done better on memory\n    var neighbors = [];\n    if (!node.links) {\n      return neighbors;\n    }\n    var maxNeighbors = Math.min(node.links.length, 2);\n    for (var i = 0; i < maxNeighbors; ++i) {\n      var link = node.links[i];\n      var otherBody = link.fromId !== node.id ? nodeBodies[link.fromId] : nodeBodies[link.toId];\n      if (otherBody && otherBody.pos) {\n        neighbors.push(otherBody);\n      }\n    }\n\n    return neighbors;\n  }\n\n  function updateBodyMass(nodeId) {\n    var body = nodeBodies[nodeId];\n    body.mass = nodeMass(nodeId);\n    if (Number.isNaN(body.mass)) {\n      throw new Error('Node mass should be a number')\n    }\n  }\n\n  /**\n   * Checks whether graph node has in its settings pinned attribute,\n   * which means layout algorithm cannot move it. Node can be preconfigured\n   * as pinned, if it has \"isPinned\" attribute, or when node.data has it.\n   *\n   * @param {Object} node a graph node to check\n   * @return {Boolean} true if node should be treated as pinned; false otherwise.\n   */\n  function isNodeOriginallyPinned(node) {\n    return (node && (node.isPinned || (node.data && node.data.isPinned)));\n  }\n\n  function getInitializedBody(nodeId) {\n    var body = nodeBodies[nodeId];\n    if (!body) {\n      initBody(nodeId);\n      body = nodeBodies[nodeId];\n    }\n    return body;\n  }\n\n  /**\n   * Calculates mass of a body, which corresponds to node with given id.\n   *\n   * @param {String|Number} nodeId identifier of a node, for which body mass needs to be calculated\n   * @returns {Number} recommended mass of the body;\n   */\n  function defaultNodeMass(nodeId) {\n    var links = graph.getLinks(nodeId);\n    if (!links) return 1;\n    return 1 + links.length / 3.0;\n  }\n}\n\nfunction noop() { }\n\n},{\"ngraph.events\":12,\"ngraph.physics.simulator\":19}],12:[function(require,module,exports){\narguments[4][9][0].apply(exports,arguments)\n},{\"dup\":9}],13:[function(require,module,exports){\nmodule.exports = load;\n\nvar createGraph = require('ngraph.graph');\n\nfunction load(jsonGraph, nodeTransform, linkTransform) {\n  var stored;\n  nodeTransform = nodeTransform || id;\n  linkTransform = linkTransform || id;\n  if (typeof jsonGraph === 'string') {\n    stored = JSON.parse(jsonGraph);\n  } else {\n    stored = jsonGraph;\n  }\n\n  var graph = createGraph(),\n      i;\n\n  if (stored.links === undefined || stored.nodes === undefined) {\n    throw new Error('Cannot load graph without links and nodes');\n  }\n\n  for (i = 0; i < stored.nodes.length; ++i) {\n    var parsedNode = nodeTransform(stored.nodes[i]);\n    if (!parsedNode.hasOwnProperty('id')) {\n      throw new Error('Graph node format is invalid: Node id is missing');\n    }\n\n    graph.addNode(parsedNode.id, parsedNode.data);\n  }\n\n  for (i = 0; i < stored.links.length; ++i) {\n    var link = linkTransform(stored.links[i]);\n    if (!link.hasOwnProperty('fromId') || !link.hasOwnProperty('toId')) {\n      throw new Error('Graph link format is invalid. Both fromId and toId are required');\n    }\n\n    graph.addLink(link.fromId, link.toId, link.data);\n  }\n\n  return graph;\n}\n\nfunction id(x) { return x; }\n\n},{\"ngraph.graph\":16}],14:[function(require,module,exports){\nvar createGraph = require('ngraph.graph');\n\nmodule.exports = factory(createGraph);\n\n// Allow other developers have their own createGraph\nmodule.exports.factory = factory;\n\nfunction factory(createGraph) {\n  return {\n    ladder: ladder,\n    complete: complete,\n    completeBipartite: completeBipartite,\n    balancedBinTree: balancedBinTree,\n    path: path,\n    circularLadder: circularLadder,\n    grid: grid,\n    grid3: grid3,\n    noLinks: noLinks,\n    wattsStrogatz: wattsStrogatz,\n    cliqueCircle: cliqueCircle\n  };\n\n\n  function ladder(n) {\n  /**\n  * Ladder graph is a graph in form of ladder\n  * @param {Number} n Represents number of steps in the ladder\n  */\n    if (!n || n < 0) {\n      throw new Error(\"Invalid number of nodes\");\n    }\n\n    var g = createGraph(),\n        i;\n\n    for (i = 0; i < n - 1; ++i) {\n      g.addLink(i, i + 1);\n      // first row\n      g.addLink(n + i, n + i + 1);\n      // second row\n      g.addLink(i, n + i);\n      // ladder's step\n    }\n\n    g.addLink(n - 1, 2 * n - 1);\n    // last step in the ladder;\n\n    return g;\n  }\n\n  function circularLadder(n) {\n  /**\n  * Circular ladder with n steps.\n  *\n  * @param {Number} n of steps in the ladder.\n  */\n      if (!n || n < 0) {\n          throw new Error(\"Invalid number of nodes\");\n      }\n\n      var g = ladder(n);\n\n      g.addLink(0, n - 1);\n      g.addLink(n, 2 * n - 1);\n      return g;\n  }\n\n  function complete(n) {\n  /**\n  * Complete graph Kn.\n  *\n  * @param {Number} n represents number of nodes in the complete graph.\n  */\n    if (!n || n < 1) {\n      throw new Error(\"At least two nodes are expected for complete graph\");\n    }\n\n    var g = createGraph(),\n        i,\n        j;\n\n    for (i = 0; i < n; ++i) {\n      for (j = i + 1; j < n; ++j) {\n        if (i !== j) {\n          g.addLink(i, j);\n        }\n      }\n    }\n\n    return g;\n  }\n\n  function completeBipartite (n, m) {\n  /**\n  * Complete bipartite graph K n,m. Each node in the\n  * first partition is connected to all nodes in the second partition.\n  *\n  * @param {Number} n represents number of nodes in the first graph partition\n  * @param {Number} m represents number of nodes in the second graph partition\n  */\n    if (!n || !m || n < 0 || m < 0) {\n      throw new Error(\"Graph dimensions are invalid. Number of nodes in each partition should be greater than 0\");\n    }\n\n    var g = createGraph(),\n        i, j;\n\n    for (i = 0; i < n; ++i) {\n      for (j = n; j < n + m; ++j) {\n        g.addLink(i, j);\n      }\n    }\n\n    return g;\n  }\n\n  function path(n) {\n  /**\n  * Path graph with n steps.\n  *\n  * @param {Number} n number of nodes in the path\n  */\n    if (!n || n < 0) {\n      throw new Error(\"Invalid number of nodes\");\n    }\n\n    var g = createGraph(),\n        i;\n\n    g.addNode(0);\n\n    for (i = 1; i < n; ++i) {\n      g.addLink(i - 1, i);\n    }\n\n    return g;\n  }\n\n\n  function grid(n, m) {\n  /**\n  * Grid graph with n rows and m columns.\n  *\n  * @param {Number} n of rows in the graph.\n  * @param {Number} m of columns in the graph.\n  */\n    if (n < 1 || m < 1) {\n      throw new Error(\"Invalid number of nodes in grid graph\");\n    }\n    var g = createGraph(),\n        i,\n        j;\n    if (n === 1 && m === 1) {\n      g.addNode(0);\n      return g;\n    }\n\n    for (i = 0; i < n; ++i) {\n      for (j = 0; j < m; ++j) {\n        var node = i + j * n;\n        if (i > 0) { g.addLink(node, i - 1 + j * n); }\n        if (j > 0) { g.addLink(node, i + (j - 1) * n); }\n      }\n    }\n\n    return g;\n  }\n\n  function grid3(n, m, z) {\n  /**\n  * 3D grid with n rows and m columns and z levels.\n  *\n  * @param {Number} n of rows in the graph.\n  * @param {Number} m of columns in the graph.\n  * @param {Number} z of levels in the graph.\n  */\n    if (n < 1 || m < 1 || z < 1) {\n      throw new Error(\"Invalid number of nodes in grid3 graph\");\n    }\n    var g = createGraph(),\n        i, j, k;\n\n    if (n === 1 && m === 1 && z === 1) {\n      g.addNode(0);\n      return g;\n    }\n\n    for (k = 0; k < z; ++k) {\n      for (i = 0; i < n; ++i) {\n        for (j = 0; j < m; ++j) {\n          var level = k * n * m;\n          var node = i + j * n + level;\n          if (i > 0) { g.addLink(node, i - 1 + j * n + level); }\n          if (j > 0) { g.addLink(node, i + (j - 1) * n + level); }\n          if (k > 0) { g.addLink(node, i + j * n + (k - 1) * n * m ); }\n        }\n      }\n    }\n\n    return g;\n  }\n\n  function balancedBinTree(n) {\n  /**\n  * Balanced binary tree with n levels.\n  *\n  * @param {Number} n of levels in the binary tree\n  */\n    if (n < 0) {\n      throw new Error(\"Invalid number of nodes in balanced tree\");\n    }\n    var g = createGraph(),\n        count = Math.pow(2, n),\n        level;\n\n    if (n === 0) {\n      g.addNode(1);\n    }\n\n    for (level = 1; level < count; ++level) {\n      var root = level,\n        left = root * 2,\n        right = root * 2 + 1;\n\n      g.addLink(root, left);\n      g.addLink(root, right);\n    }\n\n    return g;\n  }\n\n  function noLinks(n) {\n  /**\n  * Graph with no links\n  *\n  * @param {Number} n of nodes in the graph\n  */\n    if (n < 0) {\n      throw new Error(\"Number of nodes should be >= 0\");\n    }\n\n    var g = createGraph(), i;\n    for (i = 0; i < n; ++i) {\n      g.addNode(i);\n    }\n\n    return g;\n  }\n\n  function cliqueCircle(cliqueCount, cliqueSize) {\n  /**\n  * A circular graph with cliques instead of individual nodes\n  *\n  * @param {Number} cliqueCount number of cliques inside circle\n  * @param {Number} cliqueSize number of nodes inside each clique\n  */\n\n    if (cliqueCount < 1) throw new Error('Invalid number of cliqueCount in cliqueCircle');\n    if (cliqueSize < 1) throw new Error('Invalid number of cliqueSize in cliqueCircle');\n\n    var graph = createGraph();\n\n    for (var i = 0; i < cliqueCount; ++i) {\n      appendClique(cliqueSize, i * cliqueSize)\n\n      if (i > 0) {\n        graph.addLink(i * cliqueSize, i * cliqueSize - 1);\n      }\n    }\n    graph.addLink(0, graph.getNodesCount() - 1);\n\n    return graph;\n\n    function appendClique(size, from) {\n      for (var i = 0; i < size; ++i) {\n        graph.addNode(i + from)\n      }\n\n      for (var i = 0; i < size; ++i) {\n        for (var j = i + 1; j < size; ++j) {\n          graph.addLink(i + from, j + from)\n        }\n      }\n    }\n  }\n\n  function wattsStrogatz(n, k, p, seed) {\n  /**\n  * Watts-Strogatz small-world graph.\n  *\n  * @param {Number} n The number of nodes\n  * @param {Number} k Each node is connected to k nearest neighbors in ring topology\n  * @param {Number} p The probability of rewiring each edge\n\n  * @see https://github.com/networkx/networkx/blob/master/networkx/generators/random_graphs.py\n  */\n    if (k >= n) throw new Error('Choose smaller `k`. It cannot be larger than number of nodes `n`');\n\n\n    var random = require('ngraph.random').random(seed || 42);\n\n    var g = createGraph(), i, to;\n    for (i = 0; i < n; ++i) {\n      g.addNode(i);\n    }\n\n    // connect each node to k/2 neighbors\n    var neighborsSize = Math.floor(k/2 + 1);\n    for (var j = 1; j < neighborsSize; ++j) {\n      for (i = 0; i < n; ++i) {\n        to = (j + i) % n;\n        g.addLink(i, to);\n      }\n    }\n\n    // rewire edges from each node\n    // loop over all nodes in order (label) and neighbors in order (distance)\n    // no self loops or multiple edges allowed\n    for (j = 1; j < neighborsSize; ++j) {\n      for (i = 0; i < n; ++i) {\n        if (random.nextDouble() < p) {\n          var from = i;\n          to = (j + i) % n;\n\n          var newTo = random.next(n);\n          var needsRewire = (newTo === from || g.hasLink(from, newTo));\n          if (needsRewire && g.getLinks(from).length === n - 1) {\n            // we cannot rewire this node, it has too many links.\n            continue;\n          }\n          // Enforce no self-loops or multiple edges\n          while (needsRewire) {\n            newTo = random.next(n);\n            needsRewire = (newTo === from || g.hasLink(from, newTo));\n          }\n          var link = g.hasLink(from, to);\n          g.removeLink(link);\n          g.addLink(from, newTo);\n        }\n      }\n    }\n\n    return g;\n  }\n}\n\n},{\"ngraph.graph\":16,\"ngraph.random\":15}],15:[function(require,module,exports){\nmodule.exports = random;\n\n// TODO: Deprecate?\nmodule.exports.random = random,\nmodule.exports.randomIterator = randomIterator\n\n/**\n * Creates seeded PRNG with two methods:\n *   next() and nextDouble()\n */\nfunction random(inputSeed) {\n  var seed = typeof inputSeed === 'number' ? inputSeed : (+new Date());\n  return new Generator(seed)\n}\n\nfunction Generator(seed) {\n  this.seed = seed;\n}\n\n/**\n  * Generates random integer number in the range from 0 (inclusive) to maxValue (exclusive)\n  *\n  * @param maxValue Number REQUIRED. Omitting this number will result in NaN values from PRNG.\n  */\nGenerator.prototype.next = next;\n\n/**\n  * Generates random double number in the range from 0 (inclusive) to 1 (exclusive)\n  * This function is the same as Math.random() (except that it could be seeded)\n  */\nGenerator.prototype.nextDouble = nextDouble;\n\n/**\n * Returns a random real number uniformly in [0, 1)\n */\nGenerator.prototype.uniform = nextDouble;\n\nGenerator.prototype.gaussian = gaussian;\n\nfunction gaussian() {\n  // use the polar form of the Box-Muller transform\n  // based on https://introcs.cs.princeton.edu/java/23recursion/StdRandom.java\n  var r, x, y;\n  do {\n    x = this.nextDouble() * 2 - 1;\n    y = this.nextDouble() * 2 - 1;\n    r = x * x + y * y;\n  } while (r >= 1 || r === 0);\n\n  return x * Math.sqrt(-2 * Math.log(r)/r);\n}\n\nfunction nextDouble() {\n  var seed = this.seed;\n  // Robert Jenkins' 32 bit integer hash function.\n  seed = ((seed + 0x7ed55d16) + (seed << 12)) & 0xffffffff;\n  seed = ((seed ^ 0xc761c23c) ^ (seed >>> 19)) & 0xffffffff;\n  seed = ((seed + 0x165667b1) + (seed << 5)) & 0xffffffff;\n  seed = ((seed + 0xd3a2646c) ^ (seed << 9)) & 0xffffffff;\n  seed = ((seed + 0xfd7046c5) + (seed << 3)) & 0xffffffff;\n  seed = ((seed ^ 0xb55a4f09) ^ (seed >>> 16)) & 0xffffffff;\n  this.seed = seed;\n  return (seed & 0xfffffff) / 0x10000000;\n}\n\nfunction next(maxValue) {\n  return Math.floor(this.nextDouble() * maxValue);\n}\n\n/*\n * Creates iterator over array, which returns items of array in random order\n * Time complexity is guaranteed to be O(n);\n */\nfunction randomIterator(array, customRandom) {\n  var localRandom = customRandom || random();\n  if (typeof localRandom.next !== 'function') {\n    throw new Error('customRandom does not match expected API: next() function is missing');\n  }\n\n  return {\n    forEach: forEach,\n\n    /**\n     * Shuffles array randomly, in place.\n     */\n    shuffle: shuffle\n  };\n\n  function shuffle() {\n    var i, j, t;\n    for (i = array.length - 1; i > 0; --i) {\n      j = localRandom.next(i + 1); // i inclusive\n      t = array[j];\n      array[j] = array[i];\n      array[i] = t;\n    }\n\n    return array;\n  }\n\n  function forEach(callback) {\n    var i, j, t;\n    for (i = array.length - 1; i > 0; --i) {\n      j = localRandom.next(i + 1); // i inclusive\n      t = array[j];\n      array[j] = array[i];\n      array[i] = t;\n\n      callback(t);\n    }\n\n    if (array.length) {\n      callback(array[0]);\n    }\n  }\n}\n},{}],16:[function(require,module,exports){\n/**\n * @fileOverview Contains definition of the core graph object.\n */\n\n// TODO: need to change storage layer:\n// 1. Be able to get all nodes O(1)\n// 2. Be able to get number of links O(1)\n\n/**\n * @example\n *  var graph = require('ngraph.graph')();\n *  graph.addNode(1);     // graph has one node.\n *  graph.addLink(2, 3);  // now graph contains three nodes and one link.\n *\n */\nmodule.exports = createGraph;\n\nvar eventify = require('ngraph.events');\n\n/**\n * Creates a new graph\n */\nfunction createGraph(options) {\n  // Graph structure is maintained as dictionary of nodes\n  // and array of links. Each node has 'links' property which\n  // hold all links related to that node. And general links\n  // array is used to speed up all links enumeration. This is inefficient\n  // in terms of memory, but simplifies coding.\n  options = options || {};\n  if ('uniqueLinkId' in options) {\n    console.warn(\n      'ngraph.graph: Starting from version 0.14 `uniqueLinkId` is deprecated.\\n' +\n      'Use `multigraph` option instead\\n',\n      '\\n',\n      'Note: there is also change in default behavior: From now own each graph\\n'+\n      'is considered to be not a multigraph by default (each edge is unique).'\n    );\n\n    options.multigraph = options.uniqueLinkId;\n  }\n\n  // Dear reader, the non-multigraphs do not guarantee that there is only\n  // one link for a given pair of node. When this option is set to false\n  // we can save some memory and CPU (18% faster for non-multigraph);\n  if (options.multigraph === undefined) options.multigraph = false;\n\n  var nodes = typeof Object.create === 'function' ? Object.create(null) : {},\n    links = [],\n    // Hash of multi-edges. Used to track ids of edges between same nodes\n    multiEdges = {},\n    nodesCount = 0,\n    suspendEvents = 0,\n\n    forEachNode = createNodeIterator(),\n    createLink = options.multigraph ? createUniqueLink : createSingleLink,\n\n    // Our graph API provides means to listen to graph changes. Users can subscribe\n    // to be notified about changes in the graph by using `on` method. However\n    // in some cases they don't use it. To avoid unnecessary memory consumption\n    // we will not record graph changes until we have at least one subscriber.\n    // Code below supports this optimization.\n    //\n    // Accumulates all changes made during graph updates.\n    // Each change element contains:\n    //  changeType - one of the strings: 'add', 'remove' or 'update';\n    //  node - if change is related to node this property is set to changed graph's node;\n    //  link - if change is related to link this property is set to changed graph's link;\n    changes = [],\n    recordLinkChange = noop,\n    recordNodeChange = noop,\n    enterModification = noop,\n    exitModification = noop;\n\n  // this is our public API:\n  var graphPart = {\n    /**\n     * Adds node to the graph. If node with given id already exists in the graph\n     * its data is extended with whatever comes in 'data' argument.\n     *\n     * @param nodeId the node's identifier. A string or number is preferred.\n     * @param [data] additional data for the node being added. If node already\n     *   exists its data object is augmented with the new one.\n     *\n     * @return {node} The newly added node or node with given id if it already exists.\n     */\n    addNode: addNode,\n\n    /**\n     * Adds a link to the graph. The function always create a new\n     * link between two nodes. If one of the nodes does not exists\n     * a new node is created.\n     *\n     * @param fromId link start node id;\n     * @param toId link end node id;\n     * @param [data] additional data to be set on the new link;\n     *\n     * @return {link} The newly created link\n     */\n    addLink: addLink,\n\n    /**\n     * Removes link from the graph. If link does not exist does nothing.\n     *\n     * @param link - object returned by addLink() or getLinks() methods.\n     *\n     * @returns true if link was removed; false otherwise.\n     */\n    removeLink: removeLink,\n\n    /**\n     * Removes node with given id from the graph. If node does not exist in the graph\n     * does nothing.\n     *\n     * @param nodeId node's identifier passed to addNode() function.\n     *\n     * @returns true if node was removed; false otherwise.\n     */\n    removeNode: removeNode,\n\n    /**\n     * Gets node with given identifier. If node does not exist undefined value is returned.\n     *\n     * @param nodeId requested node identifier;\n     *\n     * @return {node} in with requested identifier or undefined if no such node exists.\n     */\n    getNode: getNode,\n\n    /**\n     * Gets number of nodes in this graph.\n     *\n     * @return number of nodes in the graph.\n     */\n    getNodesCount: function () {\n      return nodesCount;\n    },\n\n    /**\n     * Gets total number of links in the graph.\n     */\n    getLinksCount: function () {\n      return links.length;\n    },\n\n    /**\n     * Gets all links (inbound and outbound) from the node with given id.\n     * If node with given id is not found null is returned.\n     *\n     * @param nodeId requested node identifier.\n     *\n     * @return Array of links from and to requested node if such node exists;\n     *   otherwise null is returned.\n     */\n    getLinks: getLinks,\n\n    /**\n     * Invokes callback on each node of the graph.\n     *\n     * @param {Function(node)} callback Function to be invoked. The function\n     *   is passed one argument: visited node.\n     */\n    forEachNode: forEachNode,\n\n    /**\n     * Invokes callback on every linked (adjacent) node to the given one.\n     *\n     * @param nodeId Identifier of the requested node.\n     * @param {Function(node, link)} callback Function to be called on all linked nodes.\n     *   The function is passed two parameters: adjacent node and link object itself.\n     * @param oriented if true graph treated as oriented.\n     */\n    forEachLinkedNode: forEachLinkedNode,\n\n    /**\n     * Enumerates all links in the graph\n     *\n     * @param {Function(link)} callback Function to be called on all links in the graph.\n     *   The function is passed one parameter: graph's link object.\n     *\n     * Link object contains at least the following fields:\n     *  fromId - node id where link starts;\n     *  toId - node id where link ends,\n     *  data - additional data passed to graph.addLink() method.\n     */\n    forEachLink: forEachLink,\n\n    /**\n     * Suspend all notifications about graph changes until\n     * endUpdate is called.\n     */\n    beginUpdate: enterModification,\n\n    /**\n     * Resumes all notifications about graph changes and fires\n     * graph 'changed' event in case there are any pending changes.\n     */\n    endUpdate: exitModification,\n\n    /**\n     * Removes all nodes and links from the graph.\n     */\n    clear: clear,\n\n    /**\n     * Detects whether there is a link between two nodes.\n     * Operation complexity is O(n) where n - number of links of a node.\n     * NOTE: this function is synonim for getLink()\n     *\n     * @returns link if there is one. null otherwise.\n     */\n    hasLink: getLink,\n\n    /**\n     * Detects whether there is a node with given id\n     * \n     * Operation complexity is O(1)\n     * NOTE: this function is synonim for getNode()\n     *\n     * @returns node if there is one; Falsy value otherwise.\n     */\n    hasNode: getNode,\n\n    /**\n     * Gets an edge between two nodes.\n     * Operation complexity is O(n) where n - number of links of a node.\n     *\n     * @param {string} fromId link start identifier\n     * @param {string} toId link end identifier\n     *\n     * @returns link if there is one. null otherwise.\n     */\n    getLink: getLink\n  };\n\n  // this will add `on()` and `fire()` methods.\n  eventify(graphPart);\n\n  monitorSubscribers();\n\n  return graphPart;\n\n  function monitorSubscribers() {\n    var realOn = graphPart.on;\n\n    // replace real `on` with our temporary on, which will trigger change\n    // modification monitoring:\n    graphPart.on = on;\n\n    function on() {\n      // now it's time to start tracking stuff:\n      graphPart.beginUpdate = enterModification = enterModificationReal;\n      graphPart.endUpdate = exitModification = exitModificationReal;\n      recordLinkChange = recordLinkChangeReal;\n      recordNodeChange = recordNodeChangeReal;\n\n      // this will replace current `on` method with real pub/sub from `eventify`.\n      graphPart.on = realOn;\n      // delegate to real `on` handler:\n      return realOn.apply(graphPart, arguments);\n    }\n  }\n\n  function recordLinkChangeReal(link, changeType) {\n    changes.push({\n      link: link,\n      changeType: changeType\n    });\n  }\n\n  function recordNodeChangeReal(node, changeType) {\n    changes.push({\n      node: node,\n      changeType: changeType\n    });\n  }\n\n  function addNode(nodeId, data) {\n    if (nodeId === undefined) {\n      throw new Error('Invalid node identifier');\n    }\n\n    enterModification();\n\n    var node = getNode(nodeId);\n    if (!node) {\n      node = new Node(nodeId, data);\n      nodesCount++;\n      recordNodeChange(node, 'add');\n    } else {\n      node.data = data;\n      recordNodeChange(node, 'update');\n    }\n\n    nodes[nodeId] = node;\n\n    exitModification();\n    return node;\n  }\n\n  function getNode(nodeId) {\n    return nodes[nodeId];\n  }\n\n  function removeNode(nodeId) {\n    var node = getNode(nodeId);\n    if (!node) {\n      return false;\n    }\n\n    enterModification();\n\n    var prevLinks = node.links;\n    if (prevLinks) {\n      node.links = null;\n      for(var i = 0; i < prevLinks.length; ++i) {\n        removeLink(prevLinks[i]);\n      }\n    }\n\n    delete nodes[nodeId];\n    nodesCount--;\n\n    recordNodeChange(node, 'remove');\n\n    exitModification();\n\n    return true;\n  }\n\n\n  function addLink(fromId, toId, data) {\n    enterModification();\n\n    var fromNode = getNode(fromId) || addNode(fromId);\n    var toNode = getNode(toId) || addNode(toId);\n\n    var link = createLink(fromId, toId, data);\n\n    links.push(link);\n\n    // TODO: this is not cool. On large graphs potentially would consume more memory.\n    addLinkToNode(fromNode, link);\n    if (fromId !== toId) {\n      // make sure we are not duplicating links for self-loops\n      addLinkToNode(toNode, link);\n    }\n\n    recordLinkChange(link, 'add');\n\n    exitModification();\n\n    return link;\n  }\n\n  function createSingleLink(fromId, toId, data) {\n    var linkId = makeLinkId(fromId, toId);\n    return new Link(fromId, toId, data, linkId);\n  }\n\n  function createUniqueLink(fromId, toId, data) {\n    // TODO: Get rid of this method.\n    var linkId = makeLinkId(fromId, toId);\n    var isMultiEdge = multiEdges.hasOwnProperty(linkId);\n    if (isMultiEdge || getLink(fromId, toId)) {\n      if (!isMultiEdge) {\n        multiEdges[linkId] = 0;\n      }\n      var suffix = '@' + (++multiEdges[linkId]);\n      linkId = makeLinkId(fromId + suffix, toId + suffix);\n    }\n\n    return new Link(fromId, toId, data, linkId);\n  }\n\n  function getLinks(nodeId) {\n    var node = getNode(nodeId);\n    return node ? node.links : null;\n  }\n\n  function removeLink(link) {\n    if (!link) {\n      return false;\n    }\n    var idx = indexOfElementInArray(link, links);\n    if (idx < 0) {\n      return false;\n    }\n\n    enterModification();\n\n    links.splice(idx, 1);\n\n    var fromNode = getNode(link.fromId);\n    var toNode = getNode(link.toId);\n\n    if (fromNode) {\n      idx = indexOfElementInArray(link, fromNode.links);\n      if (idx >= 0) {\n        fromNode.links.splice(idx, 1);\n      }\n    }\n\n    if (toNode) {\n      idx = indexOfElementInArray(link, toNode.links);\n      if (idx >= 0) {\n        toNode.links.splice(idx, 1);\n      }\n    }\n\n    recordLinkChange(link, 'remove');\n\n    exitModification();\n\n    return true;\n  }\n\n  function getLink(fromNodeId, toNodeId) {\n    // TODO: Use sorted links to speed this up\n    var node = getNode(fromNodeId),\n      i;\n    if (!node || !node.links) {\n      return null;\n    }\n\n    for (i = 0; i < node.links.length; ++i) {\n      var link = node.links[i];\n      if (link.fromId === fromNodeId && link.toId === toNodeId) {\n        return link;\n      }\n    }\n\n    return null; // no link.\n  }\n\n  function clear() {\n    enterModification();\n    forEachNode(function(node) {\n      removeNode(node.id);\n    });\n    exitModification();\n  }\n\n  function forEachLink(callback) {\n    var i, length;\n    if (typeof callback === 'function') {\n      for (i = 0, length = links.length; i < length; ++i) {\n        callback(links[i]);\n      }\n    }\n  }\n\n  function forEachLinkedNode(nodeId, callback, oriented) {\n    var node = getNode(nodeId);\n\n    if (node && node.links && typeof callback === 'function') {\n      if (oriented) {\n        return forEachOrientedLink(node.links, nodeId, callback);\n      } else {\n        return forEachNonOrientedLink(node.links, nodeId, callback);\n      }\n    }\n  }\n\n  function forEachNonOrientedLink(links, nodeId, callback) {\n    var quitFast;\n    for (var i = 0; i < links.length; ++i) {\n      var link = links[i];\n      var linkedNodeId = link.fromId === nodeId ? link.toId : link.fromId;\n\n      quitFast = callback(nodes[linkedNodeId], link);\n      if (quitFast) {\n        return true; // Client does not need more iterations. Break now.\n      }\n    }\n  }\n\n  function forEachOrientedLink(links, nodeId, callback) {\n    var quitFast;\n    for (var i = 0; i < links.length; ++i) {\n      var link = links[i];\n      if (link.fromId === nodeId) {\n        quitFast = callback(nodes[link.toId], link);\n        if (quitFast) {\n          return true; // Client does not need more iterations. Break now.\n        }\n      }\n    }\n  }\n\n  // we will not fire anything until users of this library explicitly call `on()`\n  // method.\n  function noop() {}\n\n  // Enter, Exit modification allows bulk graph updates without firing events.\n  function enterModificationReal() {\n    suspendEvents += 1;\n  }\n\n  function exitModificationReal() {\n    suspendEvents -= 1;\n    if (suspendEvents === 0 && changes.length > 0) {\n      graphPart.fire('changed', changes);\n      changes.length = 0;\n    }\n  }\n\n  function createNodeIterator() {\n    // Object.keys iterator is 1.3x faster than `for in` loop.\n    // See `https://github.com/anvaka/ngraph.graph/tree/bench-for-in-vs-obj-keys`\n    // branch for perf test\n    return Object.keys ? objectKeysIterator : forInIterator;\n  }\n\n  function objectKeysIterator(callback) {\n    if (typeof callback !== 'function') {\n      return;\n    }\n\n    var keys = Object.keys(nodes);\n    for (var i = 0; i < keys.length; ++i) {\n      if (callback(nodes[keys[i]])) {\n        return true; // client doesn't want to proceed. Return.\n      }\n    }\n  }\n\n  function forInIterator(callback) {\n    if (typeof callback !== 'function') {\n      return;\n    }\n    var node;\n\n    for (node in nodes) {\n      if (callback(nodes[node])) {\n        return true; // client doesn't want to proceed. Return.\n      }\n    }\n  }\n}\n\n// need this for old browsers. Should this be a separate module?\nfunction indexOfElementInArray(element, array) {\n  if (!array) return -1;\n\n  if (array.indexOf) {\n    return array.indexOf(element);\n  }\n\n  var len = array.length,\n    i;\n\n  for (i = 0; i < len; i += 1) {\n    if (array[i] === element) {\n      return i;\n    }\n  }\n\n  return -1;\n}\n\n/**\n * Internal structure to represent node;\n */\nfunction Node(id, data) {\n  this.id = id;\n  this.links = null;\n  this.data = data;\n}\n\nfunction addLinkToNode(node, link) {\n  if (node.links) {\n    node.links.push(link);\n  } else {\n    node.links = [link];\n  }\n}\n\n/**\n * Internal structure to represent links;\n */\nfunction Link(fromId, toId, data, id) {\n  this.fromId = fromId;\n  this.toId = toId;\n  this.data = data;\n  this.id = id;\n}\n\nfunction hashCode(str) {\n  var hash = 0, i, chr, len;\n  if (str.length == 0) return hash;\n  for (i = 0, len = str.length; i < len; i++) {\n    chr   = str.charCodeAt(i);\n    hash  = ((hash << 5) - hash) + chr;\n    hash |= 0; // Convert to 32bit integer\n  }\n  return hash;\n}\n\nfunction makeLinkId(fromId, toId) {\n  return fromId.toString() + ' ' + toId.toString();\n}\n\n},{\"ngraph.events\":9}],17:[function(require,module,exports){\nmodule.exports = merge;\n\n/**\n * Augments `target` with properties in `options`. Does not override\n * target's properties if they are defined and matches expected type in \n * options\n *\n * @returns {Object} merged object\n */\nfunction merge(target, options) {\n  var key;\n  if (!target) { target = {}; }\n  if (options) {\n    for (key in options) {\n      if (options.hasOwnProperty(key)) {\n        var targetHasIt = target.hasOwnProperty(key),\n            optionsValueType = typeof options[key],\n            shouldReplace = !targetHasIt || (typeof target[key] !== optionsValueType);\n\n        if (shouldReplace) {\n          target[key] = options[key];\n        } else if (optionsValueType === 'object') {\n          // go deep, don't care about loops here, we are simple API!:\n          target[key] = merge(target[key], options[key]);\n        }\n      }\n    }\n  }\n\n  return target;\n}\n\n},{}],18:[function(require,module,exports){\nmodule.exports = {\n  Body: Body,\n  Vector2d: Vector2d,\n  Body3d: Body3d,\n  Vector3d: Vector3d\n};\n\nfunction Body(x, y) {\n  this.pos = new Vector2d(x, y);\n  this.prevPos = new Vector2d(x, y);\n  this.force = new Vector2d();\n  this.velocity = new Vector2d();\n  this.mass = 1;\n}\n\nBody.prototype.setPosition = function (x, y) {\n  this.prevPos.x = this.pos.x = x;\n  this.prevPos.y = this.pos.y = y;\n};\n\nfunction Vector2d(x, y) {\n  if (x && typeof x !== 'number') {\n    // could be another vector\n    this.x = typeof x.x === 'number' ? x.x : 0;\n    this.y = typeof x.y === 'number' ? x.y : 0;\n  } else {\n    this.x = typeof x === 'number' ? x : 0;\n    this.y = typeof y === 'number' ? y : 0;\n  }\n}\n\nVector2d.prototype.reset = function () {\n  this.x = this.y = 0;\n};\n\nfunction Body3d(x, y, z) {\n  this.pos = new Vector3d(x, y, z);\n  this.prevPos = new Vector3d(x, y, z);\n  this.force = new Vector3d();\n  this.velocity = new Vector3d();\n  this.mass = 1;\n}\n\nBody3d.prototype.setPosition = function (x, y, z) {\n  this.prevPos.x = this.pos.x = x;\n  this.prevPos.y = this.pos.y = y;\n  this.prevPos.z = this.pos.z = z;\n};\n\nfunction Vector3d(x, y, z) {\n  if (x && typeof x !== 'number') {\n    // could be another vector\n    this.x = typeof x.x === 'number' ? x.x : 0;\n    this.y = typeof x.y === 'number' ? x.y : 0;\n    this.z = typeof x.z === 'number' ? x.z : 0;\n  } else {\n    this.x = typeof x === 'number' ? x : 0;\n    this.y = typeof y === 'number' ? y : 0;\n    this.z = typeof z === 'number' ? z : 0;\n  }\n};\n\nVector3d.prototype.reset = function () {\n  this.x = this.y = this.z = 0;\n};\n\n},{}],19:[function(require,module,exports){\n/**\n * Manages a simulation of physical forces acting on bodies and springs.\n */\nmodule.exports = physicsSimulator;\n\nfunction physicsSimulator(settings) {\n  var Spring = require('./lib/spring');\n  var expose = require('ngraph.expose');\n  var merge = require('ngraph.merge');\n  var eventify = require('ngraph.events');\n\n  settings = merge(settings, {\n      /**\n       * Ideal length for links (springs in physical model).\n       */\n      springLength: 30,\n\n      /**\n       * Hook's law coefficient. 1 - solid spring.\n       */\n      springCoeff: 0.0008,\n\n      /**\n       * Coulomb's law coefficient. It's used to repel nodes thus should be negative\n       * if you make it positive nodes start attract each other :).\n       */\n      gravity: -1.2,\n\n      /**\n       * Theta coefficient from Barnes Hut simulation. Ranged between (0, 1).\n       * The closer it's to 1 the more nodes algorithm will have to go through.\n       * Setting it to one makes Barnes Hut simulation no different from\n       * brute-force forces calculation (each node is considered).\n       */\n      theta: 0.8,\n\n      /**\n       * Drag force coefficient. Used to slow down system, thus should be less than 1.\n       * The closer it is to 0 the less tight system will be.\n       */\n      dragCoeff: 0.02,\n\n      /**\n       * Default time step (dt) for forces integration\n       */\n      timeStep : 20,\n  });\n\n  // We allow clients to override basic factory methods:\n  var createQuadTree = settings.createQuadTree || require('ngraph.quadtreebh');\n  var createBounds = settings.createBounds || require('./lib/bounds');\n  var createDragForce = settings.createDragForce || require('./lib/dragForce');\n  var createSpringForce = settings.createSpringForce || require('./lib/springForce');\n  var integrate = settings.integrator || require('./lib/eulerIntegrator');\n  var createBody = settings.createBody || require('./lib/createBody');\n\n  var bodies = [], // Bodies in this simulation.\n      springs = [], // Springs in this simulation.\n      quadTree =  createQuadTree(settings),\n      bounds = createBounds(bodies, settings),\n      springForce = createSpringForce(settings),\n      dragForce = createDragForce(settings);\n\n  var bboxNeedsUpdate = true;\n  var totalMovement = 0; // how much movement we made on last step\n\n  var publicApi = {\n    /**\n     * Array of bodies, registered with current simulator\n     *\n     * Note: To add new body, use addBody() method. This property is only\n     * exposed for testing/performance purposes.\n     */\n    bodies: bodies,\n\n    quadTree: quadTree,\n\n    /**\n     * Array of springs, registered with current simulator\n     *\n     * Note: To add new spring, use addSpring() method. This property is only\n     * exposed for testing/performance purposes.\n     */\n    springs: springs,\n\n    /**\n     * Returns settings with which current simulator was initialized\n     */\n    settings: settings,\n\n    /**\n     * Performs one step of force simulation.\n     *\n     * @returns {boolean} true if system is considered stable; False otherwise.\n     */\n    step: function () {\n      accumulateForces();\n\n      var movement = integrate(bodies, settings.timeStep);\n      bounds.update();\n\n      return movement;\n    },\n\n    /**\n     * Adds body to the system\n     *\n     * @param {ngraph.physics.primitives.Body} body physical body\n     *\n     * @returns {ngraph.physics.primitives.Body} added body\n     */\n    addBody: function (body) {\n      if (!body) {\n        throw new Error('Body is required');\n      }\n      bodies.push(body);\n\n      return body;\n    },\n\n    /**\n     * Adds body to the system at given position\n     *\n     * @param {Object} pos position of a body\n     *\n     * @returns {ngraph.physics.primitives.Body} added body\n     */\n    addBodyAt: function (pos) {\n      if (!pos) {\n        throw new Error('Body position is required');\n      }\n      var body = createBody(pos);\n      bodies.push(body);\n\n      return body;\n    },\n\n    /**\n     * Removes body from the system\n     *\n     * @param {ngraph.physics.primitives.Body} body to remove\n     *\n     * @returns {Boolean} true if body found and removed. falsy otherwise;\n     */\n    removeBody: function (body) {\n      if (!body) { return; }\n\n      var idx = bodies.indexOf(body);\n      if (idx < 0) { return; }\n\n      bodies.splice(idx, 1);\n      if (bodies.length === 0) {\n        bounds.reset();\n      }\n      return true;\n    },\n\n    /**\n     * Adds a spring to this simulation.\n     *\n     * @returns {Object} - a handle for a spring. If you want to later remove\n     * spring pass it to removeSpring() method.\n     */\n    addSpring: function (body1, body2, springLength, springWeight, springCoefficient) {\n      if (!body1 || !body2) {\n        throw new Error('Cannot add null spring to force simulator');\n      }\n\n      if (typeof springLength !== 'number') {\n        springLength = -1; // assume global configuration\n      }\n\n      var spring = new Spring(body1, body2, springLength, springCoefficient >= 0 ? springCoefficient : -1, springWeight);\n      springs.push(spring);\n\n      // TODO: could mark simulator as dirty.\n      return spring;\n    },\n\n    /**\n     * Returns amount of movement performed on last step() call\n     */\n    getTotalMovement: function () {\n      return totalMovement;\n    },\n\n    /**\n     * Removes spring from the system\n     *\n     * @param {Object} spring to remove. Spring is an object returned by addSpring\n     *\n     * @returns {Boolean} true if spring found and removed. falsy otherwise;\n     */\n    removeSpring: function (spring) {\n      if (!spring) { return; }\n      var idx = springs.indexOf(spring);\n      if (idx > -1) {\n        springs.splice(idx, 1);\n        return true;\n      }\n    },\n\n    getBestNewBodyPosition: function (neighbors) {\n      return bounds.getBestNewPosition(neighbors);\n    },\n\n    /**\n     * Returns bounding box which covers all bodies\n     */\n    getBBox: function () {\n      if (bboxNeedsUpdate) {\n        bounds.update();\n        bboxNeedsUpdate = false;\n      }\n      return bounds.box;\n    },\n\n    invalidateBBox: function () {\n      bboxNeedsUpdate = true;\n    },\n\n    gravity: function (value) {\n      if (value !== undefined) {\n        settings.gravity = value;\n        quadTree.options({gravity: value});\n        return this;\n      } else {\n        return settings.gravity;\n      }\n    },\n\n    theta: function (value) {\n      if (value !== undefined) {\n        settings.theta = value;\n        quadTree.options({theta: value});\n        return this;\n      } else {\n        return settings.theta;\n      }\n    }\n  };\n\n  // allow settings modification via public API:\n  expose(settings, publicApi);\n\n  eventify(publicApi);\n\n  return publicApi;\n\n  function accumulateForces() {\n    // Accumulate forces acting on bodies.\n    var body,\n        i = bodies.length;\n\n    if (i) {\n      // only add bodies if there the array is not empty:\n      quadTree.insertBodies(bodies); // performance: O(n * log n)\n      while (i--) {\n        body = bodies[i];\n        // If body is pinned there is no point updating its forces - it should\n        // never move:\n        if (!body.isPinned) {\n          body.force.reset();\n\n          quadTree.updateBodyForce(body);\n          dragForce.update(body);\n        }\n      }\n    }\n\n    i = springs.length;\n    while(i--) {\n      springForce.update(springs[i]);\n    }\n  }\n};\n\n},{\"./lib/bounds\":20,\"./lib/createBody\":21,\"./lib/dragForce\":22,\"./lib/eulerIntegrator\":23,\"./lib/spring\":24,\"./lib/springForce\":25,\"ngraph.events\":9,\"ngraph.expose\":10,\"ngraph.merge\":17,\"ngraph.quadtreebh\":26}],20:[function(require,module,exports){\nmodule.exports = function (bodies, settings) {\n  var random = require('ngraph.random').random(42);\n  var boundingBox =  { x1: 0, y1: 0, x2: 0, y2: 0 };\n\n  return {\n    box: boundingBox,\n\n    update: updateBoundingBox,\n\n    reset : function () {\n      boundingBox.x1 = boundingBox.y1 = 0;\n      boundingBox.x2 = boundingBox.y2 = 0;\n    },\n\n    getBestNewPosition: function (neighbors) {\n      var graphRect = boundingBox;\n\n      var baseX = 0, baseY = 0;\n\n      if (neighbors.length) {\n        for (var i = 0; i < neighbors.length; ++i) {\n          baseX += neighbors[i].pos.x;\n          baseY += neighbors[i].pos.y;\n        }\n\n        baseX /= neighbors.length;\n        baseY /= neighbors.length;\n      } else {\n        baseX = (graphRect.x1 + graphRect.x2) / 2;\n        baseY = (graphRect.y1 + graphRect.y2) / 2;\n      }\n\n      var springLength = settings.springLength;\n      return {\n        x: baseX + random.next(springLength) - springLength / 2,\n        y: baseY + random.next(springLength) - springLength / 2\n      };\n    }\n  };\n\n  function updateBoundingBox() {\n    var i = bodies.length;\n    if (i === 0) { return; } // don't have to wory here.\n\n    var x1 = Number.MAX_VALUE,\n        y1 = Number.MAX_VALUE,\n        x2 = Number.MIN_VALUE,\n        y2 = Number.MIN_VALUE;\n\n    while(i--) {\n      // this is O(n), could it be done faster with quadtree?\n      // how about pinned nodes?\n      var body = bodies[i];\n      if (body.isPinned) {\n        body.pos.x = body.prevPos.x;\n        body.pos.y = body.prevPos.y;\n      } else {\n        body.prevPos.x = body.pos.x;\n        body.prevPos.y = body.pos.y;\n      }\n      if (body.pos.x < x1) {\n        x1 = body.pos.x;\n      }\n      if (body.pos.x > x2) {\n        x2 = body.pos.x;\n      }\n      if (body.pos.y < y1) {\n        y1 = body.pos.y;\n      }\n      if (body.pos.y > y2) {\n        y2 = body.pos.y;\n      }\n    }\n\n    boundingBox.x1 = x1;\n    boundingBox.x2 = x2;\n    boundingBox.y1 = y1;\n    boundingBox.y2 = y2;\n  }\n}\n\n},{\"ngraph.random\":30}],21:[function(require,module,exports){\nvar physics = require('ngraph.physics.primitives');\n\nmodule.exports = function(pos) {\n  return new physics.Body(pos);\n}\n\n},{\"ngraph.physics.primitives\":18}],22:[function(require,module,exports){\n/**\n * Represents drag force, which reduces force value on each step by given\n * coefficient.\n *\n * @param {Object} options for the drag force\n * @param {Number=} options.dragCoeff drag force coefficient. 0.1 by default\n */\nmodule.exports = function (options) {\n  var merge = require('ngraph.merge'),\n      expose = require('ngraph.expose');\n\n  options = merge(options, {\n    dragCoeff: 0.02\n  });\n\n  var api = {\n    update : function (body) {\n      body.force.x -= options.dragCoeff * body.velocity.x;\n      body.force.y -= options.dragCoeff * body.velocity.y;\n    }\n  };\n\n  // let easy access to dragCoeff:\n  expose(options, api, ['dragCoeff']);\n\n  return api;\n};\n\n},{\"ngraph.expose\":10,\"ngraph.merge\":17}],23:[function(require,module,exports){\n/**\n * Performs forces integration, using given timestep. Uses Euler method to solve\n * differential equation (http://en.wikipedia.org/wiki/Euler_method ).\n *\n * @returns {Number} squared distance of total position updates.\n */\n\nmodule.exports = integrate;\n\nfunction integrate(bodies, timeStep) {\n  var dx = 0, tx = 0,\n      dy = 0, ty = 0,\n      i,\n      max = bodies.length;\n\n  if (max === 0) {\n    return 0;\n  }\n\n  for (i = 0; i < max; ++i) {\n    var body = bodies[i],\n        coeff = timeStep / body.mass;\n\n    body.velocity.x += coeff * body.force.x;\n    body.velocity.y += coeff * body.force.y;\n    var vx = body.velocity.x,\n        vy = body.velocity.y,\n        v = Math.sqrt(vx * vx + vy * vy);\n\n    if (v > 1) {\n      body.velocity.x = vx / v;\n      body.velocity.y = vy / v;\n    }\n\n    dx = timeStep * body.velocity.x;\n    dy = timeStep * body.velocity.y;\n\n    body.pos.x += dx;\n    body.pos.y += dy;\n\n    tx += Math.abs(dx); ty += Math.abs(dy);\n  }\n\n  return (tx * tx + ty * ty)/max;\n}\n\n},{}],24:[function(require,module,exports){\nmodule.exports = Spring;\n\n/**\n * Represents a physical spring. Spring connects two bodies, has rest length\n * stiffness coefficient and optional weight\n */\nfunction Spring(fromBody, toBody, length, coeff, weight) {\n    this.from = fromBody;\n    this.to = toBody;\n    this.length = length;\n    this.coeff = coeff;\n\n    this.weight = typeof weight === 'number' ? weight : 1;\n};\n\n},{}],25:[function(require,module,exports){\n/**\n * Represents spring force, which updates forces acting on two bodies, conntected\n * by a spring.\n *\n * @param {Object} options for the spring force\n * @param {Number=} options.springCoeff spring force coefficient.\n * @param {Number=} options.springLength desired length of a spring at rest.\n */\nmodule.exports = function (options) {\n  var merge = require('ngraph.merge');\n  var random = require('ngraph.random').random(42);\n  var expose = require('ngraph.expose');\n\n  options = merge(options, {\n    springCoeff: 0.0002,\n    springLength: 80\n  });\n\n  var api = {\n    /**\n     * Upsates forces acting on a spring\n     */\n    update : function (spring) {\n      var body1 = spring.from,\n          body2 = spring.to,\n          length = spring.length < 0 ? options.springLength : spring.length,\n          dx = body2.pos.x - body1.pos.x,\n          dy = body2.pos.y - body1.pos.y,\n          r = Math.sqrt(dx * dx + dy * dy);\n\n      if (r === 0) {\n          dx = (random.nextDouble() - 0.5) / 50;\n          dy = (random.nextDouble() - 0.5) / 50;\n          r = Math.sqrt(dx * dx + dy * dy);\n      }\n\n      var d = r - length;\n      var coeff = ((!spring.coeff || spring.coeff < 0) ? options.springCoeff : spring.coeff) * d / r * spring.weight;\n\n      body1.force.x += coeff * dx;\n      body1.force.y += coeff * dy;\n\n      body2.force.x -= coeff * dx;\n      body2.force.y -= coeff * dy;\n    }\n  };\n\n  expose(options, api, ['springCoeff', 'springLength']);\n  return api;\n}\n\n},{\"ngraph.expose\":10,\"ngraph.merge\":17,\"ngraph.random\":30}],26:[function(require,module,exports){\n/**\n * This is Barnes Hut simulation algorithm for 2d case. Implementation\n * is highly optimized (avoids recusion and gc pressure)\n *\n * http://www.cs.princeton.edu/courses/archive/fall03/cs126/assignments/barnes-hut.html\n */\n\nmodule.exports = function(options) {\n  options = options || {};\n  options.gravity = typeof options.gravity === 'number' ? options.gravity : -1;\n  options.theta = typeof options.theta === 'number' ? options.theta : 0.8;\n\n  // we require deterministic randomness here\n  var random = require('ngraph.random').random(1984),\n    Node = require('./node'),\n    InsertStack = require('./insertStack'),\n    isSamePosition = require('./isSamePosition');\n\n  var gravity = options.gravity,\n    updateQueue = [],\n    insertStack = new InsertStack(),\n    theta = options.theta,\n\n    nodesCache = [],\n    currentInCache = 0,\n    root = newNode();\n\n  return {\n    insertBodies: insertBodies,\n    /**\n     * Gets root node if its present\n     */\n    getRoot: function() {\n      return root;\n    },\n    updateBodyForce: update,\n    options: function(newOptions) {\n      if (newOptions) {\n        if (typeof newOptions.gravity === 'number') {\n          gravity = newOptions.gravity;\n        }\n        if (typeof newOptions.theta === 'number') {\n          theta = newOptions.theta;\n        }\n\n        return this;\n      }\n\n      return {\n        gravity: gravity,\n        theta: theta\n      };\n    }\n  };\n\n  function newNode() {\n    // To avoid pressure on GC we reuse nodes.\n    var node = nodesCache[currentInCache];\n    if (node) {\n      node.quad0 = null;\n      node.quad1 = null;\n      node.quad2 = null;\n      node.quad3 = null;\n      node.body = null;\n      node.mass = node.massX = node.massY = 0;\n      node.left = node.right = node.top = node.bottom = 0;\n    } else {\n      node = new Node();\n      nodesCache[currentInCache] = node;\n    }\n\n    ++currentInCache;\n    return node;\n  }\n\n  function update(sourceBody) {\n    var queue = updateQueue,\n      v,\n      dx,\n      dy,\n      r, fx = 0,\n      fy = 0,\n      queueLength = 1,\n      shiftIdx = 0,\n      pushIdx = 1;\n\n    queue[0] = root;\n\n    while (queueLength) {\n      var node = queue[shiftIdx],\n        body = node.body;\n\n      queueLength -= 1;\n      shiftIdx += 1;\n      var differentBody = (body !== sourceBody);\n      if (body && differentBody) {\n        // If the current node is a leaf node (and it is not source body),\n        // calculate the force exerted by the current node on body, and add this\n        // amount to body's net force.\n        dx = body.pos.x - sourceBody.pos.x;\n        dy = body.pos.y - sourceBody.pos.y;\n        r = Math.sqrt(dx * dx + dy * dy);\n\n        if (r === 0) {\n          // Poor man's protection against zero distance.\n          dx = (random.nextDouble() - 0.5) / 50;\n          dy = (random.nextDouble() - 0.5) / 50;\n          r = Math.sqrt(dx * dx + dy * dy);\n        }\n\n        // This is standard gravition force calculation but we divide\n        // by r^3 to save two operations when normalizing force vector.\n        v = gravity * body.mass * sourceBody.mass / (r * r * r);\n        fx += v * dx;\n        fy += v * dy;\n      } else if (differentBody) {\n        // Otherwise, calculate the ratio s / r,  where s is the width of the region\n        // represented by the internal node, and r is the distance between the body\n        // and the node's center-of-mass\n        dx = node.massX / node.mass - sourceBody.pos.x;\n        dy = node.massY / node.mass - sourceBody.pos.y;\n        r = Math.sqrt(dx * dx + dy * dy);\n\n        if (r === 0) {\n          // Sorry about code duplucation. I don't want to create many functions\n          // right away. Just want to see performance first.\n          dx = (random.nextDouble() - 0.5) / 50;\n          dy = (random.nextDouble() - 0.5) / 50;\n          r = Math.sqrt(dx * dx + dy * dy);\n        }\n        // If s / r < , treat this internal node as a single body, and calculate the\n        // force it exerts on sourceBody, and add this amount to sourceBody's net force.\n        if ((node.right - node.left) / r < theta) {\n          // in the if statement above we consider node's width only\n          // because the region was squarified during tree creation.\n          // Thus there is no difference between using width or height.\n          v = gravity * node.mass * sourceBody.mass / (r * r * r);\n          fx += v * dx;\n          fy += v * dy;\n        } else {\n          // Otherwise, run the procedure recursively on each of the current node's children.\n\n          // I intentionally unfolded this loop, to save several CPU cycles.\n          if (node.quad0) {\n            queue[pushIdx] = node.quad0;\n            queueLength += 1;\n            pushIdx += 1;\n          }\n          if (node.quad1) {\n            queue[pushIdx] = node.quad1;\n            queueLength += 1;\n            pushIdx += 1;\n          }\n          if (node.quad2) {\n            queue[pushIdx] = node.quad2;\n            queueLength += 1;\n            pushIdx += 1;\n          }\n          if (node.quad3) {\n            queue[pushIdx] = node.quad3;\n            queueLength += 1;\n            pushIdx += 1;\n          }\n        }\n      }\n    }\n\n    sourceBody.force.x += fx;\n    sourceBody.force.y += fy;\n  }\n\n  function insertBodies(bodies) {\n    var x1 = Number.MAX_VALUE,\n      y1 = Number.MAX_VALUE,\n      x2 = Number.MIN_VALUE,\n      y2 = Number.MIN_VALUE,\n      i,\n      max = bodies.length;\n\n    // To reduce quad tree depth we are looking for exact bounding box of all particles.\n    i = max;\n    while (i--) {\n      var x = bodies[i].pos.x;\n      var y = bodies[i].pos.y;\n      if (x < x1) {\n        x1 = x;\n      }\n      if (x > x2) {\n        x2 = x;\n      }\n      if (y < y1) {\n        y1 = y;\n      }\n      if (y > y2) {\n        y2 = y;\n      }\n    }\n\n    // Squarify the bounds.\n    var dx = x2 - x1,\n      dy = y2 - y1;\n    if (dx > dy) {\n      y2 = y1 + dx;\n    } else {\n      x2 = x1 + dy;\n    }\n\n    currentInCache = 0;\n    root = newNode();\n    root.left = x1;\n    root.right = x2;\n    root.top = y1;\n    root.bottom = y2;\n\n    i = max - 1;\n    if (i >= 0) {\n      root.body = bodies[i];\n    }\n    while (i--) {\n      insert(bodies[i], root);\n    }\n  }\n\n  function insert(newBody) {\n    insertStack.reset();\n    insertStack.push(root, newBody);\n\n    while (!insertStack.isEmpty()) {\n      var stackItem = insertStack.pop(),\n        node = stackItem.node,\n        body = stackItem.body;\n\n      if (!node.body) {\n        // This is internal node. Update the total mass of the node and center-of-mass.\n        var x = body.pos.x;\n        var y = body.pos.y;\n        node.mass = node.mass + body.mass;\n        node.massX = node.massX + body.mass * x;\n        node.massY = node.massY + body.mass * y;\n\n        // Recursively insert the body in the appropriate quadrant.\n        // But first find the appropriate quadrant.\n        var quadIdx = 0, // Assume we are in the 0's quad.\n          left = node.left,\n          right = (node.right + left) / 2,\n          top = node.top,\n          bottom = (node.bottom + top) / 2;\n\n        if (x > right) { // somewhere in the eastern part.\n          quadIdx = quadIdx + 1;\n          left = right;\n          right = node.right;\n        }\n        if (y > bottom) { // and in south.\n          quadIdx = quadIdx + 2;\n          top = bottom;\n          bottom = node.bottom;\n        }\n\n        var child = getChild(node, quadIdx);\n        if (!child) {\n          // The node is internal but this quadrant is not taken. Add\n          // subnode to it.\n          child = newNode();\n          child.left = left;\n          child.top = top;\n          child.right = right;\n          child.bottom = bottom;\n          child.body = body;\n\n          setChild(node, quadIdx, child);\n        } else {\n          // continue searching in this quadrant.\n          insertStack.push(child, body);\n        }\n      } else {\n        // We are trying to add to the leaf node.\n        // We have to convert current leaf into internal node\n        // and continue adding two nodes.\n        var oldBody = node.body;\n        node.body = null; // internal nodes do not cary bodies\n\n        if (isSamePosition(oldBody.pos, body.pos)) {\n          // Prevent infinite subdivision by bumping one node\n          // anywhere in this quadrant\n          var retriesCount = 3;\n          do {\n            var offset = random.nextDouble();\n            var dx = (node.right - node.left) * offset;\n            var dy = (node.bottom - node.top) * offset;\n\n            oldBody.pos.x = node.left + dx;\n            oldBody.pos.y = node.top + dy;\n            retriesCount -= 1;\n            // Make sure we don't bump it out of the box. If we do, next iteration should fix it\n          } while (retriesCount > 0 && isSamePosition(oldBody.pos, body.pos));\n\n          if (retriesCount === 0 && isSamePosition(oldBody.pos, body.pos)) {\n            // This is very bad, we ran out of precision.\n            // if we do not return from the method we'll get into\n            // infinite loop here. So we sacrifice correctness of layout, and keep the app running\n            // Next layout iteration should get larger bounding box in the first step and fix this\n            return;\n          }\n        }\n        // Next iteration should subdivide node further.\n        insertStack.push(node, oldBody);\n        insertStack.push(node, body);\n      }\n    }\n  }\n};\n\nfunction getChild(node, idx) {\n  if (idx === 0) return node.quad0;\n  if (idx === 1) return node.quad1;\n  if (idx === 2) return node.quad2;\n  if (idx === 3) return node.quad3;\n  return null;\n}\n\nfunction setChild(node, idx, child) {\n  if (idx === 0) node.quad0 = child;\n  else if (idx === 1) node.quad1 = child;\n  else if (idx === 2) node.quad2 = child;\n  else if (idx === 3) node.quad3 = child;\n}\n\n},{\"./insertStack\":27,\"./isSamePosition\":28,\"./node\":29,\"ngraph.random\":30}],27:[function(require,module,exports){\nmodule.exports = InsertStack;\n\n/**\n * Our implmentation of QuadTree is non-recursive to avoid GC hit\n * This data structure represent stack of elements\n * which we are trying to insert into quad tree.\n */\nfunction InsertStack () {\n    this.stack = [];\n    this.popIdx = 0;\n}\n\nInsertStack.prototype = {\n    isEmpty: function() {\n        return this.popIdx === 0;\n    },\n    push: function (node, body) {\n        var item = this.stack[this.popIdx];\n        if (!item) {\n            // we are trying to avoid memory pressue: create new element\n            // only when absolutely necessary\n            this.stack[this.popIdx] = new InsertStackElement(node, body);\n        } else {\n            item.node = node;\n            item.body = body;\n        }\n        ++this.popIdx;\n    },\n    pop: function () {\n        if (this.popIdx > 0) {\n            return this.stack[--this.popIdx];\n        }\n    },\n    reset: function () {\n        this.popIdx = 0;\n    }\n};\n\nfunction InsertStackElement(node, body) {\n    this.node = node; // QuadTree node\n    this.body = body; // physical body which needs to be inserted to node\n}\n\n},{}],28:[function(require,module,exports){\nmodule.exports = function isSamePosition(point1, point2) {\n    var dx = Math.abs(point1.x - point2.x);\n    var dy = Math.abs(point1.y - point2.y);\n\n    return (dx < 1e-8 && dy < 1e-8);\n};\n\n},{}],29:[function(require,module,exports){\n/**\n * Internal data structure to represent 2D QuadTree node\n */\nmodule.exports = function Node() {\n  // body stored inside this node. In quad tree only leaf nodes (by construction)\n  // contain boides:\n  this.body = null;\n\n  // Child nodes are stored in quads. Each quad is presented by number:\n  // 0 | 1\n  // -----\n  // 2 | 3\n  this.quad0 = null;\n  this.quad1 = null;\n  this.quad2 = null;\n  this.quad3 = null;\n\n  // Total mass of current node\n  this.mass = 0;\n\n  // Center of mass coordinates\n  this.massX = 0;\n  this.massY = 0;\n\n  // bounding box coordinates\n  this.left = 0;\n  this.top = 0;\n  this.bottom = 0;\n  this.right = 0;\n};\n\n},{}],30:[function(require,module,exports){\nmodule.exports = {\n  random: random,\n  randomIterator: randomIterator\n};\n\n/**\n * Creates seeded PRNG with two methods:\n *   next() and nextDouble()\n */\nfunction random(inputSeed) {\n  var seed = typeof inputSeed === 'number' ? inputSeed : (+ new Date());\n  var randomFunc = function() {\n      // Robert Jenkins' 32 bit integer hash function.\n      seed = ((seed + 0x7ed55d16) + (seed << 12))  & 0xffffffff;\n      seed = ((seed ^ 0xc761c23c) ^ (seed >>> 19)) & 0xffffffff;\n      seed = ((seed + 0x165667b1) + (seed << 5))   & 0xffffffff;\n      seed = ((seed + 0xd3a2646c) ^ (seed << 9))   & 0xffffffff;\n      seed = ((seed + 0xfd7046c5) + (seed << 3))   & 0xffffffff;\n      seed = ((seed ^ 0xb55a4f09) ^ (seed >>> 16)) & 0xffffffff;\n      return (seed & 0xfffffff) / 0x10000000;\n  };\n\n  return {\n      /**\n       * Generates random integer number in the range from 0 (inclusive) to maxValue (exclusive)\n       *\n       * @param maxValue Number REQUIRED. Ommitting this number will result in NaN values from PRNG.\n       */\n      next : function (maxValue) {\n          return Math.floor(randomFunc() * maxValue);\n      },\n\n      /**\n       * Generates random double number in the range from 0 (inclusive) to 1 (exclusive)\n       * This function is the same as Math.random() (except that it could be seeded)\n       */\n      nextDouble : function () {\n          return randomFunc();\n      }\n  };\n}\n\n/*\n * Creates iterator over array, which returns items of array in random order\n * Time complexity is guaranteed to be O(n);\n */\nfunction randomIterator(array, customRandom) {\n    var localRandom = customRandom || random();\n    if (typeof localRandom.next !== 'function') {\n      throw new Error('customRandom does not match expected API: next() function is missing');\n    }\n\n    return {\n        forEach : function (callback) {\n            var i, j, t;\n            for (i = array.length - 1; i > 0; --i) {\n                j = localRandom.next(i + 1); // i inclusive\n                t = array[j];\n                array[j] = array[i];\n                array[i] = t;\n\n                callback(t);\n            }\n\n            if (array.length) {\n                callback(array[0]);\n            }\n        },\n\n        /**\n         * Shuffles array randomly, in place.\n         */\n        shuffle : function () {\n            var i, j, t;\n            for (i = array.length - 1; i > 0; --i) {\n                j = localRandom.next(i + 1); // i inclusive\n                t = array[j];\n                array[j] = array[i];\n                array[i] = t;\n            }\n\n            return array;\n        }\n    };\n}\n\n},{}],31:[function(require,module,exports){\nmodule.exports = save;\n\nfunction save(graph, customNodeTransform, customLinkTransform) {\n  // Object contains `nodes` and `links` arrays.\n  var result = {\n    nodes: [],\n    links: []\n  };\n\n  var nodeTransform = customNodeTransform || defaultTransformForNode;\n  var linkTransform = customLinkTransform || defaultTransformForLink;\n\n  graph.forEachNode(saveNode);\n  graph.forEachLink(saveLink);\n\n  return JSON.stringify(result);\n\n  function saveNode(node) {\n    // Each node of the graph is processed to take only required fields\n    // `id` and `data`\n    result.nodes.push(nodeTransform(node));\n  }\n\n  function saveLink(link) {\n    // Each link of the graph is also processed to take `fromId`, `toId` and\n    // `data`\n    result.links.push(linkTransform(link));\n  }\n\n  function defaultTransformForNode(node) {\n    var result = {\n      id: node.id\n    };\n    // We don't want to store undefined fields when it's not necessary:\n    if (node.data !== undefined) {\n      result.data = node.data;\n    }\n\n    return result;\n  }\n\n  function defaultTransformForLink(link) {\n    var result = {\n      fromId: link.fromId,\n      toId: link.toId,\n    };\n\n    if (link.data !== undefined) {\n      result.data = link.data;\n    }\n\n    return result;\n  }\n}\n\n},{}],32:[function(require,module,exports){\nmodule.exports = svg;\n\nsvg.compile = require('./lib/compile');\n\nvar compileTemplate = svg.compileTemplate = require('./lib/compile_template');\n\nvar domEvents = require('add-event-listener');\n\nvar svgns = \"http://www.w3.org/2000/svg\";\nvar xlinkns = \"http://www.w3.org/1999/xlink\";\n\nfunction svg(element, attrBag) {\n  var svgElement = augment(element);\n  if (attrBag === undefined) {\n    return svgElement;\n  }\n\n  var attributes = Object.keys(attrBag);\n  for (var i = 0; i < attributes.length; ++i) {\n    var attributeName = attributes[i];\n    var value = attrBag[attributeName];\n    if (attributeName === 'link') {\n      svgElement.link(value);\n    } else {\n      svgElement.attr(attributeName, value);\n    }\n  }\n\n  return svgElement;\n}\n\nfunction augment(element) {\n  var svgElement = element;\n\n  if (typeof element === \"string\") {\n    svgElement = window.document.createElementNS(svgns, element);\n  } else if (element.simplesvg) {\n    return element;\n  }\n\n  var compiledTempalte;\n\n  svgElement.simplesvg = true; // this is not good, since we are monkey patching svg\n  svgElement.attr = attr;\n  svgElement.append = append;\n  svgElement.link = link;\n  svgElement.text = text;\n\n  // add easy eventing\n  svgElement.on = on;\n  svgElement.off = off;\n\n  // data binding:\n  svgElement.dataSource = dataSource;\n\n  return svgElement;\n\n  function dataSource(model) {\n    if (!compiledTempalte) compiledTempalte = compileTemplate(svgElement);\n    compiledTempalte.link(model);\n    return svgElement;\n  }\n\n  function on(name, cb, useCapture) {\n    domEvents.addEventListener(svgElement, name, cb, useCapture);\n    return svgElement;\n  }\n\n  function off(name, cb, useCapture) {\n    domEvents.removeEventListener(svgElement, name, cb, useCapture);\n    return svgElement;\n  }\n\n  function append(content) {\n    var child = svg(content);\n    svgElement.appendChild(child);\n\n    return child;\n  }\n\n  function attr(name, value) {\n    if (arguments.length === 2) {\n      if (value !== null) {\n        svgElement.setAttributeNS(null, name, value);\n      } else {\n        svgElement.removeAttributeNS(null, name);\n      }\n\n      return svgElement;\n    }\n\n    return svgElement.getAttributeNS(null, name);\n  }\n\n  function link(target) {\n    if (arguments.length) {\n      svgElement.setAttributeNS(xlinkns, \"xlink:href\", target);\n      return svgElement;\n    }\n\n    return svgElement.getAttributeNS(xlinkns, \"xlink:href\");\n  }\n\n  function text(textContent) {\n    if (textContent !== undefined) {\n        svgElement.textContent = textContent;\n        return svgElement;\n    }\n    return svgElement.textContent;\n  }\n}\n\n},{\"./lib/compile\":33,\"./lib/compile_template\":34,\"add-event-listener\":2}],33:[function(require,module,exports){\nvar parser = require('./domparser.js');\nvar svg = require('../');\n\nmodule.exports = compile;\n\nfunction compile(svgText) {\n  try {\n    svgText = addNamespaces(svgText);\n    return svg(parser.parseFromString(svgText, \"text/xml\").documentElement);\n  } catch (e) {\n    throw e;\n  }\n}\n\nfunction addNamespaces(text) {\n  if (!text) return;\n\n  var namespaces = 'xmlns:svg=\"http://www.w3.org/2000/svg\" xmlns=\"http://www.w3.org/2000/svg\"';\n  var match = text.match(/^<\\w+/);\n  if (match) {\n    var tagLength = match[0].length;\n    return text.substr(0, tagLength) + ' ' + namespaces + ' ' + text.substr(tagLength);\n  } else {\n    throw new Error('Cannot parse input text: invalid xml?');\n  }\n}\n\n},{\"../\":32,\"./domparser.js\":35}],34:[function(require,module,exports){\nmodule.exports = template;\n\nvar BINDING_EXPR = /{{(.+?)}}/;\n\nfunction template(domNode) {\n  var allBindings = Object.create(null);\n  extractAllBindings(domNode, allBindings);\n\n  return {\n    link: function(model) {\n      Object.keys(allBindings).forEach(function(key) {\n        var setter = allBindings[key];\n        setter.forEach(changeModel);\n      });\n\n      function changeModel(setter) {\n        setter(model);\n      }\n    }\n  };\n}\n\nfunction extractAllBindings(domNode, allBindings) {\n  var nodeType = domNode.nodeType;\n  var typeSupported = (nodeType === 1) || (nodeType === 3);\n  if (!typeSupported) return;\n  var i;\n  if (domNode.hasChildNodes()) {\n    var domChildren = domNode.childNodes;\n    for (i = 0; i < domChildren.length; ++i) {\n      extractAllBindings(domChildren[i], allBindings);\n    }\n  }\n\n  if (nodeType === 3) { // text:\n    bindTextContent(domNode, allBindings);\n  }\n\n  if (!domNode.attributes) return; // this might be a text. Need to figure out what to do in that case\n\n  var attrs = domNode.attributes;\n  for (i = 0; i < attrs.length; ++i) {\n    bindDomAttribute(attrs[i], domNode, allBindings);\n  }\n}\n\nfunction bindDomAttribute(domAttribute, element, allBindings) {\n  var value = domAttribute.value;\n  if (!value) return; // unary attribute?\n\n  var modelNameMatch = value.match(BINDING_EXPR);\n  if (!modelNameMatch) return; // does not look like a binding\n\n  var attrName = domAttribute.localName;\n  var modelPropertyName = modelNameMatch[1];\n  var isSimpleValue = modelPropertyName.indexOf('.') < 0;\n\n  if (!isSimpleValue) throw new Error('simplesvg currently does not support nested bindings');\n\n  var propertyBindings = allBindings[modelPropertyName];\n  if (!propertyBindings) {\n    propertyBindings = allBindings[modelPropertyName] = [attributeSetter];\n  } else {\n    propertyBindings.push(attributeSetter);\n  }\n\n  function attributeSetter(model) {\n    element.setAttributeNS(null, attrName, model[modelPropertyName]);\n  }\n}\nfunction bindTextContent(element, allBindings) {\n  // todo reduce duplication\n  var value = element.nodeValue;\n  if (!value) return; // unary attribute?\n\n  var modelNameMatch = value.match(BINDING_EXPR);\n  if (!modelNameMatch) return; // does not look like a binding\n\n  var modelPropertyName = modelNameMatch[1];\n  var isSimpleValue = modelPropertyName.indexOf('.') < 0;\n\n  var propertyBindings = allBindings[modelPropertyName];\n  if (!propertyBindings) {\n    propertyBindings = allBindings[modelPropertyName] = [textSetter];\n  } else {\n    propertyBindings.push(textSetter);\n  }\n\n  function textSetter(model) {\n    element.nodeValue = model[modelPropertyName];\n  }\n}\n\n},{}],35:[function(require,module,exports){\nmodule.exports = createDomparser();\n\nfunction createDomparser() {\n  if (typeof DOMParser === 'undefined') {\n    return {\n      parseFromString: fail\n    };\n  }\n  return new DOMParser();\n}\n\nfunction fail() {\n  throw new Error('DOMParser is not supported by this platform. Please open issue here https://github.com/anvaka/simplesvg');\n}\n\n},{}],36:[function(require,module,exports){\nvar centrality = require('ngraph.centrality');\n\nmodule.exports = centralityWrapper;\n\nfunction centralityWrapper() {\n  // TODO: This should not be a function\n  return {\n    betweennessCentrality: betweennessCentrality,\n    degreeCentrality: degreeCentrality\n  };\n}\n\nfunction betweennessCentrality(g) {\n  var betweenness = centrality.betweenness(g);\n  return toVivaGraphCentralityFormat(betweenness);\n}\n\nfunction degreeCentrality(g, kind) {\n  var degree = centrality.degree(g, kind);\n  return toVivaGraphCentralityFormat(degree);\n}\n\nfunction toVivaGraphCentralityFormat(centrality) {\n  return Object.keys(centrality).sort(byValue).map(toKeyValue);\n\n  function byValue(x, y) {\n    return centrality[y] - centrality[x];\n  }\n\n  function toKeyValue(key) {\n    return {\n      key: key,\n      value: centrality[key]\n    };\n  }\n}\n\n},{\"ngraph.centrality\":4}],37:[function(require,module,exports){\n/**\r\n * @fileOverview Contains collection of primitive operations under graph.\r\n *\r\n * @author Andrei Kashcha (aka anvaka) / https://github.com/anvaka\r\n */\r\nmodule.exports = operations;\r\n\r\nfunction operations() {\r\n\r\n    return {\r\n        /**\r\n         * Gets graph density, which is a ratio of actual number of edges to maximum\r\n         * number of edges. I.e. graph density 1 means all nodes are connected with each other with an edge.\r\n         * Density 0 - graph has no edges. Runtime: O(1)\r\n         * \r\n         * @param graph represents oriented graph structure.\r\n         * @param directed (optional boolean) represents if the graph should be treated as a directed graph.\r\n         * \r\n         * @returns density of the graph if graph has nodes. NaN otherwise. Returns density for undirected graph by default but returns density for directed graph if a boolean 'true' is passed along with the graph.\r\n         */\r\n        density : function (graph,directed) {\r\n            var nodes = graph.getNodesCount();\r\n            if (nodes === 0) {\r\n                return NaN;\r\n            }\r\n            if(directed){\r\n                return graph.getLinksCount() / (nodes * (nodes - 1));\r\n            } else {\r\n                return 2 * graph.getLinksCount() / (nodes * (nodes - 1));\r\n            }\r\n        }\r\n    };\r\n};\r\n\n},{}],38:[function(require,module,exports){\n/**\n * @author Andrei Kashcha (aka anvaka) / https://github.com/anvaka\n */\n\nmodule.exports = domInputManager;\n\nvar dragndrop = require('./dragndrop.js');\n\nfunction domInputManager(graph, graphics) {\n  var nodeEvents = {};\n  return {\n    /**\n     * Called by renderer to listen to drag-n-drop events from node. E.g. for SVG\n     * graphics we may listen to DOM events, whereas for WebGL the graphics\n     * should provide custom eventing mechanism.\n     *\n     * @param node - to be monitored.\n     * @param handlers - object with set of three callbacks:\n     *   onStart: function(),\n     *   onDrag: function(e, offset),\n     *   onStop: function()\n     */\n    bindDragNDrop: bindDragNDrop\n  };\n\n  function bindDragNDrop(node, handlers) {\n    var events;\n    if (handlers) {\n      var nodeUI = graphics.getNodeUI(node.id);\n      events = dragndrop(nodeUI);\n      if (typeof handlers.onStart === 'function') {\n        events.onStart(handlers.onStart);\n      }\n      if (typeof handlers.onDrag === 'function') {\n        events.onDrag(handlers.onDrag);\n      }\n      if (typeof handlers.onStop === 'function') {\n        events.onStop(handlers.onStop);\n      }\n\n      nodeEvents[node.id] = events;\n    } else if ((events = nodeEvents[node.id])) {\n      events.release();\n      delete nodeEvents[node.id];\n    }\n  }\n}\n\n},{\"./dragndrop.js\":39}],39:[function(require,module,exports){\n/**\n * @author Andrei Kashcha (aka anvaka) / https://github.com/anvaka\n */\n\nmodule.exports = dragndrop;\n\nvar documentEvents = require('../Utils/documentEvents.js');\nvar browserInfo = require('../Utils/browserInfo.js');\nvar findElementPosition = require('../Utils/findElementPosition.js');\n\n// TODO: Move to input namespace\n// TODO: Methods should be extracted into the prototype. This class\n// does not need to consume so much memory for every tracked element\nfunction dragndrop(element) {\n    var start,\n        drag,\n        end,\n        scroll,\n        prevSelectStart,\n        prevDragStart,\n\n        startX = 0,\n        startY = 0,\n        dragObject,\n        touchInProgress = false,\n        pinchZoomLength = 0,\n\n        getMousePos = function (e) {\n            var posx = 0,\n                posy = 0;\n\n            e = e || window.event;\n\n            if (e.pageX || e.pageY) {\n                posx = e.pageX;\n                posy = e.pageY;\n            } else if (e.clientX || e.clientY) {\n                posx = e.clientX + window.document.body.scrollLeft + window.document.documentElement.scrollLeft;\n                posy = e.clientY + window.document.body.scrollTop + window.document.documentElement.scrollTop;\n            }\n\n            return [posx, posy];\n        },\n\n        move = function (e, clientX, clientY) {\n            if (drag) {\n                drag(e, {x : clientX - startX, y : clientY - startY });\n            }\n\n            startX = clientX;\n            startY = clientY;\n        },\n\n        stopPropagation = function (e) {\n            if (e.stopPropagation) { e.stopPropagation(); } else { e.cancelBubble = true; }\n        },\n        preventDefault = function (e) {\n            if (e.preventDefault) { e.preventDefault(); }\n        },\n\n        handleDisabledEvent = function (e) {\n            stopPropagation(e);\n            return false;\n        },\n\n        handleMouseMove = function (e) {\n            e = e || window.event;\n\n            move(e, e.clientX, e.clientY);\n        },\n\n        handleMouseDown = function (e) {\n            e = e || window.event;\n            if (touchInProgress) {\n                // modern browsers will fire mousedown for touch events too\n                // we do not want this, since touch is handled separately.\n                stopPropagation(e);\n                return false;\n            }\n            // for IE, left click == 1\n            // for Firefox, left click == 0\n            var isLeftButton = ((e.button === 1 && window.event !== null) || e.button === 0);\n\n            if (isLeftButton) {\n                startX = e.clientX;\n                startY = e.clientY;\n\n                // TODO: bump zIndex?\n                dragObject = e.target || e.srcElement;\n\n                if (start) { start(e, {x: startX, y : startY}); }\n\n                documentEvents.on('mousemove', handleMouseMove);\n                documentEvents.on('mouseup', handleMouseUp);\n\n\n                stopPropagation(e);\n                // TODO: What if event already there? Not bullet proof:\n                prevSelectStart = window.document.onselectstart;\n                prevDragStart = window.document.ondragstart;\n\n                window.document.onselectstart = handleDisabledEvent;\n                dragObject.ondragstart = handleDisabledEvent;\n\n                // prevent text selection (except IE)\n                return false;\n            }\n        },\n\n        handleMouseUp = function (e) {\n            e = e || window.event;\n\n            documentEvents.off('mousemove', handleMouseMove);\n            documentEvents.off('mouseup', handleMouseUp);\n\n            window.document.onselectstart = prevSelectStart;\n            dragObject.ondragstart = prevDragStart;\n            dragObject = null;\n            if (end) { end(e); }\n        },\n\n        handleMouseWheel = function (e) {\n            if (typeof scroll !== 'function') {\n                return;\n            }\n\n            e = e || window.event;\n            if (e.preventDefault) {\n                e.preventDefault();\n            }\n\n            e.returnValue = false;\n            var delta,\n                mousePos = getMousePos(e),\n                elementOffset = findElementPosition(element),\n                relMousePos = {\n                    x: mousePos[0] - elementOffset[0],\n                    y: mousePos[1] - elementOffset[1]\n                };\n\n            if (e.wheelDelta) {\n                delta = e.wheelDelta / 360; // Chrome/Safari\n            } else {\n                delta = e.detail / -9; // Mozilla\n            }\n\n            scroll(e, delta, relMousePos);\n        },\n\n        updateScrollEvents = function (scrollCallback) {\n            if (!scroll && scrollCallback) {\n                // client is interested in scrolling. Start listening to events:\n                if (browserInfo.browser === 'webkit') {\n                    element.addEventListener('mousewheel', handleMouseWheel, false); // Chrome/Safari\n                } else {\n                    element.addEventListener('DOMMouseScroll', handleMouseWheel, false); // Others\n                }\n            } else if (scroll && !scrollCallback) {\n                if (browserInfo.browser === 'webkit') {\n                    element.removeEventListener('mousewheel', handleMouseWheel, false); // Chrome/Safari\n                } else {\n                    element.removeEventListener('DOMMouseScroll', handleMouseWheel, false); // Others\n                }\n            }\n\n            scroll = scrollCallback;\n        },\n\n        getPinchZoomLength = function(finger1, finger2) {\n            return (finger1.clientX - finger2.clientX) * (finger1.clientX - finger2.clientX) +\n                   (finger1.clientY - finger2.clientY) * (finger1.clientY - finger2.clientY);\n        },\n\n        handleTouchMove = function (e) {\n            if (e.touches.length === 1) {\n                stopPropagation(e);\n\n                var touch = e.touches[0];\n                move(e, touch.clientX, touch.clientY);\n            } else if (e.touches.length === 2) {\n                // it's a zoom:\n                var currentPinchLength = getPinchZoomLength(e.touches[0], e.touches[1]);\n                var delta = 0;\n                if (currentPinchLength < pinchZoomLength) {\n                    delta = -1;\n                } else if (currentPinchLength > pinchZoomLength) {\n                    delta = 1;\n                }\n                scroll(e, delta, {x: e.touches[0].clientX, y: e.touches[0].clientY});\n                pinchZoomLength = currentPinchLength;\n                stopPropagation(e);\n                preventDefault(e);\n            }\n        },\n\n        handleTouchEnd = function (e) {\n            touchInProgress = false;\n            documentEvents.off('touchmove', handleTouchMove);\n            documentEvents.off('touchend', handleTouchEnd);\n            documentEvents.off('touchcancel', handleTouchEnd);\n            dragObject = null;\n            if (end) { end(e); }\n        },\n\n        handleSignleFingerTouch = function (e, touch) {\n            stopPropagation(e);\n            preventDefault(e);\n\n            startX = touch.clientX;\n            startY = touch.clientY;\n\n            dragObject = e.target || e.srcElement;\n\n            if (start) { start(e, {x: startX, y : startY}); }\n            // TODO: can I enter into the state when touch is in progress\n            // but it's still a single finger touch?\n            if (!touchInProgress) {\n                touchInProgress = true;\n                documentEvents.on('touchmove', handleTouchMove);\n                documentEvents.on('touchend', handleTouchEnd);\n                documentEvents.on('touchcancel', handleTouchEnd);\n            }\n        },\n\n        handleTouchStart = function (e) {\n            if (e.touches.length === 1) {\n                return handleSignleFingerTouch(e, e.touches[0]);\n            } else if (e.touches.length === 2) {\n                // handleTouchMove() will care about pinch zoom.\n                stopPropagation(e);\n                preventDefault(e);\n\n                pinchZoomLength = getPinchZoomLength(e.touches[0], e.touches[1]);\n\n            }\n            // don't care about the rest.\n        };\n\n\n    element.addEventListener('mousedown', handleMouseDown);\n    element.addEventListener('touchstart', handleTouchStart);\n\n    return {\n        onStart : function (callback) {\n            start = callback;\n            return this;\n        },\n\n        onDrag : function (callback) {\n            drag = callback;\n            return this;\n        },\n\n        onStop : function (callback) {\n            end = callback;\n            return this;\n        },\n\n        /**\n         * Occurs when mouse wheel event happens. callback = function(e, scrollDelta, scrollPoint);\n         */\n        onScroll : function (callback) {\n            updateScrollEvents(callback);\n            return this;\n        },\n\n        release : function () {\n            // TODO: could be unsafe. We might wanna release dragObject, etc.\n            element.removeEventListener('mousedown', handleMouseDown);\n            element.removeEventListener('touchstart', handleTouchStart);\n\n            documentEvents.off('mousemove', handleMouseMove);\n            documentEvents.off('mouseup', handleMouseUp);\n            documentEvents.off('touchmove', handleTouchMove);\n            documentEvents.off('touchend', handleTouchEnd);\n            documentEvents.off('touchcancel', handleTouchEnd);\n\n            updateScrollEvents(null);\n        }\n    };\n}\n\n},{\"../Utils/browserInfo.js\":43,\"../Utils/documentEvents.js\":44,\"../Utils/findElementPosition.js\":45}],40:[function(require,module,exports){\n/**\n * @author Andrei Kashcha (aka anvaka) / https://github.com/anvaka\n */\n\nmodule.exports = webglInputManager;\n\nvar createInputEvents = require('../WebGL/webglInputEvents.js');\n\nfunction webglInputManager(graph, graphics) {\n    var inputEvents = createInputEvents(graphics),\n        draggedNode = null,\n        internalHandlers = {},\n        pos = {x : 0, y : 0};\n\n    inputEvents.mouseDown(function (node, e) {\n        draggedNode = node;\n        pos.x = e.clientX;\n        pos.y = e.clientY;\n\n        inputEvents.mouseCapture(draggedNode);\n\n        var handlers = internalHandlers[node.id];\n        if (handlers && handlers.onStart) {\n            handlers.onStart(e, pos);\n        }\n\n        return true;\n    }).mouseUp(function (node) {\n        inputEvents.releaseMouseCapture(draggedNode);\n\n        draggedNode = null;\n        var handlers = internalHandlers[node.id];\n        if (handlers && handlers.onStop) {\n            handlers.onStop();\n        }\n        return true;\n    }).mouseMove(function (node, e) {\n        if (draggedNode) {\n            var handlers = internalHandlers[draggedNode.id];\n            if (handlers && handlers.onDrag) {\n                handlers.onDrag(e, {x : e.clientX - pos.x, y : e.clientY - pos.y });\n            }\n\n            pos.x = e.clientX;\n            pos.y = e.clientY;\n            return true;\n        }\n    });\n\n    return {\n        /**\n         * Called by renderer to listen to drag-n-drop events from node. E.g. for SVG\n         * graphics we may listen to DOM events, whereas for WebGL we graphics\n         * should provide custom eventing mechanism.\n         *\n         * @param node - to be monitored.\n         * @param handlers - object with set of three callbacks:\n         *   onStart: function(),\n         *   onDrag: function(e, offset),\n         *   onStop: function()\n         */\n        bindDragNDrop : function (node, handlers) {\n            internalHandlers[node.id] = handlers;\n            if (!handlers) {\n                delete internalHandlers[node.id];\n            }\n        }\n    };\n}\n\n},{\"../WebGL/webglInputEvents.js\":61}],41:[function(require,module,exports){\nmodule.exports = constant;\n\nvar merge = require('ngraph.merge');\nvar random = require('ngraph.random').random;\nvar Rect = require('../Utils/rect.js');\n\n/**\n * Does not really perform any layouting algorithm but is compliant\n * with renderer interface. Allowing clients to provide specific positioning\n * callback and get static layout of the graph\n *\n * @param {Viva.Graph.graph} graph to layout\n * @param {Object} userSettings\n */\nfunction constant(graph, userSettings) {\n    userSettings = merge(userSettings, {\n        maxX : 1024,\n        maxY : 1024,\n        seed : 'Deterministic randomness made me do this'\n    });\n    // This class simply follows API, it does not use some of the arguments:\n    /*jshint unused: false */\n    var rand = random(userSettings.seed),\n        graphRect = new Rect(Number.MAX_VALUE, Number.MAX_VALUE, Number.MIN_VALUE, Number.MIN_VALUE),\n        layoutLinks = {},\n\n        placeNodeCallback = function (node) {\n            return {\n              x: rand.next(userSettings.maxX),\n              y: rand.next(userSettings.maxY)\n            };\n        },\n\n        updateGraphRect = function (position, graphRect) {\n            if (position.x < graphRect.x1) { graphRect.x1 = position.x; }\n            if (position.x > graphRect.x2) { graphRect.x2 = position.x; }\n            if (position.y < graphRect.y1) { graphRect.y1 = position.y; }\n            if (position.y > graphRect.y2) { graphRect.y2 = position.y; }\n        },\n\n        layoutNodes = typeof Object.create === 'function' ? Object.create(null) : {},\n\n        ensureNodeInitialized = function (node) {\n            layoutNodes[node.id] = placeNodeCallback(node);\n            updateGraphRect(layoutNodes[node.id], graphRect);\n        },\n\n        updateNodePositions = function () {\n            if (graph.getNodesCount() === 0) { return; }\n\n            graphRect.x1 = Number.MAX_VALUE;\n            graphRect.y1 = Number.MAX_VALUE;\n            graphRect.x2 = Number.MIN_VALUE;\n            graphRect.y2 = Number.MIN_VALUE;\n\n            graph.forEachNode(ensureNodeInitialized);\n        },\n\n        ensureLinkInitialized = function (link) {\n          layoutLinks[link.id] = link;\n        },\n\n        onGraphChanged = function(changes) {\n            for (var i = 0; i < changes.length; ++i) {\n                var change = changes[i];\n                if (change.node) {\n                    if (change.changeType === 'add') {\n                        ensureNodeInitialized(change.node);\n                    } else {\n                        delete layoutNodes[change.node.id];\n                    }\n                } if (change.link) {\n                    if (change.changeType === 'add') {\n                        ensureLinkInitialized(change.link);\n                    } else {\n                        delete layoutLinks[change.link.id];\n                    }\n                }\n            }\n        };\n\n    graph.forEachNode(ensureNodeInitialized);\n    graph.forEachLink(ensureLinkInitialized);\n    graph.on('changed', onGraphChanged);\n\n    return {\n        /**\n         * Attempts to layout graph within given number of iterations.\n         *\n         * @param {integer} [iterationsCount] number of algorithm's iterations.\n         *  The constant layout ignores this parameter.\n         */\n        run : function (iterationsCount) {\n            this.step();\n        },\n\n        /**\n         * One step of layout algorithm.\n         */\n        step : function () {\n            updateNodePositions();\n\n            return true; // no need to continue.\n        },\n\n        /**\n         * Returns rectangle structure {x1, y1, x2, y2}, which represents\n         * current space occupied by graph.\n         */\n        getGraphRect : function () {\n            return graphRect;\n        },\n\n        /**\n         * Request to release all resources\n         */\n        dispose : function () {\n            graph.off('change', onGraphChanged);\n        },\n\n        /*\n         * Checks whether given node is pinned; all nodes in this layout are pinned.\n         */\n        isNodePinned: function (node) {\n            return true;\n        },\n\n        /*\n         * Requests layout algorithm to pin/unpin node to its current position\n         * Pinned nodes should not be affected by layout algorithm and always\n         * remain at their position\n         */\n        pinNode: function (node, isPinned) {\n           // noop\n        },\n\n        /*\n         * Gets position of a node by its id. If node was not seen by this\n         * layout algorithm undefined value is returned;\n         */\n        getNodePosition: getNodePosition,\n\n        /**\n         * Returns {from, to} position of a link.\n         */\n        getLinkPosition: function (linkId) {\n          var link = layoutLinks[linkId];\n          return {\n              from : getNodePosition(link.fromId),\n              to : getNodePosition(link.toId)\n          };\n        },\n\n        /**\n         * Sets position of a node to a given coordinates\n         */\n        setNodePosition: function (nodeId, x, y) {\n            var pos = layoutNodes[nodeId];\n            if (pos) {\n                pos.x = x;\n                pos.y = y;\n            }\n        },\n\n        // Layout specific methods:\n\n        /**\n         * Based on argument either update default node placement callback or\n         * attempts to place given node using current placement callback.\n         * Setting new node callback triggers position update for all nodes.\n         *\n         * @param {Object} newPlaceNodeCallbackOrNode - if it is a function then\n         * default node placement callback is replaced with new one. Node placement\n         * callback has a form of function (node) {}, and is expected to return an\n         * object with x and y properties set to numbers.\n         *\n         * Otherwise if it's not a function the argument is treated as graph node\n         * and current node placement callback will be used to place it.\n         */\n        placeNode : function (newPlaceNodeCallbackOrNode) {\n            if (typeof newPlaceNodeCallbackOrNode === 'function') {\n                placeNodeCallback = newPlaceNodeCallbackOrNode;\n                updateNodePositions();\n                return this;\n            }\n\n            // it is not a request to update placeNodeCallback, trying to place\n            // a node using current callback:\n            return placeNodeCallback(newPlaceNodeCallbackOrNode);\n        }\n\n    };\n\n    function getNodePosition(nodeId) {\n        return layoutNodes[nodeId];\n    }\n}\n\n},{\"../Utils/rect.js\":49,\"ngraph.merge\":17,\"ngraph.random\":30}],42:[function(require,module,exports){\n/**\n * This module provides compatibility layer with 0.6.x library. It will be\n * removed in the next version\n */\n\nvar events = require('ngraph.events');\n\nmodule.exports = backwardCompatibleEvents;\n\nfunction backwardCompatibleEvents(g) {\n  console.log(\"This method is deprecated. Please use Viva.events() instead\");\n\n  if (!g) {\n    return g;\n  }\n\n  var eventsDefined = (g.on !== undefined) ||\n    (g.off !== undefined) ||\n    (g.fire !== undefined);\n\n  if (eventsDefined) {\n    // events already defined, ignore\n    return {\n      extend: function() {\n        return g;\n      },\n      on: g.on,\n      stop: g.off\n    };\n  }\n\n  return {\n    extend: extend,\n    on: g.on,\n    stop: g.off\n  };\n\n  function extend() {\n    var backwardCompatible = events(g);\n    backwardCompatible.addEventListener = backwardCompatible.on;\n    return backwardCompatible;\n  }\n}\n\n},{\"ngraph.events\":9}],43:[function(require,module,exports){\nmodule.exports = browserInfo();\r\n\r\nfunction browserInfo() {\r\n  if (typeof window === \"undefined\" || !window.hasOwnProperty(\"navigator\")) {\r\n    return {\r\n      browser : \"\",\r\n      version : \"0\"\r\n    };\r\n  }\r\n\r\n  var ua = window.navigator.userAgent.toLowerCase(),\r\n  // Useragent RegExp\r\n  rwebkit = /(webkit)[ \\/]([\\w.]+)/,\r\n  ropera = /(opera)(?:.*version)?[ \\/]([\\w.]+)/,\r\n  rmsie = /(msie) ([\\w.]+)/,\r\n  rmozilla = /(mozilla)(?:.*? rv:([\\w.]+))?/,\r\n  match = rwebkit.exec(ua) ||\r\n    ropera.exec(ua) ||\r\n    rmsie.exec(ua) ||\r\n    (ua.indexOf(\"compatible\") < 0 && rmozilla.exec(ua)) ||\r\n    [];\r\n\r\n  return {\r\n    browser: match[1] || \"\",\r\n    version: match[2] || \"0\"\r\n  };\r\n}\r\n\n},{}],44:[function(require,module,exports){\nvar nullEvents = require('./nullEvents.js');\n\nmodule.exports = createDocumentEvents();\n\nfunction createDocumentEvents() {\n  if (typeof document === undefined) {\n    return nullEvents;\n  }\n\n  return {\n    on: on,\n    off: off\n  };\n}\n\nfunction on(eventName, handler) {\n  document.addEventListener(eventName, handler);\n}\n\nfunction off(eventName, handler) {\n  document.removeEventListener(eventName, handler);\n}\n\n},{\"./nullEvents.js\":48}],45:[function(require,module,exports){\n/**\n * Finds the absolute position of an element on a page\n */\nmodule.exports = findElementPosition;\n\nfunction findElementPosition(obj) {\n    var curleft = 0,\n        curtop = 0;\n    if (obj.offsetParent) {\n        do {\n            curleft += obj.offsetLeft;\n            curtop += obj.offsetTop;\n        } while ((obj = obj.offsetParent) !== null);\n    }\n\n    return [curleft, curtop];\n}\n\n},{}],46:[function(require,module,exports){\nmodule.exports = getDimension;\r\n\r\nfunction getDimension(container) {\r\n    if (!container) {\r\n        throw {\r\n            message : 'Cannot get dimensions of undefined container'\r\n        };\r\n    }\r\n\r\n    // TODO: Potential cross browser bug.\r\n    var width = container.clientWidth;\r\n    var height = container.clientHeight;\r\n\r\n    return {\r\n        left : 0,\r\n        top : 0,\r\n        width : width,\r\n        height : height\r\n    };\r\n}\r\n\n},{}],47:[function(require,module,exports){\nvar intersect = require('gintersect');\n\nmodule.exports = intersectRect;\n\nfunction intersectRect(left, top, right, bottom, x1, y1, x2, y2) {\n  return intersect(left, top, left, bottom, x1, y1, x2, y2) ||\n    intersect(left, bottom, right, bottom, x1, y1, x2, y2) ||\n    intersect(right, bottom, right, top, x1, y1, x2, y2) ||\n    intersect(right, top, left, top, x1, y1, x2, y2);\n}\n\n},{\"gintersect\":3}],48:[function(require,module,exports){\nmodule.exports = createNullEvents();\n\nfunction createNullEvents() {\n  return {\n    on: noop,\n    off: noop,\n    stop: noop\n  };\n}\n\nfunction noop() { }\n\n},{}],49:[function(require,module,exports){\nmodule.exports = Rect;\n\n/**\n * Very generic rectangle.\n */\nfunction Rect (x1, y1, x2, y2) {\n    this.x1 = x1 || 0;\n    this.y1 = y1 || 0;\n    this.x2 = x2 || 0;\n    this.y2 = y2 || 0;\n}\n\n},{}],50:[function(require,module,exports){\n(function (global){\n/**\r\n * @author Andrei Kashcha (aka anvaka) / https://github.com/anvaka\r\n */\r\n\r\nmodule.exports = createTimer();\r\n\r\nfunction createTimer() {\r\n  var lastTime = 0,\r\n    vendors = ['ms', 'moz', 'webkit', 'o'],\r\n    i,\r\n    scope;\r\n\r\n  if (typeof window !== 'undefined') {\r\n    scope = window;\r\n  } else if (typeof global !== 'undefined') {\r\n    scope = global;\r\n  } else {\r\n    scope = {\r\n      setTimeout: noop,\r\n      clearTimeout: noop\r\n    };\r\n  }\r\n\r\n  for (i = 0; i < vendors.length && !scope.requestAnimationFrame; ++i) {\r\n    var vendorPrefix = vendors[i];\r\n    scope.requestAnimationFrame = scope[vendorPrefix + 'RequestAnimationFrame'];\r\n    scope.cancelAnimationFrame =\r\n      scope[vendorPrefix + 'CancelAnimationFrame'] || scope[vendorPrefix + 'CancelRequestAnimationFrame'];\r\n  }\r\n\r\n  if (!scope.requestAnimationFrame) {\r\n    scope.requestAnimationFrame = rafPolyfill;\r\n  }\r\n\r\n  if (!scope.cancelAnimationFrame) {\r\n    scope.cancelAnimationFrame = cancelRafPolyfill;\r\n  }\r\n\r\n  return timer;\r\n\r\n  /**\r\n   * Timer that fires callback with given interval (in ms) until\r\n   * callback returns true;\r\n   */\r\n  function timer(callback) {\r\n    var intervalId;\r\n    startTimer(); // start it right away.\r\n\r\n    return {\r\n      /**\r\n       * Stops execution of the callback\r\n       */\r\n      stop: stopTimer,\r\n\r\n      restart: restart\r\n    };\r\n\r\n    function startTimer() {\r\n      intervalId = scope.requestAnimationFrame(startTimer);\r\n      if (!callback()) {\r\n        stopTimer();\r\n      }\r\n    }\r\n\r\n    function stopTimer() {\r\n      scope.cancelAnimationFrame(intervalId);\r\n      intervalId = 0;\r\n    }\r\n\r\n    function restart() {\r\n      if (!intervalId) {\r\n        startTimer();\r\n      }\r\n    }\r\n  }\r\n\r\n  function rafPolyfill(callback) {\r\n    var currTime = new Date().getTime();\r\n    var timeToCall = Math.max(0, 16 - (currTime - lastTime));\r\n    var id = scope.setTimeout(function() {\r\n      callback(currTime + timeToCall);\r\n    }, timeToCall);\r\n    lastTime = currTime + timeToCall;\r\n    return id;\r\n  }\r\n\r\n  function cancelRafPolyfill(id) {\r\n    scope.clearTimeout(id);\r\n  }\r\n}\r\n\r\nfunction noop() {}\r\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{}],51:[function(require,module,exports){\nvar nullEvents = require('./nullEvents.js');\n\nmodule.exports = createDocumentEvents();\n\nfunction createDocumentEvents() {\n  if (typeof window === 'undefined') {\n    return nullEvents;\n  }\n\n  return {\n    on: on,\n    off: off\n  };\n}\n\nfunction on(eventName, handler) {\n  window.addEventListener(eventName, handler);\n}\n\nfunction off(eventName, handler) {\n  window.removeEventListener(eventName, handler);\n}\n\n\n},{\"./nullEvents.js\":48}],52:[function(require,module,exports){\n/**\r\n * @fileOverview Defines a graph renderer that uses CSS based drawings.\r\n *\r\n * @author Andrei Kashcha (aka anvaka) / https://github.com/anvaka\r\n */\r\n\r\nmodule.exports = renderer;\r\n\r\nvar eventify = require('ngraph.events');\r\nvar forceDirected = require('ngraph.forcelayout');\r\nvar svgGraphics = require('./svgGraphics.js');\r\nvar windowEvents = require('../Utils/windowEvents.js');\r\nvar domInputManager = require('../Input/domInputManager.js');\r\nvar timer = require('../Utils/timer.js');\r\nvar getDimension = require('../Utils/getDimensions.js');\r\nvar dragndrop = require('../Input/dragndrop.js');\r\n\r\n/**\r\n * This is heart of the rendering. Class accepts graph to be rendered and rendering settings.\r\n * It monitors graph changes and depicts them accordingly.\r\n *\r\n * @param graph - Viva.Graph.graph() object to be rendered.\r\n * @param settings - rendering settings, composed from the following parts (with their defaults shown):\r\n *   settings = {\r\n *     // Represents a module that is capable of displaying graph nodes and links.\r\n *     // all graphics has to correspond to defined interface and can be later easily\r\n *     // replaced for specific needs (e.g. adding WebGL should be piece of cake as long\r\n *     // as WebGL has implemented required interface). See svgGraphics for example.\r\n *     graphics : Viva.Graph.View.svgGraphics(),\r\n *\r\n *     // Where the renderer should draw graph. Container size matters, because\r\n *     // renderer will attempt center graph to that size. Also graphics modules\r\n *     // might depend on it.\r\n *     container : document.body,\r\n *\r\n *     // Defines whether graph can respond to use input\r\n *     interactive: true,\r\n *\r\n *     // Layout algorithm to be used. The algorithm is expected to comply with defined\r\n *     // interface and is expected to be iterative. Renderer will use it then to calculate\r\n *     // graph's layout. For examples of the interface refer to Viva.Graph.Layout.forceDirected()\r\n *     layout : Viva.Graph.Layout.forceDirected(),\r\n *\r\n *     // Directs renderer to display links. Usually rendering links is the slowest part of this\r\n *     // library. So if you don't need to display links, consider settings this property to false.\r\n *     renderLinks : true,\r\n *\r\n *     // Number of layout iterations to run before displaying the graph. The bigger you set this number\r\n *     // the closer to ideal position graph will appear first time. But be careful: for large graphs\r\n *     // it can freeze the browser.\r\n *     prerender : 0\r\n *   }\r\n */\r\nfunction renderer(graph, settings) {\r\n  // TODO: This class is getting hard to understand. Consider refactoring.\r\n  // TODO: I have a technical debt here: fix scaling/recentering! Currently it's a total mess.\r\n  var FRAME_INTERVAL = 30;\r\n\r\n  settings = settings || {};\r\n\r\n  var layout = settings.layout,\r\n    graphics = settings.graphics,\r\n    container = settings.container,\r\n    interactive = settings.interactive !== undefined ? settings.interactive : true,\r\n    inputManager,\r\n    animationTimer,\r\n    rendererInitialized = false,\r\n    updateCenterRequired = true,\r\n\r\n    isStable = false,\r\n    userInteraction = false,\r\n    isPaused = false,\r\n\r\n    transform = {\r\n      offsetX: 0,\r\n      offsetY: 0,\r\n      scale: 1\r\n    },\r\n\r\n    publicEvents = eventify({}),\r\n    containerDrag;\r\n\r\n  return {\r\n    /**\r\n     * Performs rendering of the graph.\r\n     *\r\n     * @param iterationsCount if specified renderer will run only given number of iterations\r\n     * and then stop. Otherwise graph rendering is performed indefinitely.\r\n     *\r\n     * Note: if rendering stopped by used started dragging nodes or new nodes were added to the\r\n     * graph renderer will give run more iterations to reflect changes.\r\n     */\r\n    run: function(iterationsCount) {\r\n\r\n      if (!rendererInitialized) {\r\n        prepareSettings();\r\n        prerender();\r\n\r\n        initDom();\r\n        updateCenter();\r\n        listenToEvents();\r\n\r\n        rendererInitialized = true;\r\n      }\r\n\r\n      renderIterations(iterationsCount);\r\n\r\n      return this;\r\n    },\r\n\r\n    reset: function() {\r\n      graphics.resetScale();\r\n      updateCenter();\r\n      transform.scale = 1;\r\n    },\r\n\r\n    pause: function() {\r\n      isPaused = true;\r\n      animationTimer.stop();\r\n    },\r\n\r\n    resume: function() {\r\n      isPaused = false;\r\n      animationTimer.restart();\r\n    },\r\n\r\n    rerender: function() {\r\n      renderGraph();\r\n      return this;\r\n    },\r\n\r\n    zoomOut: function() {\r\n      return scale(true);\r\n    },\r\n\r\n    zoomIn: function() {\r\n      return scale(false);\r\n    },\r\n\r\n    /**\r\n     * Returns current transformation matrix.\r\n     */\r\n    getTransform: function() {\r\n      return transform;\r\n    },\r\n\r\n    /**\r\n     * Centers renderer at x,y graph's coordinates\r\n     */\r\n    moveTo: function(x, y) {\r\n      graphics.graphCenterChanged(transform.offsetX - x * transform.scale, transform.offsetY - y * transform.scale);\r\n      renderGraph();\r\n    },\r\n\r\n    /**\r\n     * Gets current graphics object\r\n     */\r\n    getGraphics: function() {\r\n      return graphics;\r\n    },\r\n    \r\n    /**\r\n     * Gets current layout.\r\n     */\r\n    getLayout: function() {\r\n      return layout;\r\n    },\r\n\r\n    /**\r\n     * Removes this renderer and deallocates all resources/timers\r\n     */\r\n    dispose: function() {\r\n      stopListenToEvents(); // I quit!\r\n    },\r\n\r\n    on: function(eventName, callback) {\r\n      publicEvents.on(eventName, callback);\r\n      return this;\r\n    },\r\n\r\n    off: function(eventName, callback) {\r\n      publicEvents.off(eventName, callback);\r\n      return this;\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Checks whether given interaction (node/scroll) is enabled\r\n   */\r\n  function isInteractive(interactionName) {\r\n    if (typeof interactive === 'string') {\r\n      return interactive.indexOf(interactionName) >= 0;\r\n    } else if (typeof interactive === 'boolean') {\r\n      return interactive;\r\n    }\r\n    return true; // default setting\r\n  }\r\n\r\n  function prepareSettings() {\r\n    container = container || window.document.body;\r\n    layout = layout || forceDirected(graph, {\r\n      springLength: 80,\r\n      springCoeff: 0.0002,\r\n    });\r\n    graphics = graphics || svgGraphics(graph, {\r\n      container: container\r\n    });\r\n\r\n    if (!settings.hasOwnProperty('renderLinks')) {\r\n      settings.renderLinks = true;\r\n    }\r\n\r\n    settings.prerender = settings.prerender || 0;\r\n    inputManager = (graphics.inputManager || domInputManager)(graph, graphics);\r\n  }\r\n\r\n  function renderGraph() {\r\n    graphics.beginRender();\r\n\r\n    // todo: move this check graphics\r\n    if (settings.renderLinks) {\r\n      graphics.renderLinks();\r\n    }\r\n    graphics.renderNodes();\r\n    graphics.endRender();\r\n  }\r\n\r\n  function onRenderFrame() {\r\n    isStable = layout.step() && !userInteraction;\r\n    renderGraph();\r\n\r\n    return !isStable;\r\n  }\r\n\r\n  function renderIterations(iterationsCount) {\r\n    if (animationTimer) {\r\n      return;\r\n    }\r\n\r\n    if (iterationsCount !== undefined) {\r\n      animationTimer = timer(function() {\r\n        iterationsCount -= 1;\r\n        if (iterationsCount < 0) {\r\n          var needMoreFrames = false;\r\n          return needMoreFrames;\r\n        }\r\n\r\n        return onRenderFrame();\r\n      }, FRAME_INTERVAL);\r\n    } else {\r\n      animationTimer = timer(onRenderFrame, FRAME_INTERVAL);\r\n    }\r\n  }\r\n\r\n  function resetStable() {\r\n    if (isPaused) {\r\n      return;\r\n    }\r\n\r\n    isStable = false;\r\n    animationTimer.restart();\r\n  }\r\n\r\n  function prerender() {\r\n    // To get good initial positions for the graph\r\n    // perform several prerender steps in background.\r\n    if (typeof settings.prerender === 'number' && settings.prerender > 0) {\r\n      for (var i = 0; i < settings.prerender; i += 1) {\r\n        layout.step();\r\n      }\r\n    }\r\n  }\r\n\r\n  function updateCenter() {\r\n    var graphRect = layout.getGraphRect(),\r\n      containerSize = getDimension(container);\r\n\r\n    var cx = (graphRect.x2 + graphRect.x1) / 2;\r\n    var cy = (graphRect.y2 + graphRect.y1) / 2;\r\n    transform.offsetX = containerSize.width / 2 - (cx * transform.scale - cx);\r\n    transform.offsetY = containerSize.height / 2 - (cy * transform.scale - cy);\r\n    graphics.graphCenterChanged(transform.offsetX, transform.offsetY);\r\n\r\n    updateCenterRequired = false;\r\n  }\r\n\r\n  function createNodeUi(node) {\r\n    var nodePosition = layout.getNodePosition(node.id);\r\n    graphics.addNode(node, nodePosition);\r\n  }\r\n\r\n  function removeNodeUi(node) {\r\n    graphics.releaseNode(node);\r\n  }\r\n\r\n  function createLinkUi(link) {\r\n    var linkPosition = layout.getLinkPosition(link.id);\r\n    graphics.addLink(link, linkPosition);\r\n  }\r\n\r\n  function removeLinkUi(link) {\r\n    graphics.releaseLink(link);\r\n  }\r\n\r\n  function listenNodeEvents(node) {\r\n    if (!isInteractive('node')) {\r\n      return;\r\n    }\r\n\r\n    var wasPinned = false;\r\n\r\n    // TODO: This may not be memory efficient. Consider reusing handlers object.\r\n    inputManager.bindDragNDrop(node, {\r\n      onStart: function() {\r\n        wasPinned = layout.isNodePinned(node);\r\n        layout.pinNode(node, true);\r\n        userInteraction = true;\r\n        resetStable();\r\n      },\r\n      onDrag: function(e, offset) {\r\n        var oldPos = layout.getNodePosition(node.id);\r\n        layout.setNodePosition(node.id,\r\n          oldPos.x + offset.x / transform.scale,\r\n          oldPos.y + offset.y / transform.scale);\r\n\r\n        userInteraction = true;\r\n\r\n        renderGraph();\r\n      },\r\n      onStop: function() {\r\n        layout.pinNode(node, wasPinned);\r\n        userInteraction = false;\r\n      }\r\n    });\r\n  }\r\n\r\n  function releaseNodeEvents(node) {\r\n    inputManager.bindDragNDrop(node, null);\r\n  }\r\n\r\n  function initDom() {\r\n    graphics.init(container);\r\n\r\n    graph.forEachNode(createNodeUi);\r\n\r\n    if (settings.renderLinks) {\r\n      graph.forEachLink(createLinkUi);\r\n    }\r\n  }\r\n\r\n  function releaseDom() {\r\n    graphics.release(container);\r\n  }\r\n\r\n  function processNodeChange(change) {\r\n    var node = change.node;\r\n\r\n    if (change.changeType === 'add') {\r\n      createNodeUi(node);\r\n      listenNodeEvents(node);\r\n      if (updateCenterRequired) {\r\n        updateCenter();\r\n      }\r\n    } else if (change.changeType === 'remove') {\r\n      releaseNodeEvents(node);\r\n      removeNodeUi(node);\r\n      if (graph.getNodesCount() === 0) {\r\n        updateCenterRequired = true; // Next time when node is added - center the graph.\r\n      }\r\n    } else if (change.changeType === 'update') {\r\n      releaseNodeEvents(node);\r\n      removeNodeUi(node);\r\n\r\n      createNodeUi(node);\r\n      listenNodeEvents(node);\r\n    }\r\n  }\r\n\r\n  function processLinkChange(change) {\r\n    var link = change.link;\r\n    if (change.changeType === 'add') {\r\n      if (settings.renderLinks) {\r\n        createLinkUi(link);\r\n      }\r\n    } else if (change.changeType === 'remove') {\r\n      if (settings.renderLinks) {\r\n        removeLinkUi(link);\r\n      }\r\n    } else if (change.changeType === 'update') {\r\n      throw 'Update type is not implemented. TODO: Implement me!';\r\n    }\r\n  }\r\n\r\n  function onGraphChanged(changes) {\r\n    var i, change;\r\n    for (i = 0; i < changes.length; i += 1) {\r\n      change = changes[i];\r\n      if (change.node) {\r\n        processNodeChange(change);\r\n      } else if (change.link) {\r\n        processLinkChange(change);\r\n      }\r\n    }\r\n\r\n    resetStable();\r\n  }\r\n\r\n  function onWindowResized() {\r\n    updateCenter();\r\n    onRenderFrame();\r\n  }\r\n\r\n  function releaseContainerDragManager() {\r\n    if (containerDrag) {\r\n      containerDrag.release();\r\n      containerDrag = null;\r\n    }\r\n  }\r\n\r\n  function releaseGraphEvents() {\r\n    graph.off('changed', onGraphChanged);\r\n  }\r\n\r\n  function scale(out, scrollPoint) {\r\n    if (!scrollPoint) {\r\n      var containerSize = getDimension(container);\r\n      scrollPoint = {\r\n        x: containerSize.width / 2,\r\n        y: containerSize.height / 2\r\n      };\r\n    }\r\n    var scaleFactor = Math.pow(1 + 0.4, out ? -0.2 : 0.2);\r\n    transform.scale = graphics.scale(scaleFactor, scrollPoint);\r\n\r\n    renderGraph();\r\n    publicEvents.fire('scale', transform.scale);\r\n\r\n    return transform.scale;\r\n  }\r\n\r\n  function listenToEvents() {\r\n    windowEvents.on('resize', onWindowResized);\r\n\r\n    releaseContainerDragManager();\r\n    if (isInteractive('drag')) {\r\n      containerDrag = dragndrop(container);\r\n      containerDrag.onDrag(function(e, offset) {\r\n        graphics.translateRel(offset.x, offset.y);\r\n\r\n        renderGraph();\r\n        publicEvents.fire('drag', offset);\r\n      });\r\n    }\r\n\r\n    if (isInteractive('scroll')) {\r\n      if (!containerDrag) {\r\n        containerDrag = dragndrop(container);\r\n      }\r\n      containerDrag.onScroll(function(e, scaleOffset, scrollPoint) {\r\n        scale(scaleOffset < 0, scrollPoint);\r\n      });\r\n    }\r\n\r\n    graph.forEachNode(listenNodeEvents);\r\n\r\n    releaseGraphEvents();\r\n    graph.on('changed', onGraphChanged);\r\n  }\r\n\r\n  function stopListenToEvents() {\r\n    rendererInitialized = false;\r\n    releaseGraphEvents();\r\n    releaseContainerDragManager();\r\n    windowEvents.off('resize', onWindowResized);\r\n    publicEvents.off();\r\n    animationTimer.stop();\r\n\r\n    graph.forEachLink(function(link) {\r\n      if (settings.renderLinks) {\r\n        removeLinkUi(link);\r\n      }\r\n    });\r\n\r\n    graph.forEachNode(function(node) {\r\n      releaseNodeEvents(node);\r\n      removeNodeUi(node);\r\n    });\r\n\r\n    layout.dispose();\r\n    releaseDom();\r\n  }\r\n}\r\n\n},{\"../Input/domInputManager.js\":38,\"../Input/dragndrop.js\":39,\"../Utils/getDimensions.js\":46,\"../Utils/timer.js\":50,\"../Utils/windowEvents.js\":51,\"./svgGraphics.js\":53,\"ngraph.events\":9,\"ngraph.forcelayout\":11}],53:[function(require,module,exports){\n/**\r\n * @fileOverview Defines a graph renderer that uses SVG based drawings.\r\n *\r\n * @author Andrei Kashcha (aka anvaka) / https://github.com/anvaka\r\n */\r\n\r\nmodule.exports = svgGraphics;\r\n\r\nvar svg = require('simplesvg');\r\nvar eventify = require('ngraph.events');\r\nvar domInputManager = require('../Input/domInputManager.js');\r\n\r\n/**\r\n * Performs svg-based graph rendering. This module does not perform\r\n * layout, but only visualizes nodes and edges of the graph.\r\n */\r\nfunction svgGraphics() {\r\n    var svgContainer,\r\n        svgRoot,\r\n        offsetX = 0,\r\n        offsetY = 0,\r\n        initCallback,\r\n        actualScale = 1,\r\n        allNodes = {},\r\n        allLinks = {},\r\n/*jshint unused: false */\r\n        nodeBuilder = function (node) {\r\n            return svg(\"rect\")\r\n                     .attr(\"width\", 10)\r\n                     .attr(\"height\", 10)\r\n                     .attr(\"fill\", \"#00a2e8\");\r\n        },\r\n\r\n        nodePositionCallback = function (nodeUI, pos) {\r\n            // TODO: Remove magic 5. It should be half of the width or height of the node.\r\n            nodeUI.attr(\"x\", pos.x - 5)\r\n                  .attr(\"y\", pos.y - 5);\r\n        },\r\n\r\n        linkBuilder = function (link) {\r\n            return svg(\"line\").attr(\"stroke\", \"#999\");\r\n        },\r\n\r\n        linkPositionCallback = function (linkUI, fromPos, toPos) {\r\n            linkUI.attr(\"x1\", fromPos.x)\r\n                  .attr(\"y1\", fromPos.y)\r\n                  .attr(\"x2\", toPos.x)\r\n                  .attr(\"y2\", toPos.y);\r\n        },\r\n\r\n        fireRescaled = function (graphics) {\r\n            // TODO: maybe we shall copy changes?\r\n            graphics.fire(\"rescaled\");\r\n        },\r\n\r\n        cachedPos = {x : 0, y: 0},\r\n        cachedFromPos = {x : 0, y: 0},\r\n        cachedToPos = {x : 0, y: 0},\r\n\r\n        updateTransform = function () {\r\n            if (svgContainer) {\r\n                var transform = \"matrix(\" + actualScale + \", 0, 0,\" + actualScale + \",\" + offsetX + \",\" + offsetY + \")\";\r\n                svgContainer.attr(\"transform\", transform);\r\n            }\r\n        };\r\n\r\n    svgRoot = createSvgRoot();\r\n\r\n    var graphics = {\r\n        getNodeUI: function (nodeId) {\r\n            return allNodes[nodeId];\r\n        },\r\n\r\n        getLinkUI: function (linkId) {\r\n            return allLinks[linkId];\r\n        },\r\n\r\n        /**\r\n         * Sets the callback that creates node representation.\r\n         *\r\n         * @param builderCallback a callback function that accepts graph node\r\n         * as a parameter and must return an element representing this node.\r\n         *\r\n         * @returns If builderCallbackOrNode is a valid callback function, instance of this is returned;\r\n         * Otherwise undefined value is returned\r\n         */\r\n        node : function (builderCallback) {\r\n            if (typeof builderCallback !== \"function\") {\r\n                return; // todo: throw? This is not compatible with old versions\r\n            }\r\n\r\n            nodeBuilder = builderCallback;\r\n\r\n            return this;\r\n        },\r\n\r\n        /**\r\n         * Sets the callback that creates link representation\r\n         *\r\n         * @param builderCallback a callback function that accepts graph link\r\n         * as a parameter and must return an element representing this link.\r\n         *\r\n         * @returns If builderCallback is a valid callback function, instance of this is returned;\r\n         * Otherwise undefined value is returned.\r\n         */\r\n        link : function (builderCallback) {\r\n            if (typeof builderCallback !== \"function\") {\r\n                return; // todo: throw? This is not compatible with old versions\r\n            }\r\n\r\n            linkBuilder = builderCallback;\r\n            return this;\r\n        },\r\n\r\n        /**\r\n         * Allows to override default position setter for the node with a new\r\n         * function. newPlaceCallback(nodeUI, position, node) is function which\r\n         * is used by updateNodePosition().\r\n         */\r\n        placeNode : function (newPlaceCallback) {\r\n            nodePositionCallback = newPlaceCallback;\r\n            return this;\r\n        },\r\n\r\n        placeLink : function (newPlaceLinkCallback) {\r\n            linkPositionCallback = newPlaceLinkCallback;\r\n            return this;\r\n        },\r\n\r\n        /**\r\n         * Called every before renderer starts rendering.\r\n         */\r\n        beginRender : function () {},\r\n\r\n        /**\r\n         * Called every time when renderer finishes one step of rendering.\r\n         */\r\n        endRender : function () {},\r\n\r\n        /**\r\n         * Sets translate operation that should be applied to all nodes and links.\r\n         */\r\n        graphCenterChanged : function (x, y) {\r\n            offsetX = x;\r\n            offsetY = y;\r\n            updateTransform();\r\n        },\r\n\r\n        /**\r\n         * Default input manager listens to DOM events to process nodes drag-n-drop\r\n         */\r\n        inputManager : domInputManager,\r\n\r\n        translateRel : function (dx, dy) {\r\n            var p = svgRoot.createSVGPoint(),\r\n                t = svgContainer.getCTM(),\r\n                origin = svgRoot.createSVGPoint().matrixTransform(t.inverse());\r\n\r\n            p.x = dx;\r\n            p.y = dy;\r\n\r\n            p = p.matrixTransform(t.inverse());\r\n            p.x = (p.x - origin.x) * t.a;\r\n            p.y = (p.y - origin.y) * t.d;\r\n\r\n            t.e += p.x;\r\n            t.f += p.y;\r\n\r\n            var transform = \"matrix(\" + t.a + \", 0, 0,\" + t.d + \",\" + t.e + \",\" + t.f + \")\";\r\n            svgContainer.attr(\"transform\", transform);\r\n        },\r\n\r\n        scale : function (scaleFactor, scrollPoint) {\r\n            var p = svgRoot.createSVGPoint();\r\n            p.x = scrollPoint.x;\r\n            p.y = scrollPoint.y;\r\n\r\n            p = p.matrixTransform(svgContainer.getCTM().inverse()); // translate to SVG coordinates\r\n\r\n            // Compute new scale matrix in current mouse position\r\n            var k = svgRoot.createSVGMatrix().translate(p.x, p.y).scale(scaleFactor).translate(-p.x, -p.y),\r\n                t = svgContainer.getCTM().multiply(k);\r\n\r\n            actualScale = t.a;\r\n            offsetX = t.e;\r\n            offsetY = t.f;\r\n            var transform = \"matrix(\" + t.a + \", 0, 0,\" + t.d + \",\" + t.e + \",\" + t.f + \")\";\r\n            svgContainer.attr(\"transform\", transform);\r\n\r\n            fireRescaled(this);\r\n            return actualScale;\r\n        },\r\n\r\n        resetScale : function () {\r\n            actualScale = 1;\r\n            var transform = \"matrix(1, 0, 0, 1, 0, 0)\";\r\n            svgContainer.attr(\"transform\", transform);\r\n            fireRescaled(this);\r\n            return this;\r\n        },\r\n\r\n       /**\r\n        * Called by Viva.Graph.View.renderer to let concrete graphic output\r\n        * provider prepare to render.\r\n        */\r\n        init : function (container) {\r\n            container.appendChild(svgRoot);\r\n            updateTransform();\r\n            // Notify the world if someone waited for update. TODO: should send an event\r\n            if (typeof initCallback === \"function\") {\r\n                initCallback(svgRoot);\r\n            }\r\n        },\r\n\r\n       /**\r\n        * Called by Viva.Graph.View.renderer to let concrete graphic output\r\n        * provider release occupied resources.\r\n        */\r\n        release : function (container) {\r\n            if (svgRoot && container) {\r\n                container.removeChild(svgRoot);\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Called by Viva.Graph.View.renderer to let concrete graphic output\r\n         * provider prepare to render given link of the graph\r\n         *\r\n         * @param link - model of a link\r\n         */\r\n        addLink: function (link, pos) {\r\n            var linkUI = linkBuilder(link);\r\n            if (!linkUI) { return; }\r\n            linkUI.position = pos;\r\n            linkUI.link = link;\r\n            allLinks[link.id] = linkUI;\r\n            if (svgContainer.childElementCount > 0) {\r\n                svgContainer.insertBefore(linkUI, svgContainer.firstChild);\r\n            } else {\r\n                svgContainer.appendChild(linkUI);\r\n            }\r\n            return linkUI;\r\n        },\r\n\r\n       /**\r\n        * Called by Viva.Graph.View.renderer to let concrete graphic output\r\n        * provider remove link from rendering surface.\r\n        *\r\n        * @param linkUI visual representation of the link created by link() execution.\r\n        **/\r\n        releaseLink : function (link) {\r\n            var linkUI = allLinks[link.id];\r\n            if (linkUI) {\r\n                svgContainer.removeChild(linkUI);\r\n                delete allLinks[link.id];\r\n            }\r\n        },\r\n\r\n       /**\r\n        * Called by Viva.Graph.View.renderer to let concrete graphic output\r\n        * provider prepare to render given node of the graph.\r\n        *\r\n        * @param nodeUI visual representation of the node created by node() execution.\r\n        **/\r\n        addNode : function (node, pos) {\r\n            var nodeUI = nodeBuilder(node);\r\n            if (!nodeUI) {\r\n                return;\r\n            }\r\n            nodeUI.position = pos;\r\n            nodeUI.node = node;\r\n            allNodes[node.id] = nodeUI;\r\n\r\n            svgContainer.appendChild(nodeUI);\r\n\r\n            return nodeUI;\r\n        },\r\n\r\n       /**\r\n        * Called by Viva.Graph.View.renderer to let concrete graphic output\r\n        * provider remove node from rendering surface.\r\n        *\r\n        * @param node graph's node\r\n        **/\r\n        releaseNode : function (node) {\r\n            var nodeUI = allNodes[node.id];\r\n            if (nodeUI) {\r\n                svgContainer.removeChild(nodeUI);\r\n                delete allNodes[node.id];\r\n            }\r\n        },\r\n\r\n        renderNodes : function () {\r\n            for (var key in allNodes) {\r\n                if (allNodes.hasOwnProperty(key)) {\r\n                    var nodeUI = allNodes[key];\r\n                    cachedPos.x = nodeUI.position.x;\r\n                    cachedPos.y = nodeUI.position.y;\r\n                    nodePositionCallback(nodeUI, cachedPos, nodeUI.node);\r\n                }\r\n            }\r\n        },\r\n\r\n        renderLinks : function () {\r\n            for (var key in allLinks) {\r\n                if (allLinks.hasOwnProperty(key)) {\r\n                    var linkUI = allLinks[key];\r\n                    cachedFromPos.x = linkUI.position.from.x;\r\n                    cachedFromPos.y = linkUI.position.from.y;\r\n                    cachedToPos.x = linkUI.position.to.x;\r\n                    cachedToPos.y = linkUI.position.to.y;\r\n                    linkPositionCallback(linkUI, cachedFromPos, cachedToPos, linkUI.link);\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Returns root element which hosts graphics.\r\n         */\r\n        getGraphicsRoot : function (callbackWhenReady) {\r\n            // todo: should fire an event, instead of having this context.\r\n            if (typeof callbackWhenReady === \"function\") {\r\n                if (svgRoot) {\r\n                    callbackWhenReady(svgRoot);\r\n                } else {\r\n                    initCallback = callbackWhenReady;\r\n                }\r\n            }\r\n            return svgRoot;\r\n        },\r\n        /**\r\n         * Returns root SVG element.\r\n         *\r\n         * Note: This is internal method specific to this renderer\r\n         */\r\n        getSvgRoot : function () {\r\n            return svgRoot;\r\n        }\r\n    };\r\n\r\n\r\n    // Let graphics fire events before we return it to the caller.\r\n    eventify(graphics);\r\n\r\n    return graphics;\r\n\r\n    function createSvgRoot() {\r\n        var svgRoot = svg(\"svg\");\r\n\r\n        svgContainer = svg(\"g\")\r\n              .attr(\"buffered-rendering\", \"dynamic\");\r\n\r\n        svgRoot.appendChild(svgContainer);\r\n        return svgRoot;\r\n    }\r\n}\r\n\n},{\"../Input/domInputManager.js\":38,\"ngraph.events\":9,\"simplesvg\":32}],54:[function(require,module,exports){\n/**\r\n * @fileOverview Defines a graph renderer that uses WebGL based drawings.\r\n *\r\n * @author Andrei Kashcha (aka anvaka) / https://github.com/anvaka\r\n */\r\n\r\nmodule.exports = webglGraphics;\r\n\r\nvar webglInputManager = require('../Input/webglInputManager.js');\r\nvar webglLinkProgram = require('../WebGL/webglLinkProgram.js');\r\nvar webglNodeProgram = require('../WebGL/webglNodeProgram.js');\r\nvar webglSquare = require('../WebGL/webglSquare.js');\r\nvar webglLine = require('../WebGL/webglLine.js');\r\nvar eventify = require('ngraph.events');\r\nvar merge = require('ngraph.merge');\r\n\r\n/**\r\n * Performs webgl-based graph rendering. This module does not perform\r\n * layout, but only visualizes nodes and edges of the graph.\r\n *\r\n * @param options - to customize graphics  behavior. Currently supported parameter\r\n *  enableBlending - true by default, allows to use transparency in node/links colors.\r\n *  preserveDrawingBuffer - false by default, tells webgl to preserve drawing buffer.\r\n *                    See https://www.khronos.org/registry/webgl/specs/1.0/#5.2\r\n */\r\n\r\nfunction webglGraphics(options) {\r\n    options = merge(options, {\r\n        enableBlending : true,\r\n        preserveDrawingBuffer : false,\r\n        clearColor: false,\r\n        clearColorValue : {\r\n            r : 1,\r\n            g : 1,\r\n            b : 1,\r\n            a : 1\r\n        }\r\n    });\r\n\r\n    var container,\r\n        graphicsRoot,\r\n        gl,\r\n        width,\r\n        height,\r\n        nodesCount = 0,\r\n        linksCount = 0,\r\n        transform = [\r\n            1, 0, 0, 0,\r\n            0, 1, 0, 0,\r\n            0, 0, 1, 0,\r\n            0, 0, 0, 1\r\n        ],\r\n        userPlaceNodeCallback,\r\n        userPlaceLinkCallback,\r\n        nodes = [],\r\n        links = [],\r\n        initCallback,\r\n\r\n        allNodes = {},\r\n        allLinks = {},\r\n        linkProgram = webglLinkProgram(),\r\n        nodeProgram = webglNodeProgram(),\r\n/*jshint unused: false */\r\n        nodeUIBuilder = function (node) {\r\n            return webglSquare(); // Just make a square, using provided gl context (a nodeProgram);\r\n        },\r\n\r\n        linkUIBuilder = function (link) {\r\n            return webglLine(0xb3b3b3ff);\r\n        },\r\n/*jshint unused: true */\r\n        updateTransformUniform = function () {\r\n            linkProgram.updateTransform(transform);\r\n            nodeProgram.updateTransform(transform);\r\n        },\r\n\r\n        resetScaleInternal = function () {\r\n            transform = [1, 0, 0, 0,\r\n                        0, 1, 0, 0,\r\n                        0, 0, 1, 0,\r\n                        0, 0, 0, 1];\r\n        },\r\n\r\n        updateSize = function () {\r\n            if (container && graphicsRoot) {\r\n                width = graphicsRoot.width = Math.max(container.offsetWidth, 1);\r\n                height = graphicsRoot.height = Math.max(container.offsetHeight, 1);\r\n                if (gl) { gl.viewport(0, 0, width, height); }\r\n                if (linkProgram) { linkProgram.updateSize(width / 2, height / 2); }\r\n                if (nodeProgram) { nodeProgram.updateSize(width / 2, height / 2); }\r\n            }\r\n        },\r\n\r\n        fireRescaled = function (graphics) {\r\n            graphics.fire(\"rescaled\");\r\n        };\r\n\r\n    graphicsRoot = window.document.createElement(\"canvas\");\r\n\r\n    var graphics = {\r\n        getLinkUI: function (linkId) {\r\n            return allLinks[linkId];\r\n        },\r\n\r\n        getNodeUI: function (nodeId) {\r\n            return allNodes[nodeId];\r\n        },\r\n\r\n        /**\r\n         * Sets the callback that creates node representation.\r\n         *\r\n         * @param builderCallback a callback function that accepts graph node\r\n         * as a parameter and must return an element representing this node.\r\n         *\r\n         * @returns If builderCallbackOrNode is a valid callback function, instance of this is returned;\r\n         * Otherwise undefined value is returned\r\n         */\r\n        node : function (builderCallback) {\r\n            if (typeof builderCallback !== \"function\") {\r\n                return; // todo: throw? This is not compatible with old versions\r\n            }\r\n\r\n            nodeUIBuilder = builderCallback;\r\n\r\n            return this;\r\n        },\r\n\r\n        /**\r\n         * Sets the callback that creates link representation\r\n         *\r\n         * @param builderCallback a callback function that accepts graph link\r\n         * as a parameter and must return an element representing this link.\r\n         *\r\n         * @returns If builderCallback is a valid callback function, instance of this is returned;\r\n         * Otherwise undefined value is returned.\r\n         */\r\n        link : function (builderCallback) {\r\n            if (typeof builderCallback !== \"function\") {\r\n                return; // todo: throw? This is not compatible with old versions\r\n            }\r\n\r\n            linkUIBuilder = builderCallback;\r\n            return this;\r\n        },\r\n\r\n\r\n        /**\r\n         * Allows to override default position setter for the node with a new\r\n         * function. newPlaceCallback(nodeUI, position) is function which\r\n         * is used by updateNodePosition().\r\n         */\r\n        placeNode : function (newPlaceCallback) {\r\n            userPlaceNodeCallback = newPlaceCallback;\r\n            return this;\r\n        },\r\n\r\n        placeLink : function (newPlaceLinkCallback) {\r\n            userPlaceLinkCallback = newPlaceLinkCallback;\r\n            return this;\r\n        },\r\n\r\n        /**\r\n         * Custom input manager listens to mouse events to process nodes drag-n-drop inside WebGL canvas\r\n         */\r\n        inputManager : webglInputManager,\r\n\r\n        /**\r\n         * Called every time before renderer starts rendering.\r\n         */\r\n        beginRender : function () {\r\n            // this function could be replaced by this.init,\r\n            // based on user options.\r\n        },\r\n\r\n        /**\r\n         * Called every time when renderer finishes one step of rendering.\r\n         */\r\n        endRender : function () {\r\n            if (linksCount > 0) {\r\n                linkProgram.render();\r\n            }\r\n            if (nodesCount > 0) {\r\n                nodeProgram.render();\r\n            }\r\n        },\r\n\r\n        bringLinkToFront : function (linkUI) {\r\n            var frontLinkId = linkProgram.getFrontLinkId(),\r\n                srcLinkId,\r\n                temp;\r\n\r\n            linkProgram.bringToFront(linkUI);\r\n\r\n            if (frontLinkId > linkUI.id) {\r\n                srcLinkId = linkUI.id;\r\n\r\n                temp = links[frontLinkId];\r\n                links[frontLinkId] = links[srcLinkId];\r\n                links[frontLinkId].id = frontLinkId;\r\n                links[srcLinkId] = temp;\r\n                links[srcLinkId].id = srcLinkId;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Sets translate operation that should be applied to all nodes and links.\r\n         */\r\n        graphCenterChanged : function (x, y) {\r\n            transform[12] = (2 * x / width) - 1;\r\n            transform[13] = 1 - (2 * y / height);\r\n            updateTransformUniform();\r\n        },\r\n\r\n        /**\r\n         * Called by Viva.Graph.View.renderer to let concrete graphic output\r\n         * provider prepare to render given link of the graph\r\n         *\r\n         * @param link - model of a link\r\n         */\r\n        addLink: function (link, boundPosition) {\r\n            var uiid = linksCount++,\r\n                ui = linkUIBuilder(link);\r\n            ui.id = uiid;\r\n            ui.pos = boundPosition;\r\n\r\n            linkProgram.createLink(ui);\r\n\r\n            links[uiid] = ui;\r\n            allLinks[link.id] = ui;\r\n            return ui;\r\n        },\r\n\r\n       /**\r\n        * Called by Viva.Graph.View.renderer to let concrete graphic output\r\n        * provider prepare to render given node of the graph.\r\n        *\r\n        * @param nodeUI visual representation of the node created by node() execution.\r\n        **/\r\n        addNode : function (node, boundPosition) {\r\n            var uiid = nodesCount++,\r\n                ui = nodeUIBuilder(node);\r\n\r\n            ui.id = uiid;\r\n            ui.position = boundPosition;\r\n            ui.node = node;\r\n\r\n            nodeProgram.createNode(ui);\r\n\r\n            nodes[uiid] = ui;\r\n            allNodes[node.id] = ui;\r\n            return ui;\r\n        },\r\n\r\n        translateRel : function (dx, dy) {\r\n            transform[12] += (2 * transform[0] * dx / width) / transform[0];\r\n            transform[13] -= (2 * transform[5] * dy / height) / transform[5];\r\n            updateTransformUniform();\r\n        },\r\n\r\n        scale : function (scaleFactor, scrollPoint) {\r\n            // Transform scroll point to clip-space coordinates:\r\n            var cx = 2 * scrollPoint.x / width - 1,\r\n                cy = 1 - (2 * scrollPoint.y) / height;\r\n\r\n            cx -= transform[12];\r\n            cy -= transform[13];\r\n\r\n            transform[12] += cx * (1 - scaleFactor);\r\n            transform[13] += cy * (1 - scaleFactor);\r\n\r\n            transform[0] *= scaleFactor;\r\n            transform[5] *= scaleFactor;\r\n\r\n            updateTransformUniform();\r\n            fireRescaled(this);\r\n\r\n            return transform[0];\r\n        },\r\n\r\n        resetScale : function () {\r\n            resetScaleInternal();\r\n\r\n            if (gl) {\r\n                updateSize();\r\n                // TODO: what is this?\r\n                // gl.useProgram(linksProgram);\r\n                // gl.uniform2f(linksProgram.screenSize, width, height);\r\n                updateTransformUniform();\r\n            }\r\n            return this;\r\n        },\r\n\r\n       /**\r\n        * Resizes the graphic without resetting the scale. \r\n        * Useful with viva graph in a dynamic container\r\n        */\r\n        updateSize: updateSize,\r\n\r\n       /**\r\n        * Called by Viva.Graph.View.renderer to let concrete graphic output\r\n        * provider prepare to render.\r\n        */\r\n        init : function (c) {\r\n            var contextParameters = {};\r\n\r\n            if (options.preserveDrawingBuffer) {\r\n                contextParameters.preserveDrawingBuffer = true;\r\n            }\r\n\r\n            container = c;\r\n\r\n            updateSize();\r\n            resetScaleInternal();\r\n            container.appendChild(graphicsRoot);\r\n\r\n\r\n            gl = graphicsRoot.getContext(\"experimental-webgl\", contextParameters);\r\n            if (!gl) {\r\n                var msg = \"Could not initialize WebGL. Seems like the browser doesn't support it.\";\r\n                window.alert(msg);\r\n                throw msg;\r\n            }\r\n            if (options.enableBlending) {\r\n                gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\r\n                gl.enable(gl.BLEND);\r\n            }\r\n            if (options.clearColor) {\r\n                var color = options.clearColorValue;\r\n                gl.clearColor(color.r, color.g, color.b, color.a);\r\n                // TODO: not the best way, really. Should come up with something better\r\n                // what if we need more updates inside beginRender, like depth buffer?\r\n                this.beginRender = function () {\r\n                    gl.clear(gl.COLOR_BUFFER_BIT);\r\n                };\r\n            }\r\n\r\n            linkProgram.load(gl);\r\n            linkProgram.updateSize(width / 2, height / 2);\r\n\r\n            nodeProgram.load(gl);\r\n            nodeProgram.updateSize(width / 2, height / 2);\r\n\r\n            updateTransformUniform();\r\n\r\n            // Notify the world if someone waited for update. TODO: should send an event\r\n            if (typeof initCallback === \"function\") {\r\n                initCallback(graphicsRoot);\r\n            }\r\n        },\r\n\r\n        /**\r\n        * Called by Viva.Graph.View.renderer to let concrete graphic output\r\n        * provider release occupied resources.\r\n        */\r\n        release : function (container) {\r\n            if (graphicsRoot && container) {\r\n                container.removeChild(graphicsRoot);\r\n                // TODO: anything else?\r\n            }\r\n        },\r\n\r\n       /**\r\n        * Checks whether webgl is supported by this browser.\r\n        */\r\n        isSupported : function () {\r\n            var c = window.document.createElement(\"canvas\"),\r\n                gl = c && c.getContext && c.getContext(\"experimental-webgl\");\r\n            return gl;\r\n        },\r\n\r\n       /**\r\n        * Called by Viva.Graph.View.renderer to let concrete graphic output\r\n        * provider remove link from rendering surface.\r\n        *\r\n        * @param linkUI visual representation of the link created by link() execution.\r\n        **/\r\n        releaseLink : function (link) {\r\n            if (linksCount > 0) { linksCount -= 1; }\r\n            var linkUI = allLinks[link.id];\r\n            delete allLinks[link.id];\r\n\r\n            linkProgram.removeLink(linkUI);\r\n\r\n            var linkIdToRemove = linkUI.id;\r\n            if (linkIdToRemove < linksCount) {\r\n                if (linksCount === 0 || linksCount === linkIdToRemove) {\r\n                    return; // no more links or removed link is the last one.\r\n                }\r\n\r\n                var lastLinkUI = links[linksCount];\r\n                links[linkIdToRemove] = lastLinkUI;\r\n                lastLinkUI.id = linkIdToRemove;\r\n            }\r\n        },\r\n\r\n       /**\r\n        * Called by Viva.Graph.View.renderer to let concrete graphic output\r\n        * provider remove node from rendering surface.\r\n        *\r\n        * @param nodeUI visual representation of the node created by node() execution.\r\n        **/\r\n        releaseNode : function (node) {\r\n            if (nodesCount > 0) { nodesCount -= 1; }\r\n            var nodeUI = allNodes[node.id];\r\n            delete allNodes[node.id];\r\n\r\n            nodeProgram.removeNode(nodeUI);\r\n\r\n            var nodeIdToRemove = nodeUI.id;\r\n            if (nodeIdToRemove < nodesCount) {\r\n                if (nodesCount === 0 || nodesCount === nodeIdToRemove) {\r\n                    return; // no more nodes or removed node is the last in the list.\r\n                }\r\n\r\n                var lastNodeUI = nodes[nodesCount];\r\n\r\n                nodes[nodeIdToRemove] = lastNodeUI;\r\n                lastNodeUI.id = nodeIdToRemove;\r\n\r\n                // Since concrete shaders may cache properties in the UI element\r\n                // we are letting them to make this swap (e.g. image node shader\r\n                // uses this approach to update node's offset in the atlas)\r\n                nodeProgram.replaceProperties(nodeUI, lastNodeUI);\r\n            }\r\n        },\r\n\r\n        renderNodes: function () {\r\n            var pos = {x : 0, y : 0};\r\n            // WebGL coordinate system is different. Would be better\r\n            // to have this transform in the shader code, but it would\r\n            // require every shader to be updated..\r\n            for (var i = 0; i < nodesCount; ++i) {\r\n                var ui = nodes[i];\r\n                pos.x = ui.position.x;\r\n                pos.y = ui.position.y;\r\n                if (userPlaceNodeCallback) {\r\n                    userPlaceNodeCallback(ui, pos);\r\n                }\r\n\r\n                nodeProgram.position(ui, pos);\r\n            }\r\n        },\r\n\r\n        renderLinks: function () {\r\n            if (this.omitLinksRendering) { return; }\r\n\r\n            var toPos = {x : 0, y : 0};\r\n            var fromPos = {x : 0, y : 0};\r\n            for (var i = 0; i < linksCount; ++i) {\r\n                var ui = links[i];\r\n                var pos = ui.pos.from;\r\n                fromPos.x = pos.x;\r\n                fromPos.y = -pos.y;\r\n                pos = ui.pos.to;\r\n                toPos.x = pos.x;\r\n                toPos.y = -pos.y;\r\n                if (userPlaceLinkCallback) {\r\n                    userPlaceLinkCallback(ui, fromPos, toPos);\r\n                }\r\n\r\n                linkProgram.position(ui, fromPos, toPos);\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Returns root element which hosts graphics.\r\n         */\r\n        getGraphicsRoot : function (callbackWhenReady) {\r\n            // todo: should fire an event, instead of having this context.\r\n            if (typeof callbackWhenReady === \"function\") {\r\n                if (graphicsRoot) {\r\n                    callbackWhenReady(graphicsRoot);\r\n                } else {\r\n                    initCallback = callbackWhenReady;\r\n                }\r\n            }\r\n            return graphicsRoot;\r\n        },\r\n\r\n        /**\r\n         * Updates default shader which renders nodes\r\n         *\r\n         * @param newProgram to use for nodes.\r\n         */\r\n        setNodeProgram : function (newProgram) {\r\n            if (!gl && newProgram) {\r\n                // Nothing created yet. Just set shader to the new one\r\n                // and let initialization logic take care about the rest.\r\n                nodeProgram = newProgram;\r\n            } else if (newProgram) {\r\n                throw \"Not implemented. Cannot swap shader on the fly... Yet.\";\r\n                // TODO: unload old shader and reinit.\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Updates default shader which renders links\r\n         *\r\n         * @param newProgram to use for links.\r\n         */\r\n        setLinkProgram : function (newProgram) {\r\n            if (!gl && newProgram) {\r\n                // Nothing created yet. Just set shader to the new one\r\n                // and let initialization logic take care about the rest.\r\n                linkProgram = newProgram;\r\n            } else if (newProgram) {\r\n                throw \"Not implemented. Cannot swap shader on the fly... Yet.\";\r\n                // TODO: unload old shader and reinit.\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Transforms client coordinates into layout coordinates. Client coordinates\r\n         * are DOM coordinates relative to the rendering container. Layout\r\n         * coordinates are those assigned by by layout algorithm to each node.\r\n         *\r\n         * @param {Object} p - a point object with `x` and `y` attributes.\r\n         * This method mutates p.\r\n         */\r\n        transformClientToGraphCoordinates: function (p) {\r\n          // TODO: could be a problem when container has margins?\r\n            // normalize\r\n            p.x = ((2 * p.x) / width) - 1;\r\n            p.y = 1 - ((2 * p.y) / height);\r\n\r\n            // apply transform\r\n            p.x = (p.x - transform[12]) / transform[0];\r\n            p.y = (p.y - transform[13]) / transform[5];\r\n\r\n            // transform to graph coordinates\r\n            p.x = p.x * (width / 2);\r\n            p.y = p.y * (-height / 2);\r\n\r\n            return p;\r\n        },\r\n\r\n        /**\r\n         * Transforms WebGL coordinates into client coordinates. Reverse of \r\n         * `transformClientToGraphCoordinates()`\r\n         *\r\n         * @param {Object} p - a point object with `x` and `y` attributes, which\r\n         * represents a layout coordinate. This method mutates p.\r\n         */\r\n        transformGraphToClientCoordinates: function (p) {\r\n          // TODO: could be a problem when container has margins?\r\n            // transform from graph coordinates\r\n            p.x = p.x / (width / 2);\r\n            p.y = p.y / (-height / 2);\r\n\r\n            // apply transform\r\n            p.x = (p.x * transform[0]) + transform[12];\r\n            p.y = (p.y * transform[5]) + transform[13];\r\n\r\n            // denormalize\r\n            p.x = ((p.x + 1) * width) / 2;\r\n            p.y = ((1 - p.y) * height) / 2;\r\n\r\n            return p;\r\n        },\r\n\r\n        getNodeAtClientPos: function (clientPos, preciseCheck) {\r\n            if (typeof preciseCheck !== \"function\") {\r\n                // we don't know anything about your node structure here :(\r\n                // potentially this could be delegated to node program, but for\r\n                // right now, we are giving up if you don't pass boundary check\r\n                // callback. It answers to a question is nodeUI covers  (x, y)\r\n                return null;\r\n            }\r\n            // first transform to graph coordinates:\r\n            this.transformClientToGraphCoordinates(clientPos);\r\n            // now using precise check iterate over each node and find one within box:\r\n            // TODO: This is poor O(N) performance.\r\n            for (var i = 0; i < nodesCount; ++i) {\r\n                if (preciseCheck(nodes[i], clientPos.x, clientPos.y)) {\r\n                    return nodes[i].node;\r\n                }\r\n            }\r\n            return null;\r\n        }\r\n    };\r\n\r\n    // Let graphics fire events before we return it to the caller.\r\n    eventify(graphics);\r\n\r\n    return graphics;\r\n}\r\n\n},{\"../Input/webglInputManager.js\":40,\"../WebGL/webglLine.js\":62,\"../WebGL/webglLinkProgram.js\":63,\"../WebGL/webglNodeProgram.js\":64,\"../WebGL/webglSquare.js\":65,\"ngraph.events\":9,\"ngraph.merge\":17}],55:[function(require,module,exports){\nmodule.exports = parseColor;\n\nfunction parseColor(color) {\n  var parsedColor = 0x009ee8ff;\n\n  if (typeof color === 'string' && color) {\n    if (color.length === 4) { // #rgb\n      color = color.replace(/([^#])/g, '$1$1'); // duplicate each letter except first #.\n    }\n    if (color.length === 9) { // #rrggbbaa\n      parsedColor = parseInt(color.substr(1), 16);\n    } else if (color.length === 7) { // or #rrggbb.\n      parsedColor = (parseInt(color.substr(1), 16) << 8) | 0xff;\n    } else {\n      throw 'Color expected in hex format with preceding \"#\". E.g. #00ff00. Got value: ' + color;\n    }\n  } else if (typeof color === 'number') {\n    parsedColor = color;\n  }\n\n  return parsedColor;\n}\n\n},{}],56:[function(require,module,exports){\nmodule.exports = Texture;\n\n/**\n * Single texture in the webglAtlas.\n */\nfunction Texture(size) {\n  this.canvas = window.document.createElement(\"canvas\");\n  this.ctx = this.canvas.getContext(\"2d\");\n  this.isDirty = false;\n  this.canvas.width = this.canvas.height = size;\n}\n\n},{}],57:[function(require,module,exports){\n/**\n * @fileOverview Utility functions for webgl rendering.\n *\n * @author Andrei Kashcha (aka anvaka) / https://github.com/anvaka\n */\n\nmodule.exports = webgl;\n\nfunction webgl(gl) {\n\n  return {\n    createProgram: createProgram,\n    extendArray: extendArray,\n    copyArrayPart: copyArrayPart,\n    swapArrayPart: swapArrayPart,\n    getLocations: getLocations,\n    context: gl\n  };\n\n  function createShader(shaderText, type) {\n    var shader = gl.createShader(type);\n    gl.shaderSource(shader, shaderText);\n    gl.compileShader(shader);\n\n    if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n      var msg = gl.getShaderInfoLog(shader);\n      window.alert(msg);\n      throw msg;\n    }\n\n    return shader;\n  }\n\n  function createProgram(vertexShaderSrc, fragmentShaderSrc) {\n    var program = gl.createProgram();\n    var vs = createShader(vertexShaderSrc, gl.VERTEX_SHADER);\n    var fs = createShader(fragmentShaderSrc, gl.FRAGMENT_SHADER);\n\n    gl.attachShader(program, vs);\n    gl.attachShader(program, fs);\n    gl.linkProgram(program);\n\n    if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n      var msg = gl.getShaderInfoLog(program);\n      window.alert(msg);\n      throw msg;\n    }\n\n    return program;\n  }\n\n  function extendArray(buffer, itemsInBuffer, elementsPerItem) {\n    if ((itemsInBuffer + 1) * elementsPerItem > buffer.length) {\n      // Every time we run out of space create new array twice bigger.\n      // TODO: it seems buffer size is limited. Consider using multiple arrays for huge graphs\n      var extendedArray = new Float32Array(buffer.length * elementsPerItem * 2);\n      extendedArray.set(buffer);\n\n      return extendedArray;\n    }\n\n    return buffer;\n  }\n\n  function getLocations(program, uniformOrAttributeNames) {\n    var foundLocations = {};\n    for (var i = 0; i < uniformOrAttributeNames.length; ++i) {\n      var name = uniformOrAttributeNames[i];\n      var location = -1;\n      if (name[0] === 'a' && name[1] === '_') {\n        location = gl.getAttribLocation(program, name);\n        if (location === -1) {\n          throw new Error(\"Program doesn't have required attribute: \" + name);\n        }\n\n        foundLocations[name.slice(2)] = location;\n      } else if (name[0] === 'u' && name[1] === '_') {\n        location = gl.getUniformLocation(program, name);\n        if (location === null) {\n          throw new Error(\"Program doesn't have required uniform: \" + name);\n        }\n\n        foundLocations[name.slice(2)] = location;\n      } else {\n        throw new Error(\"Couldn't figure out your intent. All uniforms should start with 'u_' prefix, and attributes with 'a_'\");\n      }\n    }\n\n    return foundLocations;\n  }\n}\n\nfunction copyArrayPart(array, to, from, elementsCount) {\n  for (var i = 0; i < elementsCount; ++i) {\n    array[to + i] = array[from + i];\n  }\n}\n\nfunction swapArrayPart(array, from, to, elementsCount) {\n  for (var i = 0; i < elementsCount; ++i) {\n    var tmp = array[from + i];\n    array[from + i] = array[to + i];\n    array[to + i] = tmp;\n  }\n}\n\n},{}],58:[function(require,module,exports){\nvar Texture = require('./texture.js');\n\nmodule.exports = webglAtlas;\n\n/**\n * My naive implementation of textures atlas. It allows clients to load\n * multiple images into atlas and get canvas representing all of them.\n *\n * @param tilesPerTexture - indicates how many images can be loaded to one\n *          texture of the atlas. If number of loaded images exceeds this\n *          parameter a new canvas will be created.\n */\nfunction webglAtlas(tilesPerTexture) {\n  var tilesPerRow = Math.sqrt(tilesPerTexture || 1024) << 0,\n    tileSize = tilesPerRow,\n    lastLoadedIdx = 1,\n    loadedImages = {},\n    dirtyTimeoutId,\n    skipedDirty = 0,\n    textures = [],\n    trackedUrls = [];\n\n  if (!isPowerOf2(tilesPerTexture)) {\n    throw \"Tiles per texture should be power of two.\";\n  }\n\n  // this is the return object\n  var api = {\n    /**\n     * indicates whether atlas has changed texture in it. If true then\n     * some of the textures has isDirty flag set as well.\n     */\n    isDirty: false,\n\n    /**\n     * Clears any signs of atlas changes.\n     */\n    clearDirty: clearDirty,\n\n    /**\n     * Removes given url from collection of tiles in the atlas.\n     */\n    remove: remove,\n\n    /**\n     * Gets all textures in the atlas.\n     */\n    getTextures: getTextures,\n\n    /**\n     * Gets coordinates of the given image in the atlas. Coordinates is an object:\n     * {offset : int } - where offset is an absolute position of the image in the\n     * atlas.\n     *\n     * Absolute means it can be larger than tilesPerTexture parameter, and in that\n     * case clients should get next texture in getTextures() collection.\n     */\n    getCoordinates: getCoordinates,\n\n    /**\n     * Asynchronously Loads the image to the atlas. Cross-domain security\n     * limitation applies.\n     */\n    load: load\n  };\n\n  return api;\n\n  function clearDirty() {\n    var i;\n    api.isDirty = false;\n    for (i = 0; i < textures.length; ++i) {\n      textures[i].isDirty = false;\n    }\n  }\n\n  function remove(imgUrl) {\n    var coordinates = loadedImages[imgUrl];\n    if (!coordinates) {\n      return false;\n    }\n    delete loadedImages[imgUrl];\n    lastLoadedIdx -= 1;\n\n\n    if (lastLoadedIdx === coordinates.offset) {\n      return true; // Ignore if it's last image in the whole set.\n    }\n\n    var tileToRemove = getTileCoordinates(coordinates.offset),\n      lastTileInSet = getTileCoordinates(lastLoadedIdx);\n\n    copy(lastTileInSet, tileToRemove);\n\n    var replacedOffset = loadedImages[trackedUrls[lastLoadedIdx]];\n    replacedOffset.offset = coordinates.offset;\n    trackedUrls[coordinates.offset] = trackedUrls[lastLoadedIdx];\n\n    markDirty();\n    return true;\n  }\n\n  function getTextures() {\n    return textures; // I trust you...\n  }\n\n  function getCoordinates(imgUrl) {\n    return loadedImages[imgUrl];\n  }\n\n  function load(imgUrl, callback) {\n    if (loadedImages.hasOwnProperty(imgUrl)) {\n      callback(loadedImages[imgUrl]);\n    } else {\n      var img = new window.Image(),\n        imgId = lastLoadedIdx;\n\n      lastLoadedIdx += 1;\n      img.crossOrigin = \"anonymous\";\n      img.onload = function() {\n        markDirty();\n        drawAt(imgId, img, callback);\n      };\n\n      img.src = imgUrl;\n    }\n  }\n\n  function createTexture() {\n    var texture = new Texture(tilesPerRow * tileSize);\n    textures.push(texture);\n  }\n\n  function drawAt(tileNumber, img, callback) {\n    var tilePosition = getTileCoordinates(tileNumber),\n      coordinates = {\n        offset: tileNumber\n      };\n\n    if (tilePosition.textureNumber >= textures.length) {\n      createTexture();\n    }\n    var currentTexture = textures[tilePosition.textureNumber];\n\n    currentTexture.ctx.drawImage(img, tilePosition.col * tileSize, tilePosition.row * tileSize, tileSize, tileSize);\n    trackedUrls[tileNumber] = img.src;\n\n    loadedImages[img.src] = coordinates;\n    currentTexture.isDirty = true;\n\n    callback(coordinates);\n  }\n\n  function getTileCoordinates(absolutePosition) {\n    var textureNumber = (absolutePosition / tilesPerTexture) << 0,\n      localTileNumber = (absolutePosition % tilesPerTexture),\n      row = (localTileNumber / tilesPerRow) << 0,\n      col = (localTileNumber % tilesPerRow);\n\n    return {\n      textureNumber: textureNumber,\n      row: row,\n      col: col\n    };\n  }\n\n  function markDirtyNow() {\n    api.isDirty = true;\n    skipedDirty = 0;\n    dirtyTimeoutId = null;\n  }\n\n  function markDirty() {\n    // delay this call, since it results in texture reload\n    if (dirtyTimeoutId) {\n      window.clearTimeout(dirtyTimeoutId);\n      skipedDirty += 1;\n      dirtyTimeoutId = null;\n    }\n\n    if (skipedDirty > 10) {\n      markDirtyNow();\n    } else {\n      dirtyTimeoutId = window.setTimeout(markDirtyNow, 400);\n    }\n  }\n\n  function copy(from, to) {\n    var fromCanvas = textures[from.textureNumber].canvas,\n      toCtx = textures[to.textureNumber].ctx,\n      x = to.col * tileSize,\n      y = to.row * tileSize;\n\n    toCtx.drawImage(fromCanvas, from.col * tileSize, from.row * tileSize, tileSize, tileSize, x, y, tileSize, tileSize);\n    textures[from.textureNumber].isDirty = true;\n    textures[to.textureNumber].isDirty = true;\n  }\n}\n\nfunction isPowerOf2(n) {\n  return (n & (n - 1)) === 0;\n}\n\n},{\"./texture.js\":56}],59:[function(require,module,exports){\nmodule.exports = webglImage;\n\n/**\n * Represents a model for image.\n */\nfunction webglImage(size, src) {\n    return {\n        /**\n         * Gets texture index where current image is placed.\n         */\n        _texture : 0,\n\n        /**\n         * Gets offset in the texture where current image is placed.\n         */\n        _offset : 0,\n\n        /**\n         * Gets size of the square with the image.\n         */\n        size : typeof size === 'number' ? size : 32,\n\n        /**\n         * Source of the image. If image is coming not from your domain\n         * certain origin restrictions applies.\n         * See http://www.khronos.org/registry/webgl/specs/latest/#4.2 for more details.\n         */\n        src  : src\n    };\n}\n\n},{}],60:[function(require,module,exports){\n/**\n * @fileOverview Defines an image nodes for webglGraphics class.\n * Shape of nodes is square.\n *\n * @author Andrei Kashcha (aka anvaka) / https://github.com/anvaka\n */\n\nvar WebglAtlas = require('./webglAtlas.js');\nvar glUtils = require('./webgl.js');\n\nmodule.exports = webglImageNodeProgram;\n\n/**\n * Defines simple UI for nodes in webgl renderer. Each node is rendered as an image.\n * \n * @param {number} tilesPerTexture\n * \n */\nfunction webglImageNodeProgram(tilesPerTexture) {\n  // WebGL is gian state machine, we store some properties of the state here:\n  var ATTRIBUTES_PER_PRIMITIVE = 18;\n  var nodesFS = createNodeFragmentShader();\n  var nodesVS = createNodeVertexShader();\n  var tilesPerTexture = tilesPerTexture || 1024; // TODO: Get based on max texture size\n  var atlas;\n  var program;\n  var gl;\n  var buffer;\n  var utils;\n  var locations;\n  var nodesCount = 0;\n  var nodes = new Float32Array(64);\n  var width;\n  var height;\n  var transform;\n  var sizeDirty;\n\n\n  return {\n    load: load,\n\n    /**\n     * Updates position of current node in the buffer of nodes.\n     *\n     * @param idx - index of current node.\n     * @param pos - new position of the node.\n     */\n    position: position,\n\n    createNode: createNode,\n\n    removeNode: removeNode,\n\n    replaceProperties: replaceProperties,\n\n    updateTransform: updateTransform,\n\n    updateSize: updateSize,\n\n    render: render\n  };\n\n  function refreshTexture(texture, idx) {\n    if (texture.nativeObject) {\n      gl.deleteTexture(texture.nativeObject);\n    }\n\n    var nativeObject = gl.createTexture();\n    gl.activeTexture(gl[\"TEXTURE\" + idx]);\n    gl.bindTexture(gl.TEXTURE_2D, nativeObject);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, texture.canvas);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_NEAREST);\n\n    gl.generateMipmap(gl.TEXTURE_2D);\n    gl.uniform1i(locations[\"sampler\" + idx], idx);\n\n    texture.nativeObject = nativeObject;\n  }\n\n  function ensureAtlasTextureUpdated() {\n    if (atlas.isDirty) {\n      var textures = atlas.getTextures(),\n        i;\n      for (i = 0; i < textures.length; ++i) {\n        if (textures[i].isDirty || !textures[i].nativeObject) {\n          refreshTexture(textures[i], i);\n        }\n      }\n\n      atlas.clearDirty();\n    }\n  }\n\n  function load(glContext) {\n    gl = glContext;\n    utils = glUtils(glContext);\n\n    atlas = new WebglAtlas(tilesPerTexture);\n\n    program = utils.createProgram(nodesVS, nodesFS);\n    gl.useProgram(program);\n    locations = utils.getLocations(program, [\"a_vertexPos\", \"a_customAttributes\", \"u_screenSize\", \"u_transform\", \"u_sampler0\", \"u_sampler1\", \"u_sampler2\", \"u_sampler3\", \"u_tilesPerTexture\"]);\n\n    gl.uniform1f(locations.tilesPerTexture, tilesPerTexture);\n\n    gl.enableVertexAttribArray(locations.vertexPos);\n    gl.enableVertexAttribArray(locations.customAttributes);\n\n    buffer = gl.createBuffer();\n  }\n\n  function position(nodeUI, pos) {\n    var idx = nodeUI.id * ATTRIBUTES_PER_PRIMITIVE;\n    nodes[idx] = pos.x - nodeUI.size;\n    nodes[idx + 1] = -pos.y - nodeUI.size;\n    nodes[idx + 2] = nodeUI._offset * 4;\n\n    nodes[idx + 3] = pos.x + nodeUI.size;\n    nodes[idx + 4] = -pos.y - nodeUI.size;\n    nodes[idx + 5] = nodeUI._offset * 4 + 1;\n\n    nodes[idx + 6] = pos.x - nodeUI.size;\n    nodes[idx + 7] = -pos.y + nodeUI.size;\n    nodes[idx + 8] = nodeUI._offset * 4 + 2;\n\n    nodes[idx + 9] = pos.x - nodeUI.size;\n    nodes[idx + 10] = -pos.y + nodeUI.size;\n    nodes[idx + 11] = nodeUI._offset * 4 + 2;\n\n    nodes[idx + 12] = pos.x + nodeUI.size;\n    nodes[idx + 13] = -pos.y - nodeUI.size;\n    nodes[idx + 14] = nodeUI._offset * 4 + 1;\n\n    nodes[idx + 15] = pos.x + nodeUI.size;\n    nodes[idx + 16] = -pos.y + nodeUI.size;\n    nodes[idx + 17] = nodeUI._offset * 4 + 3;\n  }\n\n  function createNode(ui) {\n    nodes = utils.extendArray(nodes, nodesCount, ATTRIBUTES_PER_PRIMITIVE);\n    nodesCount += 1;\n\n    var coordinates = atlas.getCoordinates(ui.src);\n    if (coordinates) {\n      ui._offset = coordinates.offset;\n    } else {\n      ui._offset = 0;\n      // Image is not yet loaded into the atlas. Reload it:\n      atlas.load(ui.src, function(coordinates) {\n        ui._offset = coordinates.offset;\n      });\n    }\n  }\n\n  function removeNode(nodeUI) {\n    if (nodesCount > 0) {\n      nodesCount -= 1;\n    }\n\n    if (nodeUI.id < nodesCount && nodesCount > 0) {\n      if (nodeUI.src) {\n        atlas.remove(nodeUI.src);\n      }\n\n      utils.copyArrayPart(nodes, nodeUI.id * ATTRIBUTES_PER_PRIMITIVE, nodesCount * ATTRIBUTES_PER_PRIMITIVE, ATTRIBUTES_PER_PRIMITIVE);\n    }\n  }\n\n  function replaceProperties(replacedNode, newNode) {\n    newNode._offset = replacedNode._offset;\n  }\n\n  function updateTransform(newTransform) {\n    sizeDirty = true;\n    transform = newTransform;\n  }\n\n  function updateSize(w, h) {\n    width = w;\n    height = h;\n    sizeDirty = true;\n  }\n\n  function render() {\n    gl.useProgram(program);\n    gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n    gl.bufferData(gl.ARRAY_BUFFER, nodes, gl.DYNAMIC_DRAW);\n\n    if (sizeDirty) {\n      sizeDirty = false;\n      gl.uniformMatrix4fv(locations.transform, false, transform);\n      gl.uniform2f(locations.screenSize, width, height);\n    }\n\n    gl.vertexAttribPointer(locations.vertexPos, 2, gl.FLOAT, false, 3 * Float32Array.BYTES_PER_ELEMENT, 0);\n    gl.vertexAttribPointer(locations.customAttributes, 1, gl.FLOAT, false, 3 * Float32Array.BYTES_PER_ELEMENT, 2 * 4);\n\n    ensureAtlasTextureUpdated();\n\n    gl.drawArrays(gl.TRIANGLES, 0, nodesCount * 6);\n  }\n}\n\n// TODO: Use glslify for shaders\nfunction createNodeFragmentShader() {\n  return [\n    \"precision mediump float;\",\n    \"varying vec4 color;\",\n    \"varying vec3 vTextureCoord;\",\n    \"uniform sampler2D u_sampler0;\",\n    \"uniform sampler2D u_sampler1;\",\n    \"uniform sampler2D u_sampler2;\",\n    \"uniform sampler2D u_sampler3;\",\n\n    \"void main(void) {\",\n    \"   if (vTextureCoord.z == 0.) {\",\n    \"     gl_FragColor = texture2D(u_sampler0, vTextureCoord.xy);\",\n    \"   } else if (vTextureCoord.z == 1.) {\",\n    \"     gl_FragColor = texture2D(u_sampler1, vTextureCoord.xy);\",\n    \"   } else if (vTextureCoord.z == 2.) {\",\n    \"     gl_FragColor = texture2D(u_sampler2, vTextureCoord.xy);\",\n    \"   } else if (vTextureCoord.z == 3.) {\",\n    \"     gl_FragColor = texture2D(u_sampler3, vTextureCoord.xy);\",\n    \"   } else { gl_FragColor = vec4(0, 1, 0, 1); }\",\n    \"}\"\n  ].join(\"\\n\");\n}\n\nfunction createNodeVertexShader() {\n  return [\n    \"attribute vec2 a_vertexPos;\",\n\n    \"attribute float a_customAttributes;\",\n    \"uniform vec2 u_screenSize;\",\n    \"uniform mat4 u_transform;\",\n    \"uniform float u_tilesPerTexture;\",\n    \"varying vec3 vTextureCoord;\",\n\n    \"void main(void) {\",\n    \"   gl_Position = u_transform * vec4(a_vertexPos/u_screenSize, 0, 1);\",\n    \"float corner = mod(a_customAttributes, 4.);\",\n    \"float tileIndex = mod(floor(a_customAttributes / 4.), u_tilesPerTexture);\",\n    \"float tilesPerRow = sqrt(u_tilesPerTexture);\",\n    \"float tileSize = 1./tilesPerRow;\",\n    \"float tileColumn = mod(tileIndex, tilesPerRow);\",\n    \"float tileRow = floor(tileIndex/tilesPerRow);\",\n\n    \"if(corner == 0.0) {\",\n    \"  vTextureCoord.xy = vec2(0, 1);\",\n    \"} else if(corner == 1.0) {\",\n    \"  vTextureCoord.xy = vec2(1, 1);\",\n    \"} else if(corner == 2.0) {\",\n    \"  vTextureCoord.xy = vec2(0, 0);\",\n    \"} else {\",\n    \"  vTextureCoord.xy = vec2(1, 0);\",\n    \"}\",\n\n    \"vTextureCoord *= tileSize;\",\n    \"vTextureCoord.x += tileColumn * tileSize;\",\n    \"vTextureCoord.y += tileRow * tileSize;\",\n    \"vTextureCoord.z = floor(floor(a_customAttributes / 4.)/u_tilesPerTexture);\",\n    \"}\"\n  ].join(\"\\n\");\n}\n\n},{\"./webgl.js\":57,\"./webglAtlas.js\":58}],61:[function(require,module,exports){\nvar documentEvents = require('../Utils/documentEvents.js');\n\nmodule.exports = webglInputEvents;\n\n/**\n * Monitors graph-related mouse input in webgl graphics and notifies subscribers.\n *\n * @param {Viva.Graph.View.webglGraphics} webglGraphics\n */\nfunction webglInputEvents(webglGraphics) {\n  if (webglGraphics.webglInputEvents) {\n    // Don't listen twice, if we are already attached to this graphics:\n    return webglGraphics.webglInputEvents;\n  }\n\n  var mouseCapturedNode = null,\n    mouseEnterCallback = [],\n    mouseLeaveCallback = [],\n    mouseDownCallback = [],\n    mouseUpCallback = [],\n    mouseMoveCallback = [],\n    clickCallback = [],\n    dblClickCallback = [],\n    prevSelectStart,\n    boundRect;\n\n  var root = webglGraphics.getGraphicsRoot();\n  startListen(root);\n\n  var api = {\n    mouseEnter: mouseEnter,\n    mouseLeave: mouseLeave,\n    mouseDown: mouseDown,\n    mouseUp: mouseUp,\n    mouseMove: mouseMove,\n    click: click,\n    dblClick: dblClick,\n    mouseCapture: mouseCapture,\n    releaseMouseCapture: releaseMouseCapture\n  };\n\n  // TODO I don't remember why this is needed:\n  webglGraphics.webglInputEvents = api;\n\n  return api;\n\n  function releaseMouseCapture() {\n    mouseCapturedNode = null;\n  }\n\n  function mouseCapture(node) {\n    mouseCapturedNode = node;\n  }\n\n  function dblClick(callback) {\n    if (typeof callback === 'function') {\n      dblClickCallback.push(callback);\n    }\n    return api;\n  }\n\n  function click(callback) {\n    if (typeof callback === 'function') {\n      clickCallback.push(callback);\n    }\n    return api;\n  }\n\n  function mouseMove(callback) {\n    if (typeof callback === 'function') {\n      mouseMoveCallback.push(callback);\n    }\n    return api;\n  }\n\n  function mouseUp(callback) {\n    if (typeof callback === 'function') {\n      mouseUpCallback.push(callback);\n    }\n    return api;\n  }\n\n  function mouseDown(callback) {\n    if (typeof callback === 'function') {\n      mouseDownCallback.push(callback);\n    }\n    return api;\n  }\n\n  function mouseLeave(callback) {\n    if (typeof callback === 'function') {\n      mouseLeaveCallback.push(callback);\n    }\n    return api;\n  }\n\n  function mouseEnter(callback) {\n    if (typeof callback === 'function') {\n      mouseEnterCallback.push(callback);\n    }\n    return api;\n  }\n\n  function preciseCheck(nodeUI, x, y) {\n    if (nodeUI && nodeUI.size) {\n      var pos = nodeUI.position,\n        half = nodeUI.size;\n\n      return pos.x - half < x && x < pos.x + half &&\n        pos.y - half < y && y < pos.y + half;\n    }\n\n    return true;\n  }\n\n  function getNodeAtClientPos(pos) {\n    return webglGraphics.getNodeAtClientPos(pos, preciseCheck);\n  }\n\n  function stopPropagation(e) {\n    if (e.stopPropagation) {\n      e.stopPropagation();\n    } else {\n      e.cancelBubble = true;\n    }\n  }\n\n  function handleDisabledEvent(e) {\n    stopPropagation(e);\n    return false;\n  }\n\n  function invoke(callbacksChain, args) {\n    var i, stopPropagation;\n    for (i = 0; i < callbacksChain.length; i += 1) {\n      stopPropagation = callbacksChain[i].apply(undefined, args);\n      if (stopPropagation) {\n        return true;\n      }\n    }\n  }\n\n  function startListen(root) {\n    var pos = {\n        x: 0,\n        y: 0\n      },\n      lastFound = null,\n      lastUpdate = 1,\n      lastClickTime = +new Date(),\n\n      handleMouseMove = function(e) {\n        invoke(mouseMoveCallback, [lastFound, e]);\n        pos.x = e.clientX;\n        pos.y = e.clientY;\n      },\n\n      handleMouseUp = function() {\n        documentEvents.off('mousemove', handleMouseMove);\n        documentEvents.off('mouseup', handleMouseUp);\n      },\n\n      updateBoundRect = function() {\n        boundRect = root.getBoundingClientRect();\n      };\n\n    window.addEventListener('resize', updateBoundRect);\n    updateBoundRect();\n\n    // mouse move inside container serves only to track mouse enter/leave events.\n    root.addEventListener('mousemove',\n      function(e) {\n        if (mouseCapturedNode) {\n          return;\n        }\n        if (lastUpdate++ % 7 === 0) {\n          // since there is no bullet proof method to detect resize\n          // event, we preemptively update the bounding rectangle\n          updateBoundRect();\n          lastUpdate = 1;\n        }\n        var cancelBubble = false,\n          node;\n\n        pos.x = e.clientX - boundRect.left;\n        pos.y = e.clientY - boundRect.top;\n\n        node = getNodeAtClientPos(pos);\n\n        if (node && lastFound !== node) {\n          if(lastFound){ \n            invoke(mouseLeaveCallback, [lastFound]);\n          }\n          lastFound = node;\n          cancelBubble = cancelBubble || invoke(mouseEnterCallback, [lastFound]);\n        } else if (node === null && lastFound !== node) {\n          cancelBubble = cancelBubble || invoke(mouseLeaveCallback, [lastFound]);\n          lastFound = null;\n        }\n\n        if (cancelBubble) {\n          stopPropagation(e);\n        }\n      });\n\n    root.addEventListener('mousedown',\n      function(e) {\n        var cancelBubble = false,\n          args;\n        updateBoundRect();\n        pos.x = e.clientX - boundRect.left;\n        pos.y = e.clientY - boundRect.top;\n\n        args = [getNodeAtClientPos(pos), e];\n        if (args[0]) {\n          cancelBubble = invoke(mouseDownCallback, args);\n          // we clicked on a node. Following drag should be handled on document events:\n          documentEvents.on('mousemove', handleMouseMove);\n          documentEvents.on('mouseup', handleMouseUp);\n\n          prevSelectStart = window.document.onselectstart;\n\n          window.document.onselectstart = handleDisabledEvent;\n\n          lastFound = args[0];\n        } else {\n          lastFound = null;\n        }\n        if (cancelBubble) {\n          stopPropagation(e);\n        }\n      });\n\n    root.addEventListener('mouseup',\n      function(e) {\n        var clickTime = +new Date(),\n          args;\n\n        pos.x = e.clientX - boundRect.left;\n        pos.y = e.clientY - boundRect.top;\n\n        var nodeAtClientPos = getNodeAtClientPos(pos);\n        var sameNode = nodeAtClientPos === lastFound;\n        args = [nodeAtClientPos || lastFound, e];\n        if (args[0]) {\n          window.document.onselectstart = prevSelectStart;\n\n          if (clickTime - lastClickTime < 400 && sameNode) {\n            invoke(dblClickCallback, args);\n          } else {\n            invoke(clickCallback, args);\n          }\n          lastClickTime = clickTime;\n\n          if (invoke(mouseUpCallback, args)) {\n            stopPropagation(e);\n          }\n        }\n      });\n  }\n}\n\n},{\"../Utils/documentEvents.js\":44}],62:[function(require,module,exports){\nvar parseColor = require('./parseColor.js');\n\nmodule.exports = webglLine;\n\n/**\n * Defines a webgl line. This class has no rendering logic at all,\n * it's just passed to corresponding shader and the shader should\n * figure out how to render it.\n *\n */\nfunction webglLine(color) {\n  return {\n    /**\n     * Gets or sets color of the line. If you set this property externally\n     * make sure it always come as integer of 0xRRGGBBAA format\n     */\n    color: parseColor(color)\n  };\n}\n\n},{\"./parseColor.js\":55}],63:[function(require,module,exports){\n/**\n * @fileOverview Defines a naive form of links for webglGraphics class.\n * This form allows to change color of links.\n **/\n\nvar glUtils = require('./webgl.js');\n\nmodule.exports = webglLinkProgram;\n\n/**\n * Defines UI for links in webgl renderer.\n */\nfunction webglLinkProgram() {\n    var ATTRIBUTES_PER_PRIMITIVE = 6, // primitive is Line with two points. Each has x,y and color = 3 * 2 attributes.\n        BYTES_PER_LINK = 2 * (2 * Float32Array.BYTES_PER_ELEMENT + Uint32Array.BYTES_PER_ELEMENT), // two nodes * (x, y + color)\n        linksFS = [\n            'precision mediump float;',\n            'varying vec4 color;',\n            'void main(void) {',\n            '   gl_FragColor = color;',\n            '}'\n        ].join('\\n'),\n\n        linksVS = [\n            'attribute vec2 a_vertexPos;',\n            'attribute vec4 a_color;',\n\n            'uniform vec2 u_screenSize;',\n            'uniform mat4 u_transform;',\n\n            'varying vec4 color;',\n\n            'void main(void) {',\n            '   gl_Position = u_transform * vec4(a_vertexPos/u_screenSize, 0.0, 1.0);',\n            '   color = a_color.abgr;',\n            '}'\n        ].join('\\n'),\n\n        program,\n        gl,\n        buffer,\n        utils,\n        locations,\n        linksCount = 0,\n        frontLinkId, // used to track z-index of links.\n        storage = new ArrayBuffer(16 * BYTES_PER_LINK),\n        positions = new Float32Array(storage),\n        colors = new Uint32Array(storage),\n        width,\n        height,\n        transform,\n        sizeDirty,\n\n        ensureEnoughStorage = function () {\n            // TODO: this is a duplicate of webglNodeProgram code. Extract it to webgl.js\n            if ((linksCount+1)*BYTES_PER_LINK > storage.byteLength) {\n                // Every time we run out of space create new array twice bigger.\n                // TODO: it seems buffer size is limited. Consider using multiple arrays for huge graphs\n                var extendedStorage = new ArrayBuffer(storage.byteLength * 2),\n                    extendedPositions = new Float32Array(extendedStorage),\n                    extendedColors = new Uint32Array(extendedStorage);\n\n                extendedColors.set(colors); // should be enough to copy just one view.\n                positions = extendedPositions;\n                colors = extendedColors;\n                storage = extendedStorage;\n            }\n        };\n\n    return {\n        load : function (glContext) {\n            gl = glContext;\n            utils = glUtils(glContext);\n\n            program = utils.createProgram(linksVS, linksFS);\n            gl.useProgram(program);\n            locations = utils.getLocations(program, ['a_vertexPos', 'a_color', 'u_screenSize', 'u_transform']);\n\n            gl.enableVertexAttribArray(locations.vertexPos);\n            gl.enableVertexAttribArray(locations.color);\n\n            buffer = gl.createBuffer();\n        },\n\n        position: function (linkUi, fromPos, toPos) {\n            var linkIdx = linkUi.id,\n                offset = linkIdx * ATTRIBUTES_PER_PRIMITIVE;\n            positions[offset] = fromPos.x;\n            positions[offset + 1] = fromPos.y;\n            colors[offset + 2] = linkUi.color;\n\n            positions[offset + 3] = toPos.x;\n            positions[offset + 4] = toPos.y;\n            colors[offset + 5] = linkUi.color;\n        },\n\n        createLink : function (ui) {\n            ensureEnoughStorage();\n\n            linksCount += 1;\n            frontLinkId = ui.id;\n        },\n\n        removeLink : function (ui) {\n            if (linksCount > 0) { linksCount -= 1; }\n            // swap removed link with the last link. This will give us O(1) performance for links removal:\n            if (ui.id < linksCount && linksCount > 0) {\n                // using colors as a view to array buffer is okay here.\n                utils.copyArrayPart(colors, ui.id * ATTRIBUTES_PER_PRIMITIVE, linksCount * ATTRIBUTES_PER_PRIMITIVE, ATTRIBUTES_PER_PRIMITIVE);\n            }\n        },\n\n        updateTransform : function (newTransform) {\n            sizeDirty = true;\n            transform = newTransform;\n        },\n\n        updateSize : function (w, h) {\n            width = w;\n            height = h;\n            sizeDirty = true;\n        },\n\n        render : function () {\n            gl.useProgram(program);\n            gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n            gl.bufferData(gl.ARRAY_BUFFER, storage, gl.DYNAMIC_DRAW);\n\n            if (sizeDirty) {\n                sizeDirty = false;\n                gl.uniformMatrix4fv(locations.transform, false, transform);\n                gl.uniform2f(locations.screenSize, width, height);\n            }\n\n            gl.vertexAttribPointer(locations.vertexPos, 2, gl.FLOAT, false, 3 * Float32Array.BYTES_PER_ELEMENT, 0);\n            gl.vertexAttribPointer(locations.color, 4, gl.UNSIGNED_BYTE, true, 3 * Float32Array.BYTES_PER_ELEMENT, 2 * 4);\n\n            gl.drawArrays(gl.LINES, 0, linksCount * 2);\n\n            frontLinkId = linksCount - 1;\n        },\n\n        bringToFront : function (link) {\n            if (frontLinkId > link.id) {\n                utils.swapArrayPart(positions, link.id * ATTRIBUTES_PER_PRIMITIVE, frontLinkId * ATTRIBUTES_PER_PRIMITIVE, ATTRIBUTES_PER_PRIMITIVE);\n            }\n            if (frontLinkId > 0) {\n                frontLinkId -= 1;\n            }\n        },\n\n        getFrontLinkId : function () {\n            return frontLinkId;\n        }\n    };\n}\n\n},{\"./webgl.js\":57}],64:[function(require,module,exports){\n/**\n * @fileOverview Defines a naive form of nodes for webglGraphics class.\n * This form allows to change color of node. Shape of nodes is rectangular.\n *\n * @author Andrei Kashcha (aka anvaka) / https://github.com/anvaka\n */\n\nvar glUtils = require('./webgl.js');\n\nmodule.exports = webglNodeProgram;\n\n/**\n * Defines simple UI for nodes in webgl renderer. Each node is rendered as square. Color and size can be changed.\n */\nfunction webglNodeProgram() {\n  var ATTRIBUTES_PER_PRIMITIVE = 4; // Primitive is point, x, y, size, color\n  // x, y, z - floats, color = uint.\n  var BYTES_PER_NODE = 3 * Float32Array.BYTES_PER_ELEMENT + Uint32Array.BYTES_PER_ELEMENT;\n  var nodesFS = [\n    'precision mediump float;',\n    'varying vec4 color;',\n\n    'void main(void) {',\n    '   gl_FragColor = color;',\n    '}'\n  ].join('\\n');\n  var nodesVS = [\n    'attribute vec3 a_vertexPos;',\n    'attribute vec4 a_color;',\n    'uniform vec2 u_screenSize;',\n    'uniform mat4 u_transform;',\n    'varying vec4 color;',\n\n    'void main(void) {',\n    '   gl_Position = u_transform * vec4(a_vertexPos.xy/u_screenSize, 0, 1);',\n    '   gl_PointSize = a_vertexPos.z * u_transform[0][0];',\n    '   color = a_color.abgr;',\n    '}'\n  ].join('\\n');\n\n  var program;\n  var gl;\n  var buffer;\n  var locations;\n  var utils;\n  var storage = new ArrayBuffer(16 * BYTES_PER_NODE);\n  var positions = new Float32Array(storage);\n  var colors = new Uint32Array(storage);\n  var nodesCount = 0;\n  var width;\n  var height;\n  var transform;\n  var sizeDirty;\n\n  return {\n    load: load,\n\n    /**\n     * Updates position of node in the buffer of nodes.\n     *\n     * @param idx - index of current node.\n     * @param pos - new position of the node.\n     */\n    position: position,\n\n    updateTransform: updateTransform,\n\n    updateSize: updateSize,\n\n    removeNode: removeNode,\n\n    createNode: createNode,\n\n    replaceProperties: replaceProperties,\n\n    render: render\n  };\n\n  function ensureEnoughStorage() {\n    if ((nodesCount + 1) * BYTES_PER_NODE >= storage.byteLength) {\n      // Every time we run out of space create new array twice bigger.\n      // TODO: it seems buffer size is limited. Consider using multiple arrays for huge graphs\n      var extendedStorage = new ArrayBuffer(storage.byteLength * 2),\n        extendedPositions = new Float32Array(extendedStorage),\n        extendedColors = new Uint32Array(extendedStorage);\n\n      extendedColors.set(colors); // should be enough to copy just one view.\n      positions = extendedPositions;\n      colors = extendedColors;\n      storage = extendedStorage;\n    }\n  }\n\n  function load(glContext) {\n    gl = glContext;\n    utils = glUtils(glContext);\n\n    program = utils.createProgram(nodesVS, nodesFS);\n    gl.useProgram(program);\n    locations = utils.getLocations(program, ['a_vertexPos', 'a_color', 'u_screenSize', 'u_transform']);\n\n    gl.enableVertexAttribArray(locations.vertexPos);\n    gl.enableVertexAttribArray(locations.color);\n\n    buffer = gl.createBuffer();\n  }\n\n  function position(nodeUI, pos) {\n    var idx = nodeUI.id;\n\n    positions[idx * ATTRIBUTES_PER_PRIMITIVE] = pos.x;\n    positions[idx * ATTRIBUTES_PER_PRIMITIVE + 1] = -pos.y;\n    positions[idx * ATTRIBUTES_PER_PRIMITIVE + 2] = nodeUI.size;\n\n    colors[idx * ATTRIBUTES_PER_PRIMITIVE + 3] = nodeUI.color;\n  }\n\n  function updateTransform(newTransform) {\n    sizeDirty = true;\n    transform = newTransform;\n  }\n\n  function updateSize(w, h) {\n    width = w;\n    height = h;\n    sizeDirty = true;\n  }\n\n  function removeNode(node) {\n      if (nodesCount > 0) {\n        nodesCount -= 1;\n      }\n\n      if (node.id < nodesCount && nodesCount > 0) {\n        // we can use colors as a 'view' into array array buffer.\n        utils.copyArrayPart(colors, node.id * ATTRIBUTES_PER_PRIMITIVE, nodesCount * ATTRIBUTES_PER_PRIMITIVE, ATTRIBUTES_PER_PRIMITIVE);\n      }\n    }\n\n  function createNode() {\n    ensureEnoughStorage();\n    nodesCount += 1;\n  }\n\n  function replaceProperties(/* replacedNode, newNode */) {}\n\n  function render() {\n    gl.useProgram(program);\n    gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n    gl.bufferData(gl.ARRAY_BUFFER, storage, gl.DYNAMIC_DRAW);\n\n    if (sizeDirty) {\n      sizeDirty = false;\n      gl.uniformMatrix4fv(locations.transform, false, transform);\n      gl.uniform2f(locations.screenSize, width, height);\n    }\n\n    gl.vertexAttribPointer(locations.vertexPos, 3, gl.FLOAT, false, ATTRIBUTES_PER_PRIMITIVE * Float32Array.BYTES_PER_ELEMENT, 0);\n    gl.vertexAttribPointer(locations.color, 4, gl.UNSIGNED_BYTE, true, ATTRIBUTES_PER_PRIMITIVE * Float32Array.BYTES_PER_ELEMENT, 3 * 4);\n\n    gl.drawArrays(gl.POINTS, 0, nodesCount);\n  }\n}\n\n},{\"./webgl.js\":57}],65:[function(require,module,exports){\nvar parseColor = require('./parseColor.js');\n\nmodule.exports = webglSquare;\n\n/**\n * Can be used as a callback in the webglGraphics.node() function, to\n * create a custom looking node.\n *\n * @param size - size of the node in pixels.\n * @param color - color of the node in '#rrggbbaa' or '#rgb' format.\n */\nfunction webglSquare(size, color) {\n  return {\n    /**\n     * Gets or sets size of the square side.\n     */\n    size: typeof size === 'number' ? size : 10,\n\n    /**\n     * Gets or sets color of the square.\n     */\n    color: parseColor(color)\n  };\n}\n\n},{\"./parseColor.js\":55}],66:[function(require,module,exports){\n// todo: this should be generated at build time.\nmodule.exports = '0.10.1';\n\n},{}]},{},[1])(1)\n});"]}